import{i as mt}from"./web.js";import"../web.js";var dt={exports:{}},Jt=dt.exports,Lt;function Ct(){return Lt||(Lt=1,function(kt,e){(function(c,l){kt.exports=l()})(typeof self<"u"?self:Jt,function(){return function(c){var l={};function p(o){if(l[o])return l[o].exports;var a=l[o]={i:o,l:!1,exports:{}};return c[o].call(a.exports,a,a.exports,p),a.l=!0,a.exports}return p.m=c,p.c=l,p.d=function(o,a,M){p.o(o,a)||Object.defineProperty(o,a,{configurable:!1,enumerable:!0,get:M})},p.r=function(o){Object.defineProperty(o,"__esModule",{value:!0})},p.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return p.d(a,"a",a),a},p.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},p.p="",p(p.s=0)}([function(c,l,p){function o(t){if(!(this instanceof o))return new o(t);this._=t}var a=o.prototype;function M(t,r){for(var n=0;n<t;n++)r(n)}function E(t,r,n){return function(i,u){M(u.length,function(s){i(u[s],s,u)})}(function(i,u,s){r=t(r,i,u,s)},n),r}function L(t,r){return E(function(n,i,u,s){return n.concat([t(i,u,s)])},[],r)}function lt(t,r){var n={v:0,buf:r};return M(t,function(){var i;n={v:n.v<<1|(i=n.buf,i[0]>>7),buf:function(u){var s=E(function(f,h,b,S){return f.concat(b===S.length-1?Buffer.from([h,0]).readUInt16BE(0):S.readUInt16BE(b))},[],u);return Buffer.from(L(function(f){return(f<<1&65535)>>8},s))}(n.buf)}}),n}function tt(){return typeof Buffer<"u"}function U(){if(!tt())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function rt(t){U();var r=E(function(s,f){return s+f},0,t);if(r%8!=0)throw new Error("The bits ["+t.join(", ")+"] add up to "+r+" which is not an even number of bytes; the total should be divisible by 8");var n,i=r/8,u=(n=function(s){return s>48},E(function(s,f){return s||(n(f)?f:s)},null,t));if(u)throw new Error(u+" bit range requested exceeds 48 bit (6 byte) Number max.");return new o(function(s,f){var h=i+f;return h>s.length?B(f,i.toString()+" bytes"):v(h,E(function(b,S){var w=lt(S,b.buf);return{coll:b.coll.concat(w.v),buf:w.buf}},{coll:[],buf:s.slice(f,h)},t).coll)})}function j(t,r){return new o(function(n,i){return U(),i+r>n.length?B(i,r+" bytes for "+t):v(i+r,n.slice(i,i+r))})}function V(t,r){if(typeof(n=r)!="number"||Math.floor(n)!==n||r<0||r>6)throw new Error(t+" requires integer length in range [0, 6].");var n}function R(t){return V("uintBE",t),j("uintBE("+t+")",t).map(function(r){return r.readUIntBE(0,t)})}function g(t){return V("uintLE",t),j("uintLE("+t+")",t).map(function(r){return r.readUIntLE(0,t)})}function y(t){return V("intBE",t),j("intBE("+t+")",t).map(function(r){return r.readIntBE(0,t)})}function m(t){return V("intLE",t),j("intLE("+t+")",t).map(function(r){return r.readIntLE(0,t)})}function N(t){return t instanceof o}function A(t){return{}.toString.call(t)==="[object Array]"}function k(t){return tt()&&Buffer.isBuffer(t)}function v(t,r){return{status:!0,index:t,value:r,furthest:-1,expected:[]}}function B(t,r){return A(r)||(r=[r]),{status:!1,index:-1,value:null,furthest:t,expected:r}}function O(t,r){if(!r||t.furthest>r.furthest)return t;var n=t.furthest===r.furthest?function(i,u){if(function(){if(o._supportsSet!==void 0)return o._supportsSet;var I=typeof Set<"u";return o._supportsSet=I,I}()&&Array.from){for(var s=new Set(i),f=0;f<u.length;f++)s.add(u[f]);var h=Array.from(s);return h.sort(),h}for(var b={},S=0;S<i.length;S++)b[i[S]]=!0;for(var w=0;w<u.length;w++)b[u[w]]=!0;var q=[];for(var P in b)({}).hasOwnProperty.call(b,P)&&q.push(P);return q.sort(),q}(t.expected,r.expected):r.expected;return{status:t.status,index:t.index,value:t.value,furthest:r.furthest,expected:n}}var nt={};function bt(t,r){if(k(t))return{offset:r,line:-1,column:-1};t in nt||(nt[t]={});for(var n=nt[t],i=0,u=0,s=0,f=r;f>=0;){if(f in n){i=n[f].line,s===0&&(s=n[f].lineStart);break}(t.charAt(f)===`
`||t.charAt(f)==="\r"&&t.charAt(f+1)!==`
`)&&(u++,s===0&&(s=f+1)),f--}var h=i+u,b=r-s;return n[r]={line:h,lineStart:s},{offset:r,line:h+1,column:b+1}}function G(t){if(!N(t))throw new Error("not a parser: "+t)}function et(t,r){return typeof t=="string"?t.charAt(r):t[r]}function X(t){if(typeof t!="number")throw new Error("not a number: "+t)}function W(t){if(typeof t!="function")throw new Error("not a function: "+t)}function H(t){if(typeof t!="string")throw new Error("not a string: "+t)}var _t=2,qt=3,z=8,It=5*z,Mt=4*z,yt="  ";function it(t,r){return new Array(r+1).join(t)}function ot(t,r,n){var i=r-t.length;return i<=0?t:it(n,i)+t}function vt(t,r,n,i){return{from:t-r>0?t-r:0,to:t+n>i?i:t+n}}function zt(t,r){var n,i,u,s,f,h=r.index,b=h.offset,S=1;if(b===t.length)return"Got the end of the input";if(k(t)){var w=b-b%z,q=b-w,P=vt(w,It,Mt+z,t.length),I=L(function(x){return L(function(J){return ot(J.toString(16),2,"0")},x)},function(x,J){var C=x.length,$=[],K=0;if(C<=J)return[x.slice()];for(var Q=0;Q<C;Q++)$[K]||$.push([]),$[K].push(x[Q]),(Q+1)%J==0&&K++;return $}(t.slice(P.from,P.to).toJSON().data,z));s=function(x){return x.from===0&&x.to===1?{from:x.from,to:x.to}:{from:x.from/z,to:Math.floor(x.to/z)}}(P),i=w/z,n=3*q,q>=4&&(n+=1),S=2,u=L(function(x){return x.length<=4?x.join(" "):x.slice(0,4).join(" ")+"  "+x.slice(4).join(" ")},I),(f=(8*(s.to>0?s.to-1:s.to)).toString(16).length)<2&&(f=2)}else{var Z=t.split(/\r\n|[\n\r\u2028\u2029]/);n=h.column-1,i=h.line-1,s=vt(i,_t,qt,Z.length),u=Z.slice(s.from,s.to),f=s.to.toString().length}var Zt=i-s.from;return k(t)&&(f=(8*(s.to>0?s.to-1:s.to)).toString(16).length)<2&&(f=2),E(function(x,J,C){var $,K=C===Zt,Q=K?"> ":yt;return $=k(t)?ot((8*(s.from+C)).toString(16),f,"0"):ot((s.from+C+1).toString(),f," "),[].concat(x,[Q+$+" | "+J],K?[yt+it(" ",f)+" | "+ot("",n," ")+it("^",S)]:[])},[],u).join(`
`)}function xt(t,r){return[`
`,"-- PARSING FAILED "+it("-",50),`

`,zt(t,r),`

`,(n=r.expected,n.length===1?`Expected:

`+n[0]:`Expected one of the following: 

`+n.join(", ")),`
`].join("");var n}function Et(t){return t.flags!==void 0?t.flags:[t.global?"g":"",t.ignoreCase?"i":"",t.multiline?"m":"",t.unicode?"u":"",t.sticky?"y":""].join("")}function ut(){for(var t=[].slice.call(arguments),r=t.length,n=0;n<r;n+=1)G(t[n]);return o(function(i,u){for(var s,f=new Array(r),h=0;h<r;h+=1){if(!(s=O(t[h]._(i,u),s)).status)return s;f[h]=s.value,u=s.index}return O(v(u,f),s)})}function D(){var t=[].slice.call(arguments);if(t.length===0)throw new Error("seqMap needs at least one argument");var r=t.pop();return W(r),ut.apply(null,t).map(function(n){return r.apply(null,n)})}function st(){var t=[].slice.call(arguments),r=t.length;if(r===0)return ft("zero alternates");for(var n=0;n<r;n+=1)G(t[n]);return o(function(i,u){for(var s,f=0;f<t.length;f+=1)if((s=O(t[f]._(i,u),s)).status)return s;return s})}function wt(t,r){return ht(t,r).or(F([]))}function ht(t,r){return G(t),G(r),D(t,r.then(t).many(),function(n,i){return[n].concat(i)})}function T(t){H(t);var r="'"+t+"'";return o(function(n,i){var u=i+t.length,s=n.slice(i,u);return s===t?v(u,s):B(i,r)})}function _(t,r){(function(u){if(!(u instanceof RegExp))throw new Error("not a regexp: "+u);for(var s=Et(u),f=0;f<s.length;f++){var h=s.charAt(f);if(h!=="i"&&h!=="m"&&h!=="u"&&h!=="s")throw new Error('unsupported regexp flag "'+h+'": '+u)}})(t),arguments.length>=2?X(r):r=0;var n=function(u){return RegExp("^(?:"+u.source+")",Et(u))}(t),i=""+t;return o(function(u,s){var f=n.exec(u.slice(s));if(f){if(0<=r&&r<=f.length){var h=f[0],b=f[r];return v(s+h.length,b)}return B(s,"valid match group (0 to "+f.length+") in "+i)}return B(s,i)})}function F(t){return o(function(r,n){return v(n,t)})}function ft(t){return o(function(r,n){return B(n,t)})}function at(t){if(N(t))return o(function(r,n){var i=t._(r,n);return i.index=n,i.value="",i});if(typeof t=="string")return at(T(t));if(t instanceof RegExp)return at(_(t));throw new Error("not a string, regexp, or parser: "+t)}function St(t){return G(t),o(function(r,n){var i=t._(r,n),u=r.slice(n,i.index);return i.status?B(n,'not "'+u+'"'):v(n,null)})}function ct(t){return W(t),o(function(r,n){var i=et(r,n);return n<r.length&&t(i)?v(n+1,i):B(n,"a character/byte matching "+t)})}function Nt(t,r){arguments.length<2&&(r=t,t=void 0);var n=o(function(i,u){return n._=r()._,n._(i,u)});return t?n.desc(t):n}function pt(){return ft("fantasy-land/empty")}a.parse=function(t){if(typeof t!="string"&&!k(t))throw new Error(".parse must be called with a string or Buffer as its argument");var r,n=this.skip(gt)._(t,0);return r=n.status?{status:!0,value:n.value}:{status:!1,index:bt(t,n.furthest),expected:n.expected},delete nt[t],r},a.tryParse=function(t){var r=this.parse(t);if(r.status)return r.value;var n=xt(t,r),i=new Error(n);throw i.type="ParsimmonError",i.result=r,i},a.assert=function(t,r){return this.chain(function(n){return t(n)?F(n):ft(r)})},a.or=function(t){return st(this,t)},a.trim=function(t){return this.wrap(t,t)},a.wrap=function(t,r){return D(t,this,r,function(n,i){return i})},a.thru=function(t){return t(this)},a.then=function(t){return G(t),ut(this,t).map(function(r){return r[1]})},a.many=function(){var t=this;return o(function(r,n){for(var i=[],u=void 0;;){if(!(u=O(t._(r,n),u)).status)return O(v(n,i),u);if(n===u.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");n=u.index,i.push(u.value)}})},a.tieWith=function(t){return H(t),this.map(function(r){if(function(u){if(!A(u))throw new Error("not an array: "+u)}(r),r.length){H(r[0]);for(var n=r[0],i=1;i<r.length;i++)H(r[i]),n+=t+r[i];return n}return""})},a.tie=function(){return this.tieWith("")},a.times=function(t,r){var n=this;return arguments.length<2&&(r=t),X(t),X(r),o(function(i,u){for(var s=[],f=void 0,h=void 0,b=0;b<t;b+=1){if(h=O(f=n._(i,u),h),!f.status)return h;u=f.index,s.push(f.value)}for(;b<r&&(h=O(f=n._(i,u),h),f.status);b+=1)u=f.index,s.push(f.value);return O(v(u,s),h)})},a.result=function(t){return this.map(function(){return t})},a.atMost=function(t){return this.times(0,t)},a.atLeast=function(t){return D(this.times(t),this.many(),function(r,n){return r.concat(n)})},a.map=function(t){W(t);var r=this;return o(function(n,i){var u=r._(n,i);return u.status?O(v(u.index,t(u.value)),u):u})},a.contramap=function(t){W(t);var r=this;return o(function(n,i){var u=r.parse(t(n.slice(i)));return u.status?v(i+n.length,u.value):u})},a.promap=function(t,r){return W(t),W(r),this.contramap(t).map(r)},a.skip=function(t){return ut(this,t).map(function(r){return r[0]})},a.mark=function(){return D(Y,this,Y,function(t,r,n){return{start:t,value:r,end:n}})},a.node=function(t){return D(Y,this,Y,function(r,n,i){return{name:t,value:n,start:r,end:i}})},a.sepBy=function(t){return wt(this,t)},a.sepBy1=function(t){return ht(this,t)},a.lookahead=function(t){return this.skip(at(t))},a.notFollowedBy=function(t){return this.skip(St(t))},a.desc=function(t){A(t)||(t=[t]);var r=this;return o(function(n,i){var u=r._(n,i);return u.status||(u.expected=t),u})},a.fallback=function(t){return this.or(F(t))},a.ap=function(t){return D(t,this,function(r,n){return r(n)})},a.chain=function(t){var r=this;return o(function(n,i){var u=r._(n,i);return u.status?O(t(u.value)._(n,u.index),u):u})},a.concat=a.or,a.empty=pt,a.of=F,a["fantasy-land/ap"]=a.ap,a["fantasy-land/chain"]=a.chain,a["fantasy-land/concat"]=a.concat,a["fantasy-land/empty"]=a.empty,a["fantasy-land/of"]=a.of,a["fantasy-land/map"]=a.map;var Y=o(function(t,r){return v(r,bt(t,r))}),Wt=o(function(t,r){return r>=t.length?B(r,"any character/byte"):v(r+1,et(t,r))}),Dt=o(function(t,r){return v(t.length,t.slice(r))}),gt=o(function(t,r){return r<t.length?B(r,"EOF"):v(r,null)}),Ft=_(/[0-9]/).desc("a digit"),$t=_(/[0-9]*/).desc("optional digits"),Ut=_(/[a-z]/i).desc("a letter"),Vt=_(/[a-z]*/i).desc("optional letters"),Rt=_(/\s*/).desc("optional whitespace"),Gt=_(/\s+/).desc("whitespace"),Bt=T("\r"),Pt=T(`
`),jt=T(`\r
`),Ot=st(jt,Pt,Bt).desc("newline"),Xt=st(Ot,gt);o.all=Dt,o.alt=st,o.any=Wt,o.cr=Bt,o.createLanguage=function(t){var r={};for(var n in t)({}).hasOwnProperty.call(t,n)&&function(i){r[i]=Nt(function(){return t[i](r)})}(n);return r},o.crlf=jt,o.custom=function(t){return o(t(v,B))},o.digit=Ft,o.digits=$t,o.empty=pt,o.end=Xt,o.eof=gt,o.fail=ft,o.formatError=xt,o.index=Y,o.isParser=N,o.lazy=Nt,o.letter=Ut,o.letters=Vt,o.lf=Pt,o.lookahead=at,o.makeFailure=B,o.makeSuccess=v,o.newline=Ot,o.noneOf=function(t){return ct(function(r){return t.indexOf(r)<0}).desc("none of '"+t+"'")},o.notFollowedBy=St,o.of=F,o.oneOf=function(t){for(var r=t.split(""),n=0;n<r.length;n++)r[n]="'"+r[n]+"'";return ct(function(i){return t.indexOf(i)>=0}).desc(r)},o.optWhitespace=Rt,o.Parser=o,o.range=function(t,r){return ct(function(n){return t<=n&&n<=r}).desc(t+"-"+r)},o.regex=_,o.regexp=_,o.sepBy=wt,o.sepBy1=ht,o.seq=ut,o.seqMap=D,o.seqObj=function(){for(var t,r={},n=0,i=(t=arguments,Array.prototype.slice.call(t)),u=i.length,s=0;s<u;s+=1){var f=i[s];if(!N(f)){if(A(f)&&f.length===2&&typeof f[0]=="string"&&N(f[1])){var h=f[0];if(Object.prototype.hasOwnProperty.call(r,h))throw new Error("seqObj: duplicate key "+h);r[h]=!0,n++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(n===0)throw new Error("seqObj expects at least one named parser, found zero");return o(function(b,S){for(var w,q={},P=0;P<u;P+=1){var I,Z;if(A(i[P])?(I=i[P][0],Z=i[P][1]):(I=null,Z=i[P]),!(w=O(Z._(b,S),w)).status)return w;I&&(q[I]=w.value),S=w.index}return O(v(S,q),w)})},o.string=T,o.succeed=F,o.takeWhile=function(t){return W(t),o(function(r,n){for(var i=n;i<r.length&&t(et(r,i));)i++;return v(i,r.slice(n,i))})},o.test=ct,o.whitespace=Gt,o["fantasy-land/empty"]=pt,o["fantasy-land/of"]=F,o.Binary={bitSeq:rt,bitSeqObj:function(t){U();var r={},n=0,i=L(function(s){if(A(s)){var f=s;if(f.length!==2)throw new Error("["+f.join(", ")+"] should be length 2, got length "+f.length);if(H(f[0]),X(f[1]),Object.prototype.hasOwnProperty.call(r,f[0]))throw new Error("duplicate key in bitSeqObj: "+f[0]);return r[f[0]]=!0,n++,f}return X(s),[null,s]},t);if(n<1)throw new Error("bitSeqObj expects at least one named pair, got ["+t.join(", ")+"]");var u=L(function(s){return s[0]},i);return rt(L(function(s){return s[1]},i)).map(function(s){return E(function(f,h){return h[0]!==null&&(f[h[0]]=h[1]),f},{},L(function(f,h){return[f,s[h]]},u))})},byte:function(t){if(U(),X(t),t>255)throw new Error("Value specified to byte constructor ("+t+"=0x"+t.toString(16)+") is larger in value than a single byte.");var r=(t>15?"0x":"0x0")+t.toString(16);return o(function(n,i){var u=et(n,i);return u===t?v(i+1,u):B(i,r)})},buffer:function(t){return j("buffer",t).map(function(r){return Buffer.from(r)})},encodedString:function(t,r){return j("string",r).map(function(n){return n.toString(t)})},uintBE:R,uint8BE:R(1),uint16BE:R(2),uint32BE:R(4),uintLE:g,uint8LE:g(1),uint16LE:g(2),uint32LE:g(4),intBE:y,int8BE:y(1),int16BE:y(2),int32BE:y(4),intLE:m,int8LE:m(1),int16LE:m(2),int32LE:m(4),floatBE:j("floatBE",4).map(function(t){return t.readFloatBE(0)}),floatLE:j("floatLE",4).map(function(t){return t.readFloatLE(0)}),doubleBE:j("doubleBE",8).map(function(t){return t.readDoubleBE(0)}),doubleLE:j("doubleLE",8).map(function(t){return t.readDoubleLE(0)})},c.exports=o}])})}(dt)),dt.exports}var d=Ct();class At{constructor(e,c="\\"){this.val=e;function l(g){const y=[];for(const m of g)y.push((typeof m=="string"?d.string(m):d.regex(m)).trim(d.optWhitespace));return d.alt(...y)}function p(g){const y=Object.keys(g).sort().map(m=>(typeof g[m]=="string"?d.string(g[m]):d.regex(g[m])).trim(d.optWhitespace).result(m));return d.alt(...y)}function o(g,y){const m=d.lazy(()=>d.seq(g,m).or(y));return m}function a(g,y){return d.seqMap(y,g.many(),(m,N)=>N.reduce((A,k)=>[k,A],m))}function M(g,y){const m=d.lazy(()=>y.chain(N=>d.seq(g,d.of(N),m).or(d.of(N))));return m}function E(g,y){return d.seqMap(y,d.seq(g,y).many(),(m,N)=>N.reduce((A,k)=>[k[0],A,k[1]],m))}const L=d.alt(d.alt(d.regex(/-?(0|[1-9][0-9]*)\.[0-9]+/),d.regex(/0x[0-9a-fA-F]+/)).map(Number),d.alt(d.regex(/-?(0|[1-9][0-9]*)/)).map(g=>mt(g))).map(g=>["!num!",g]).desc("number"),lt=d.string("null").map(()=>["!str!",null]),tt=d.regex(/(true|false)/).map(g=>["!bool!",g==="true"]).desc("boolean"),U=d.regex(new RegExp(`(?:"(?:\\${c}["'#\\n]|[^"])*"|'(?:\\${c}["'#\\n]|[^'])*'|\\#(?:\\${c}["'#\\n]|[^#])*\\#)`)).map(g=>["!str!",g.slice(1,-1).replaceAll(c,"")]).desc("string"),rt=/\[[^\]]+\]/g,j=d.regex(/-?(?:(?:tmp|sys|save|mp):)?[^\s!-/:-@[-^`{-~]+(?:\.[^\s!-/:-@[-^`{-~]+|\[[^\]]+\])*(?:@str)?/).map(g=>{const y=g.replaceAll(rt,N=>"."+this.parse(N.slice(1,-1))),m=this.val.getVal(y);return m==null?["!str!",m]:typeof m=="boolean"?["!bool!",m]:Object.prototype.toString.call(m)==="[object String]"?["!str!",String(m)]:["!num!",Number(m)]}).desc("string"),V=d.lazy(()=>d.string("(").then(this.#e).skip(d.string(")")).or(L).or(lt).or(tt).or(U).or(j)),R=[{type:o,ops:l([/[A-Za-z_][A-Za-z0-9_]*(?=\()/])},{type:a,ops:p({PostfixInc:"++"})},{type:a,ops:p({PostfixDec:"--"})},{type:o,ops:l([/!(?!=)|~/])},{type:o,ops:p({PrefixInc:"++"})},{type:o,ops:p({PrefixDec:"--"})},{type:o,ops:p({UnaryNegate:/-(?!-)/})},{type:M,ops:l(["**"])},{type:E,ops:l(["*","/","¥","%"])},{type:E,ops:l(["+","-"])},{type:E,ops:l([/>>>|<<|>>/])},{type:E,ops:l([/<=|<|>=|>/])},{type:E,ops:l([/===|!==|==|!=/])},{type:E,ops:l([/&(?!&)/])},{type:E,ops:l(["^"])},{type:E,ops:l([/\|(?!\|)/])},{type:E,ops:l(["&&"])},{type:E,ops:l(["||"])},{type:M,ops:l([":"])},{type:M,ops:l(["?"])}].reduce((g,y)=>y.type(y.ops,g),V);this.#e=R.trim(d.optWhitespace)}#e=null;parse(e){const c=this.#e.parse(e);if(!c.status)throw Error("(PropParser)文法エラー【"+e+"】");const l=c.value;return l[0]==="!str!"?this.#i(l[1]):this.#t(l)}#t(e){const c=e.shift();if(c instanceof Array)return this.#t(c);const l=this.#r[c];return l?l(e):Object(null)}#r={"!num!":e=>e.shift(),"!str!":e=>this.#i(e.shift()),"!bool!":e=>e.shift(),PostfixInc:e=>{throw Error("(PropParser)後置インクリメントは未サポートです")},PostfixDec:e=>{throw Error("(PropParser)後置デクリメントは未サポートです")},PrefixInc:e=>{throw Error("(PropParser)前置インクリメントは未サポートです")},PrefixDec:e=>{throw Error("(PropParser)前置デクリメントは未サポートです")},"!":e=>!this.#r.Boolean(e),"~":e=>~Number(this.#t(e.shift())),UnaryNegate:e=>-this.#r.Number(e),"**":e=>Number(this.#t(e.shift()))**Number(this.#t(e.shift())),"*":e=>Number(this.#t(e.shift()))*Number(this.#t(e.shift())),"/":e=>Number(this.#t(e.shift()))/Number(this.#t(e.shift())),"¥":e=>Math.floor(this.#r["/"](e)),"%":e=>Number(this.#t(e.shift()))%Number(this.#t(e.shift())),"+":e=>{const c=this.#t(e.shift()),l=this.#t(e.shift());return Object.prototype.toString.call(c)==="[object String]"||Object.prototype.toString.call(l)==="[object String]"?String(c)+String(l):Number(c)+Number(l)},"-":e=>Number(this.#t(e.shift()))-Number(this.#t(e.shift())),int:e=>mt(this.#n(e.shift())),parseInt:e=>mt(this.#r.Number(e)),Number:e=>{const c=this.#t(e.shift());return Object.prototype.toString.call(c)==="[object String]"?this.#n(this.#e.parse(String(c)).value):Number(c)},Boolean:e=>{const c=e.shift();return c[0]==="!bool!"?!!c[1]:!!this.#t(c)},ceil:e=>Math.ceil(this.#n(e.shift())),floor:e=>Math.floor(this.#n(e.shift())),round:e=>Math.round(this.#n(e.shift())),isNaN:e=>Number.isNaN(this.#n(e.shift())),"<<":e=>Number(this.#t(e.shift()))<<Number(this.#t(e.shift())),">>":e=>Number(this.#t(e.shift()))>>Number(this.#t(e.shift())),">>>":e=>Number(this.#t(e.shift()))>>>Number(this.#t(e.shift())),"<":e=>Number(this.#t(e.shift()))<Number(this.#t(e.shift())),"<=":e=>Number(this.#t(e.shift()))<=Number(this.#t(e.shift())),">":e=>Number(this.#t(e.shift()))>Number(this.#t(e.shift())),">=":e=>Number(this.#t(e.shift()))>=Number(this.#t(e.shift())),"==":e=>{const c=this.#t(e.shift()),l=this.#t(e.shift());return c==null&&l==null&&(!c||!l)?c==l:String(c)===String(l)},"!=":e=>!this.#r["=="](e),"===":e=>{const c=this.#t(e.shift()),l=this.#t(e.shift());return Object.prototype.toString.call(c)!=Object.prototype.toString.call(l)?!1:String(c)===String(l)},"!==":e=>!this.#r["==="](e),"&":e=>Number(this.#t(e.shift()))&Number(this.#t(e.shift())),"^":e=>Number(this.#t(e.shift()))^Number(this.#t(e.shift())),"|":e=>Number(this.#t(e.shift()))|Number(this.#t(e.shift())),"&&":e=>String(this.#t(e.shift()))==="true"&&String(this.#t(e.shift()))==="true","||":e=>String(this.#t(e.shift()))==="true"||String(this.#t(e.shift()))==="true","?":e=>{const c=this.#r.Boolean(e),l=e.shift();if(l[0]!==":")throw Error("(PropParser)三項演算子の文法エラーです。: が見つかりません");return this.#t(l[c?1:2])},":":()=>{throw Error("(PropParser)三項演算子の文法エラーです。? が見つかりません")}};#n(e){const c=this.#t(e);if(Object.prototype.toString.call(c)!=="[object Number]")throw Error("(PropParser)引数【"+String(c)+"】が数値ではありません");return Number(c)}#o=/(\$((tmp|sys|save|mp):)?[^\s!--/:-@[-^`{-~]+|#\{[^}]+})/g;#i(e){return e==null?e:String(e).replaceAll(this.#o,c=>String(c.startsWith("$")?this.val.getVal(c.slice(1)):this.parse(c.slice(2,-1))))}getValAmpersand=e=>e.startsWith("&")?String(this.parse(e.slice(1))):e;static#u=/^((?<scope>\w+?):)?(?<name>[^\s :@]+)(?<at>@str)?$/;static getValName(e){const c=this.#u.exec(e.trim())?.groups;if(!c)return null;const{scope:l="tmp",name:p,at:o=""}=c;return{scope:l,name:At.#s(p),at:o}}static#s(e){let c=0,l=0,p=e;for(;;){if(c=p.indexOf('["'),c<0){if(c=p.indexOf("['"),c<0)break;l=p.indexOf("']",c+2)}else l=p.indexOf('"]',c+2);if(l<0)break;p=p.slice(0,c)+"."+p.slice(c+2,l)+p.slice(l+2),c=l-2}return p}}export{At as PropParser};
