function Q(H,$){for(var D=0;D<$.length;D++){const B=$[D];if(typeof B!="string"&&!Array.isArray(B)){for(const x in B)if(x!=="default"&&!(x in H)){const q=Object.getOwnPropertyDescriptor(B,x);q&&Object.defineProperty(H,x,q.get?q:{enumerable:!0,get:()=>B[x]})}}}return Object.freeze(Object.defineProperty(H,Symbol.toStringTag,{value:"Module"}))}var z={exports:{}},X=z.exports,J;function Y(){return J||(J=1,function(H,$){(function(D,B){H.exports=B()})(X,()=>(()=>{var D={944:function(m){var g;g=()=>(()=>{var k={d:(u,c)=>{for(var s in c)k.o(c,s)&&!k.o(u,s)&&Object.defineProperty(u,s,{enumerable:!0,get:c[s]})},o:(u,c)=>Object.prototype.hasOwnProperty.call(u,c)},G={};function w(u){return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},w(u)}function A(u,c){var s=typeof Symbol<"u"&&u[Symbol.iterator]||u["@@iterator"];if(!s){if(Array.isArray(u)||(s=O(u))||c){s&&(u=s);var i=0,f=function(){};return{s:f,n:function(){return i>=u.length?{done:!0}:{done:!1,value:u[i++]}},e:function(p){throw p},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h,v=!0,d=!1;return{s:function(){s=s.call(u)},n:function(){var p=s.next();return v=p.done,p},e:function(p){d=!0,h=p},f:function(){try{v||s.return==null||s.return()}finally{if(d)throw h}}}}function y(u,c){return function(s){if(Array.isArray(s))return s}(u)||function(s,i){var f=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(f!=null){var h,v,d,p,R=[],V=!0,C=!1;try{if(d=(f=f.call(s)).next,i!==0)for(;!(V=(h=d.call(f)).done)&&(R.push(h.value),R.length!==i);V=!0);}catch(U){C=!0,v=U}finally{try{if(!V&&f.return!=null&&(p=f.return(),Object(p)!==p))return}finally{if(C)throw v}}return R}}(u,c)||O(u,c)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function O(u,c){if(u){if(typeof u=="string")return P(u,c);var s=Object.prototype.toString.call(u).slice(8,-1);return s==="Object"&&u.constructor&&(s=u.constructor.name),s==="Map"||s==="Set"?Array.from(u):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?P(u,c):void 0}}function P(u,c){(c==null||c>u.length)&&(c=u.length);for(var s=0,i=new Array(c);s<c;s++)i[s]=u[s];return i}function j(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}k.d(G,{default:()=>Z});var Z=function(){function u(){var i=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];j(this,u),this.strict=i,this.defaults=new Map,this.validators=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var c,s;return c=u,(s=[{key:"allowExtra",value:function(){return this.strict=!1,this}},{key:"setDefaults",value:function(i){var f=this;return Object.entries(i).forEach(function(h){var v=y(h,2),d=v[0],p=v[1];return f.defaults.set(d,p)}),this}},{key:"setValidators",value:function(i){var f=this;return Object.entries(i).forEach(function(h){var v=y(h,2),d=v[0],p=v[1];return f.validators.set(d,p)}),this}},{key:"setTypes",value:function(i){var f=this;return Object.entries(i).forEach(function(h){var v=y(h,2),d=v[0],p=v[1];return f.types.set(d,p)}),this}},{key:"setOptional",value:function(i){var f=this;return i.forEach(function(h){return f.optional.add(h)}),this}},{key:"setRequired",value:function(i){var f=this;return i.forEach(function(h){return f.required.add(h)}),this}},{key:"resolve",value:function(i){return this.validate(Object.assign(this.getDefaults(),i))}},{key:"getDefaults",value:function(){var i,f={},h=A(this.defaults);try{for(h.s();!(i=h.n()).done;){var v=y(i.value,2),d=v[0],p=v[1];f[d]=p}}catch(R){h.e(R)}finally{h.f()}return f}},{key:"validate",value:function(i){for(var f in i)this.validators.has(f)&&(i[f]=this.validators.get(f)(i[f]));for(var h in i){if(!this.optionExists(h))throw new Error('Unkown option "'.concat(h,'".'));this.checkType(h,i[h])}var v,d=A(this.required.values());try{for(d.s();!(v=d.n()).done;){var p=v.value;if(i[p]===void 0)throw new Error('Option "'.concat(p,'" is required.'))}}catch(R){d.e(R)}finally{d.f()}return i}},{key:"checkType",value:function(i,f){if(this.types.has(i)){var h=this.types.get(i),v=w(f);if(v!==h)throw new Error('Wrong value for option "'.concat(i,'": expected type "').concat(h,'", got "').concat(v,'".'))}}},{key:"optionExists",value:function(i){return!this.strict||this.defaults.has(i)||this.validators.has(i)||this.optional.has(i)||this.required.has(i)||this.types.has(i)}}])&&function(i,f){for(var h=0;h<f.length;h++){var v=f[h];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(i,(d=function(p,R){if(w(p)!=="object"||p===null)return p;var V=p[Symbol.toPrimitive];if(V!==void 0){var C=V.call(p,"string");if(w(C)!=="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}(v.key),w(d)==="symbol"?d:String(d)),v)}var d}(c.prototype,s),Object.defineProperty(c,"prototype",{writable:!1}),u}();return G.default})(),m.exports=g()},162:function(m){m.exports=(()=>{var g={d:(w,A)=>{for(var y in A)g.o(A,y)&&!g.o(w,y)&&Object.defineProperty(w,y,{enumerable:!0,get:A[y]})},o:(w,A)=>Object.prototype.hasOwnProperty.call(w,A)},k={};g.d(k,{default:()=>G});var G=function(){function w(){(function(y,O){if(!(y instanceof O))throw new TypeError("Cannot call a class as a function")})(this,w),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var A;return(A=[{key:"emit",value:function(y,O){if(Object.prototype.hasOwnProperty.call(this._events,y))for(var P=this._events[y],j={type:y,detail:O},Z=P.length,u=0;u<Z;u++)this.handle(P[u],j)}},{key:"handle",value:function(y,O){y(O)}},{key:"addEventListener",value:function(y,O){Object.prototype.hasOwnProperty.call(this._events,y)||(this._events[y]=[]),this._events[y].indexOf(O)<0&&this._events[y].push(O)}},{key:"removeEventListener",value:function(y,O){if(Object.prototype.hasOwnProperty.call(this._events,y)){var P=this._events[y],j=P.indexOf(O);j>=0&&P.splice(j,1),P.length===0&&delete this._events[y]}}}])&&function(y,O){for(var P=0;P<O.length;P++){var j=O[P];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(y,j.key,j)}}(w.prototype,A),w}();return k.default})()}},B={};function x(m){var g=B[m];if(g!==void 0)return g.exports;var k=B[m]={exports:{}};return D[m].call(k.exports,k,k.exports,x),k.exports}x.n=m=>{var g=m&&m.__esModule?()=>m.default:()=>m;return x.d(g,{a:g}),g},x.d=(m,g)=>{for(var k in g)x.o(g,k)&&!x.o(m,k)&&Object.defineProperty(m,k,{enumerable:!0,get:g[k]})},x.o=(m,g)=>Object.prototype.hasOwnProperty.call(m,g),x.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var q={};return(()=>{x.r(q),x.d(q,{GamepadHandler:()=>i,GamepadListener:()=>N});var m=x(162),g=x.n(m),k=x(944),G=x.n(k);function w(a){return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(a)}function A(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function y(a,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,Z(l.key),l)}}function O(a,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},O(a,t)}function P(a,t){if(t&&(w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}(a)}function j(a){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(a)}function Z(a){var t=function(o,l){if(w(o)!=="object"||o===null)return o;var S=o[Symbol.toPrimitive];if(S!==void 0){var E=S.call(o,"string");if(w(E)!=="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(a);return w(t)==="symbol"?t:String(t)}var u,c,s,i=function(a){(function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&O(n,r)})(e,a);var t,o,l,S,E,L=(S=e,E=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var n,r=j(S);if(E){var b=j(this).constructor;n=Reflect.construct(r,arguments,b)}else n=r.apply(this,arguments);return P(this,n)});function e(n,r){var b,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A(this,e),(b=L.call(this)).index=n,b.gamepad=r,b.options=b.constructor.resolveOptions(M),b.axes=new Array(r.axes.length).fill(null),b.buttons=new Array(r.buttons.length).fill(null),b.initAxes(),b.initButtons(),b}return t=e,l=[{key:"resolveOptions",value:function(n){var r,b,M,T,_=n.axis,F=n.button;return{axis:this.optionResolver.resolve((r=(b=_??F)!==null&&b!==void 0?b:n)!==null&&r!==void 0?r:{}),button:this.optionResolver.resolve((M=(T=F??_)!==null&&T!==void 0?T:n)!==null&&M!==void 0?M:{})}}}],(o=[{key:"initAxes",value:function(){for(var n=this.axes.length,r=0;r<n;r++)this.axes[r]=this.resolveAxisValue(r)}},{key:"initButtons",value:function(){for(var n=this.buttons.length,r=0;r<n;r++)this.buttons[r]=this.resolveButtonValue(r)}},{key:"update",value:function(n){this.gamepad=n,this.updateAxis(),this.updateButtons()}},{key:"updateAxis",value:function(){for(var n=this.axes.length,r=0;r<n;r++)this.setAxisValue(r,this.resolveAxisValue(r))}},{key:"updateButtons",value:function(){for(var n=this.buttons.length,r=0;r<n;r++)this.setButtonValue(r,this.resolveButtonValue(r))}},{key:"setAxisValue",value:function(n,r){this.axes[n]!==r&&(this.axes[n]=r,this.emit("axis",{gamepad:this.gamepad,index:this.index,axis:n,value:r}))}},{key:"setButtonValue",value:function(n,r){this.buttons[n]!==r&&(this.buttons[n]=r,this.emit("button",{gamepad:this.gamepad,index:this.index,button:n,pressed:this.gamepad.buttons[n].pressed,value:r}))}},{key:"resolveAxisValue",value:function(n){var r=this.options.axis,b=r.deadZone,M=r.analog,T=r.precision,_=this.gamepad.axes[n];return b&&_<b&&_>-b?0:M?T?Math.round(_*T)/T:_:_>0?1:_<0?-1:0}},{key:"resolveButtonValue",value:function(n){var r=this.options.button,b=r.deadZone,M=r.analog,T=r.precision,_=this.gamepad.buttons[n].value;return b>0&&_<b&&_>-b?0:M?T?Math.round(_*T)/T:_:_===0?0:1}}])&&y(t.prototype,o),l&&y(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}(g());function f(a){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(a)}function h(a,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,v(l.key),l)}}function v(a){var t=function(o,l){if(f(o)!=="object"||o===null)return o;var S=o[Symbol.toPrimitive];if(S!==void 0){var E=S.call(o,"string");if(f(E)!=="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(a);return f(t)==="symbol"?t:String(t)}u=i,c="optionResolver",s=new(G())().setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"}).setValidators({deadZone:function(a){return Math.max(Math.min(a,1),0)},precision:function(a){return a>0?Math.pow(10,a):0}}),(c=Z(c))in u?Object.defineProperty(u,c,{value:s,enumerable:!0,configurable:!0,writable:!0}):u[c]=s;var d=function(){function a(l){(function(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")})(this,a),this.callback=l,this.frame=null,this.update=this.update.bind(this)}var t,o;return t=a,(o=[{key:"setCallback",value:function(l){this.callback=l}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&h(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),a}();function p(a){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(a)}function R(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function V(a,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,C(l.key),l)}}function C(a){var t=function(o,l){if(p(o)!=="object"||o===null)return o;var S=o[Symbol.toPrimitive];if(S!==void 0){var E=S.call(o,"string");if(p(E)!=="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(a);return p(t)==="symbol"?t:String(t)}function U(a,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},U(a,t)}function K(a,t){if(t&&(p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I(a)}function I(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function W(a){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},W(a)}var N=function(a){(function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&U(e,n)})(L,a);var t,o,l,S,E=(l=L,S=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var e,n=W(l);if(S){var r=W(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return K(this,e)});function L(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(R(this,L),e=E.call(this),typeof navigator.getGamepads!="function")throw new Error("This browser does not support gamepad API.");return e.options=n,e.onAxis=e.onAxis.bind(I(e)),e.update=e.update.bind(I(e)),e.start=e.start.bind(I(e)),e.stop=e.stop.bind(I(e)),e.discover=e.discover.bind(I(e)),e.onButton=e.onButton.bind(I(e)),e.handlers=new Array(4).fill(null),e.loop=new d(e.update),window.addEventListener("error",e.stop),e}return t=L,(o=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var e=navigator.getGamepads();this.discover(e[0],0),this.discover(e[1],1),this.discover(e[2],2),this.discover(e[3],3)}},{key:"discover",value:function(e,n){e?(this.handlers[n]===null&&this.registerHandler(n,e),this.handlers[n].update(e)):this.handlers[n]&&this.removeGamepad(n)}},{key:"registerHandler",value:function(e,n){var r=new i(e,n,this.options);this.handlers[e]=r,r.addEventListener("axis",this.onAxis),r.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:e,gamepad:n}),this.emit("gamepad:".concat(e,":connected"),{index:e,gamepad:n})}},{key:"removeGamepad",value:function(e){var n=this.handlers[e];n.removeEventListener("axis",this.onAxis),n.removeEventListener("button",this.onButton),this.handlers[e]=null,this.emit("gamepad:disconnected",{index:e}),this.emit("gamepad:".concat(e,":disconnected"),{index:e})}},{key:"onAxis",value:function(e){var n=e.detail.index;this.emit("gamepad:axis",e.detail),this.emit("gamepad:".concat(n,":axis"),e.detail),this.emit("gamepad:".concat(n,":axis:").concat(e.detail.axis),e.detail)}},{key:"onButton",value:function(e){var n=e.detail.index;this.emit("gamepad:button",e.detail),this.emit("gamepad:".concat(n,":button"),e.detail),this.emit("gamepad:".concat(n,":button:").concat(e.detail.button),e.detail)}}])&&V(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),L}(g())})(),q})())}(z)),z.exports}var tt=Y();const et=Q({__proto__:null},[tt]);export{et as g};
