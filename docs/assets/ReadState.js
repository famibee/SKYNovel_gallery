import{a as y,d as yt,C as pt,b as wt,E as mt,l as bt}from"./web.js";var D=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var t=1.70158;return e===1?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-D.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?D.Bounce.In(e*2)*.5:D.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(t*2,e)/2:(1-Math.pow(2-t*2,e))/2+.5}}}}),V=function(){return performance.now()},kt=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(n){return t._tweens[n]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},e.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},e.prototype.update=function(t,n){t===void 0&&(t=V()),n===void 0&&(n=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var r=this._tweens[i[s]],o=!n;r&&r.update(t,o)===!1&&!n&&delete this._tweens[i[s]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),I={Linear:function(e,t){var n=e.length-1,i=n*t,s=Math.floor(i),r=I.Utils.Linear;return t<0?r(e[0],e[1],i):t>1?r(e[n],e[n-1],n-i):r(e[s],e[s+1>n?n:s+1],i-s)},Bezier:function(e,t){for(var n=0,i=e.length-1,s=Math.pow,r=I.Utils.Bernstein,o=0;o<=i;o++)n+=s(1-t,i-o)*s(t,o)*e[o]*r(i,o);return n},CatmullRom:function(e,t){var n=e.length-1,i=n*t,s=Math.floor(i),r=I.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(s=Math.floor(i=n*(1+t))),r(e[(s-1+n)%n],e[s],e[(s+1)%n],e[(s+2)%n],i-s)):t<0?e[0]-(r(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(r(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):r(e[s?s-1:0],e[s],e[n<s+1?n:s+1],e[n<s+2?n:s+2],i-s)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=I.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var i=t;i>1;i--)n*=i;return e[t]=n,n}}(),CatmullRom:function(e,t,n,i,s){var r=(n-e)*.5,o=(i-t)*.5,a=s*s,l=s*a;return(2*t-2*n+r+o)*l+(-3*t+3*n-2*r-o)*a+r*s+t}}},Et=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),X=new kt,St=function(){function e(t,n){n===void 0&&(n=X),this._object=t,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=D.Linear.None,this._interpolationFunction=I.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Et.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(t,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},e.prototype.duration=function(t){return t===void 0&&(t=1e3),this._duration=t<0?0:t,this},e.prototype.dynamic=function(t){return t===void 0&&(t=!1),this._isDynamic=t,this},e.prototype.start=function(t,n){if(t===void 0&&(t=V()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var r in this._valuesEnd)s[r]=this._valuesEnd[r];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},e.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},e.prototype._setupProperties=function(t,n,i,s,r){for(var o in i){var a=t[o],l=Array.isArray(a),E=l?"array":typeof a,w=!l&&Array.isArray(i[o]);if(!(E==="undefined"||E==="function")){if(w){var _=i[o];if(_.length===0)continue;for(var A=[a],f=0,R=_.length;f<R;f+=1){var $=this._handleRelativeValue(a,_[f]);if(isNaN($)){w=!1,console.warn("Found invalid interpolation list. Skipping.");break}A.push($)}w&&(i[o]=A)}if((E==="object"||l)&&a&&!w){n[o]=l?[]:{};var N=a;for(var T in N)n[o][T]=N[T];s[o]=l?[]:{};var _=i[o];if(!this._isDynamic){var j={};for(var T in _)j[T]=_[T];i[o]=_=j}this._setupProperties(N,n[o],_,s[o],r)}else(typeof n[o]>"u"||r)&&(n[o]=a),l||(n[o]*=1),w?s[o]=i[o].slice().reverse():s[o]=n[o]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(t){return t===void 0&&(t=V()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this),this)},e.prototype.resume=function(t){return t===void 0&&(t=V()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},e.prototype.stopChainedTweens=function(){for(var t=0,n=this._chainedTweens.length;t<n;t++)this._chainedTweens[t].stop();return this},e.prototype.group=function(t){return t===void 0&&(t=X),this._group=t,this},e.prototype.delay=function(t){return t===void 0&&(t=0),this._delayTime=t,this},e.prototype.repeat=function(t){return t===void 0&&(t=0),this._initialRepeat=t,this._repeat=t,this},e.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},e.prototype.yoyo=function(t){return t===void 0&&(t=!1),this._yoyo=t,this},e.prototype.easing=function(t){return t===void 0&&(t=D.Linear.None),this._easingFunction=t,this},e.prototype.interpolation=function(t){return t===void 0&&(t=I.Linear),this._interpolationFunction=t,this},e.prototype.chain=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._chainedTweens=t,this},e.prototype.onStart=function(t){return this._onStartCallback=t,this},e.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},e.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},e.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},e.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},e.prototype.onStop=function(t){return this._onStopCallback=t,this},e.prototype.update=function(t,n){var i=this,s;if(t===void 0&&(t=V()),n===void 0&&(n=!0),this._isPaused)return!0;var r,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>o)return!1;n&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=t-this._startTime,l=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),E=this._duration+this._repeat*l,w=function(){if(i._duration===0||a>E)return 1;var N=Math.trunc(a/l),T=a-N*l,j=Math.min(T/i._duration,1);return j===0&&a===i._duration?1:j},_=w(),A=this._easingFunction(_);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,A),this._onUpdateCallback&&this._onUpdateCallback(this._object,_),this._duration===0||a>=this._duration)if(this._repeat>0){var f=Math.min(Math.trunc((a-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=f);for(r in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[r]=="string"&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*f,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var R=0,$=this._chainedTweens.length;R<$;R++)this._chainedTweens[R].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(t,n,i,s){for(var r in i)if(n[r]!==void 0){var o=n[r]||0,a=i[r],l=Array.isArray(t[r]),E=Array.isArray(a),w=!l&&E;w?t[r]=this._interpolationFunction(a,s):typeof a=="object"&&a?this._updateProperties(t[r],o,a,s):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(t[r]=o+(a-o)*s))}},e.prototype._handleRelativeValue=function(t,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?t+parseFloat(n):parseFloat(n)},e.prototype._swapEndStartRepeatValues=function(t){var n=this._valuesStartRepeat[t],i=this._valuesEnd[t];typeof i=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(i):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=n},e}(),k=X;k.getAll.bind(k);var Ct=k.removeAll.bind(k);k.add.bind(k);var ut=k.remove.bind(k),Ft=k.update.bind(k);let ht,tt,u,S,v,dt,ft,_t,O,gt=()=>{},et,ct,z=!0,C=!1,b=!1,P=!1,c={},m={},d,g=0,p=0,q;const xt="color: yellow; text-shadow: 1px 1px 0 #000, -1px 1px 0 #000, 1px -1px 0 #000, -1px -1px 0 #000;";let Z=[];function B(){z||(z=!0,u.setVal_Nochk("tmp","sn.tagL.enabled",!0)),b&&(b=!1,u.setVal_Nochk("tmp","sn.skip.enabled",!1)),P&&(P=!1,u.setVal_Nochk("tmp","sn.auto.enabled",!1))}function x(){F()}function It(){W()}let F=()=>new H,W=()=>new vt;function Pt(e,t){d=JSON.parse(e),g=d.length,p>=g&&(p=g-1),q=t}class lt{#t=new mt;constructor(t,n){if(b&&!C&&!v.isNextKidoku&&B(),y(t,"canskip",!0)){const i=()=>{this.destroy(),B(),n()};this.#t.add(window,"pointerdown",s=>{s.stopPropagation(),i()}),this.#t.add(window,"keydown",s=>{s.isComposing||(s.stopPropagation(),i())}),gt(this.#t,i)}}destroy(){this.#t.clear()}}class h{constructor(t){this.hArg=t,F=()=>new H,W=()=>new vt,ht(this)}static init(t,n,i,s,r,o,a,l,E,w,_){ht=t,tt=n,u=i,S=s,v=r,dt=o,ft=a,_t=l,O=()=>S.goTxt(),gt=E,et=w,ct=_,new H,u.defTmp("sn.tagL.enabled",()=>z),u.defValTrg("tmp:sn.tagL.enabled",(A,f)=>z=String(f)!=="false"),u.defTmp("sn.skip.all",()=>C),u.defValTrg("tmp:sn.skip.all",(A,f)=>C=String(f)!=="false"),u.defTmp("sn.skip.enabled",()=>b),u.defValTrg("tmp:sn.skip.enabled",(A,f)=>b=String(f)!=="false"),u.defTmp("sn.auto.enabled",()=>P),u.defValTrg("tmp:sn.auto.enabled",(A,f)=>P=String(f)!=="false"),c={},m={}}destroy(){this.onFinish=()=>{},this.onUserAct=()=>{},this.#n.destroy()}get isSkipping(){return b}static getHtmlElmList(t){const n=t.indexOf(":");let i="";if(n>=0){const s=t.slice(4,n),r=`const.sn.frm.${s}`;if(!u.getVal(`tmp:${r}`,0))throw`HTML【${s}】が読み込まれていません`;const o=document.getElementById(s).contentWindow;return i=t.slice(n+1),{el:o.document.querySelectorAll(i),id:s,sel:i}}return i=t.slice(4),{el:document.querySelectorAll(i),id:"",sel:i}}static setEvt2Fnc(t,n,i){t?m[n]=i:c[n]=i}static getEvt2Fnc=t=>c[t]??m[t];static clear_eventer(t,n,i){if(!t.startsWith("dom="))return;const s=n?m[i]:c[i];s&&h.getHtmlElmList(t).el.forEach(r=>r.removeEventListener("click",s)),n?delete m[i]:delete c[i]}static clear_event(t){const n=y(t,"global",!1),i=n?m:c;for(const[s,r]of Object.entries(i))s.startsWith("dom=")&&h.getHtmlElmList(s).el.forEach(o=>o.removeEventListener("click",r));return n?m={}:c={},!1}s(t){return this.#i(),K.go(t)}wait=t=>b?(!C&&!v.isNextKidoku&&B(),!1):it.go(t);waitclick=t=>ot.go(t);waitTxtAndTimer(t,n){return h.#t.once(h.#e,()=>{if(this.#n.destroy(),t===0){this.onFinish();return}const i=new St({}).to({},t).onComplete(()=>{this.#n.destroy(),ut(i),this.onFinish()}).start();this.waitLimitedEvent(n,()=>{i.stop(),ut(i),this.onUserAct()})}),O(),u.saveKidoku(),this.waitLimitedEvent(n,()=>{h.#t.removeAllListeners(),this.onUserAct()})}static noticeCompTxt(){h.#t.emit(h.#e)}static#t=new yt;static#e="sn:notice_comp_txt";static popLocalEvts(){const t=c;return c={},t}static pushLocalEvts(t){c=t}waitRsvEvent(t,n){if(u.saveKidoku(),t?c.click=c.enter=c.arrowdown=c["wheel.y>0"]=()=>this.onUserAct():(delete c.click,delete c.enter,delete c.arrowdown,delete c["wheel.y>0"]),h.getEvt2Fnc=n?i=>c[i]??m[i]:i=>c[i],v.noticeWait(),pt.debugLog){const i=Object.create(null);i.local=Object.keys(c),i.global=Object.keys(m),console.log("🎍 wait event... %o",i)}}l(t){if(!z)return!1;if(this.#i(!0),P){const n=Number(u.getVal(`sys:sn.auto.msecLineWait${v.isKidoku?"_Kidoku":""}`));return Q.go(n,t)}if(b){if(!C&&!v.isNextKidoku)return L.go(t);if("ps".includes(u.getVal("sys:sn.skip.mode")))return Q.go(50,t)}return st.go(t)}p(t){if(this.#i(),P){const n=Number(u.getVal(`sys:sn.auto.msecPageWait${v.isKidoku?"_Kidoku":""}`));return J.go(n,t)}if(b){if(!C&&!v.isNextKidoku)return U.go(t);if(u.getVal("sys:sn.skip.mode")=="s")return J.go(50,t)}return rt.go(t)}waitLimitedEvent(t,n){return this.#n.destroy(),this.#n=new lt(t,n),!0}breakEvent(t){h.evnm===t&&(h.evnm="",this.#n.destroy(),x())}#n=new lt({},()=>{});static evnm="";waitEvent(t,n,i){return h.evnm=t,b&&!C&&!v.isNextKidoku?Y.go(n,i):at.go(n,i)}onFinish(){}onUserAct(){}isWait=!1;fire(t,n){}page(t){if(!("clear"in t||"to"in t||"style"in t))throw"clear,style,to いずれかは必須です";const{style:n}=t;if(n)return q=n,u.setVal_Nochk("save","const.sn.styPaging",n),!1;if(y(t,"clear",!1))return d=[],g=0,p=0,u.setVal_Nochk("sys","const.sn.aPageLog","[]"),u.setVal_Nochk("save","const.sn.styPaging",xt),!1;const{to:i,key:s}=t;switch(s&&(Z=s.split(",")),i){case"prev":if(p=g-1,g<2)return!1;break}return G.go(t)}#i(t=!1){if(!u.getVal("save:sn.doRecLog"))return;const{fn:n,idx:i}=v.nowScrIdx(),s=`${i-1}:`+n;if(d.findIndex(o=>o.key===s)>-1)return;d.at(-1)?.week&&d.pop();const{max_len:r}=ct.oCfg.log;d.push({key:s,week:t,fn:u.getVal("save:const.sn.scriptFn",n),index:u.getVal("save:const.sn.scriptIdx",0),mark:v.nowMark()})>r&&(d=d.slice(-r)),g=d.length,u.setVal_Nochk("sys","const.sn.aPageLog",JSON.stringify(d))}}class H extends h{constructor(){super({}),tt.resume(),et.hidden=!0}breakEvent(){}}class M extends h{isWait=!0;fire(t,n){const i=t.toLowerCase();if(pt.debugLog&&console.log(`👺 fire<(key:\`${i}\` type:${n.type} e:%o)`,{...n}),i==="enter"){const r=_t.getFocus();if(r instanceof bt){r.emit("pointerdown",new Event("pointerdown"));return}}const s=h.getEvt2Fnc(i);if(!s){i.startsWith("swipe")&&globalThis.scrollBy(-n.deltaX||0,-n.deltaY||0);return}i.endsWith("wheel")||n.preventDefault?.(),n.stopPropagation(),!(!i.startsWith("dom=")&&S.clickTxtLay())&&s(n)}}class K extends M{static go=t=>(new K(t).waitTxtAndTimer(0,{}),F=()=>{},!0);breakEvent(){}onFinish(){nt.go(this.hArg)}onUserAct(){this.onFinish()}}class nt extends M{static go=t=>{B();const n=y(t,"global",!0);return new nt(t).waitRsvEvent(!1,n),F=()=>{},!0};breakEvent(){}onFinish(){}onUserAct(){}}class it extends h{static go=t=>{const n=wt(t,"time",NaN);return new it(t).waitTxtAndTimer(n,t)};onFinish(){x()}onUserAct(){this.onFinish()}}class st extends h{static go=t=>new st(t).waitTxtAndTimer(0,t);breakEvent(){}onFinish(){L.go(this.hArg)}onUserAct(){this.onFinish()}}class Q extends h{static go=(t,n)=>new Q(n).waitTxtAndTimer(t,n);breakEvent(){}onFinish(){x()}onUserAct(){L.go(this.hArg)}}class L extends M{static go=t=>{y(t,"visible",!0)&&S.breakLine(t),O();const n=y(t,"global",!0);return new L(t).waitRsvEvent(!0,n),!0};onFinish(){x()}onUserAct(){x()}}class rt extends h{static go=t=>new rt(t).waitTxtAndTimer(0,t);breakEvent(){}onFinish(){U.go(this.hArg)}onUserAct(){this.onFinish()}}class J extends h{static go=(t,n)=>new J(n).waitTxtAndTimer(t,n);breakEvent(){}onFinish(){x()}onUserAct(){U.go(this.hArg)}}class U extends M{static go=t=>{y(t,"visible",!0)&&S.breakPage(t),O();const n=y(t,"global",!0);return new U(t).waitRsvEvent(!0,n),!0};onFinish(){y(this.hArg,"er",!1)&&ft.er(this.hArg),dt.clearCache(),x()}onUserAct(){this.onFinish()}}class ot extends M{static go=t=>new ot(t).waitTxtAndTimer(0,t);onFinish(){B();const t=y(this.hArg,"global",!0);this.waitRsvEvent(!0,t)}onUserAct(){x()}}class at extends h{constructor(t,n){super(t),this.onIntr=n}static go=(t,n)=>new at(t,n).waitTxtAndTimer(0,t);onFinish(){Y.go(this.hArg,this.onIntr)}onUserAct(){this.onFinish()}}class Y extends M{constructor(t,n){super(t),this.onIntr=n}static go=(t,n)=>new Y(t,n).waitLimitedEvent(t,n);onFinish(){x()}onUserAct(){this.onIntr(),this.onFinish()}}class vt extends h{constructor(){super({}),F=()=>new H,W=()=>{}}breakEvent(){}}class G extends K{constructor(t){super(t),F=()=>{},W=()=>new At}get isSkipping(){return!d[p]?.week}s=t=>K.go(t);wait=()=>!1;waitclick=()=>!1;waitTxtAndTimer=()=>!1;l(t){return p===g-1?(this.#e(),L.go(t)):(S.setAllStyle2TxtLay(q),O(),d[p]?.week?(y(t,"visible",!0)&&S.breakLine(t),this.#t(),!0):!1)}#t(){this.waitRsvEvent(!1,!0);let t={};if(Z.length===0)t=m;else for(const n of Z){const i=m[n];i&&(t[n]=i)}h.getEvt2Fnc=n=>c[n]??t[n]}p(t){return p===g-1?(this.#e(),U.go(t)):(S.setAllStyle2TxtLay(q),O(),y(t,"visible",!0)&&S.breakPage(t),this.#t(),!0)}static go=t=>(u.setVal_Nochk("tmp","const.sn.isPaging",!0),new G(t).page(t));page(t){const{to:n,style:i,clear:s}=t;if(i||s)return!1;switch(n){case"prev":if(p===0)return!1;--p;break;case"next":if(p===g-1)return!1;++p;break;case"exit":p=g-1,this.#e();break;case"load":g=p+1,d=d.slice(0,g);break;default:throw`属性to「${n}」は異常です`}const r=d[p];if(!r)throw`[page] posPage異常:${p}`;const{fn:o,index:a,mark:l}=r;return v.loadFromMark({fn:o,index:a},l)}#e(){u.setVal_Nochk("tmp","const.sn.isPaging",!1)}onFinish(){}onUserAct(){}}class At extends h{constructor(){super({}),F=()=>{new G({}),tt.resume(),et.hidden=!0},W=()=>{}}breakEvent(){}}export{Ft as I,Pt as M,It as O,xt as P,Ct as S,D as W,x as a,h as f,ut as l,St as x};
