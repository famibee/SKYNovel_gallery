"use strict";(self.webpackChunkgallery=self.webpackChunkgallery||[]).push([[746,904],{9904:(t,e,n)=>{n.r(e),n.d(e,{PropParser:()=>a});var r,s=n(662),i={exports:{}},o=(r||(r=1,typeof self<"u"&&self,i.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){function r(t){if(!(this instanceof r))return new r(t);this._=t}var s=r.prototype;function i(t,e){for(var n=0;n<t;n++)e(n)}function o(t,e,n){return r=function(n,r,s){e=t(e,n,r,s)},i((s=n).length,(function(t){r(s[t],t,s)})),e;var r,s}function a(t,e){return o((function(e,n,r,s){return e.concat([t(n,r,s)])}),[],e)}function u(){return typeof Buffer<"u"}function c(){if(!u())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function h(t){c();var e=o((function(t,e){return t+e}),0,t);if(e%8!=0)throw new Error("The bits ["+t.join(", ")+"] add up to "+e+" which is not an even number of bytes; the total should be divisible by 8");var n,s=e/8,u=(n=function(t){return t>48},o((function(t,e){return t||(n(e)?e:t)}),null,t));if(u)throw new Error(u+" bit range requested exceeds 48 bit (6 byte) Number max.");return new r((function(e,n){var r=s+n;return r>e.length?k(n,s.toString()+" bytes"):w(r,o((function(t,e){var n=function(t,e){var n={v:0,buf:e};return i(t,(function(){var t,e,r;n={v:n.v<<1|(t=n.buf,t[0]>>7),buf:(e=n.buf,r=o((function(t,e,n,r){return t.concat(n===r.length-1?Buffer.from([e,0]).readUInt16BE(0):r.readUInt16BE(n))}),[],e),Buffer.from(a((function(t){return(t<<1&65535)>>8}),r)))}})),n}(e,t.buf);return{coll:t.coll.concat(n.v),buf:n.buf}}),{coll:[],buf:e.slice(n,r)},t).coll)}))}function f(t,e){return new r((function(n,r){return c(),r+e>n.length?k(r,e+" bytes for "+t):w(r+e,n.slice(r,r+e))}))}function l(t,e){if("number"!=typeof(n=e)||Math.floor(n)!==n||e<0||e>6)throw new Error(t+" requires integer length in range [0, 6].");var n}function p(t){return l("uintBE",t),f("uintBE("+t+")",t).map((function(e){return e.readUIntBE(0,t)}))}function g(t){return l("uintLE",t),f("uintLE("+t+")",t).map((function(e){return e.readUIntLE(0,t)}))}function m(t){return l("intBE",t),f("intBE("+t+")",t).map((function(e){return e.readIntBE(0,t)}))}function d(t){return l("intLE",t),f("intLE("+t+")",t).map((function(e){return e.readIntLE(0,t)}))}function y(t){return t instanceof r}function b(t){return"[object Array]"==={}.toString.call(t)}function v(t){return u()&&Buffer.isBuffer(t)}function w(t,e){return{status:!0,index:t,value:e,furthest:-1,expected:[]}}function k(t,e){return b(e)||(e=[e]),{status:!1,index:-1,value:null,furthest:t,expected:e}}function x(t,e){if(!e||t.furthest>e.furthest)return t;var n=t.furthest===e.furthest?function(t,e){if(function(){if(void 0!==r._supportsSet)return r._supportsSet;var t=typeof Set<"u";return r._supportsSet=t,t}()&&Array.from){for(var n=new Set(t),s=0;s<e.length;s++)n.add(e[s]);var i=Array.from(n);return i.sort(),i}for(var o={},a=0;a<t.length;a++)o[t[a]]=!0;for(var u=0;u<e.length;u++)o[e[u]]=!0;var c=[];for(var h in o)({}).hasOwnProperty.call(o,h)&&c.push(h);return c.sort(),c}(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:n}}var _={};function N(t,e){if(v(t))return{offset:e,line:-1,column:-1};t in _||(_[t]={});for(var n=_[t],r=0,s=0,i=0,o=e;o>=0;){if(o in n){r=n[o].line,0===i&&(i=n[o].lineStart);break}("\n"===t.charAt(o)||"\r"===t.charAt(o)&&"\n"!==t.charAt(o+1))&&(s++,0===i&&(i=o+1)),o--}var a=r+s,u=e-i;return n[e]={line:a,lineStart:i},{offset:e,line:a+1,column:u+1}}function S(t){if(!y(t))throw new Error("not a parser: "+t)}function E(t,e){return"string"==typeof t?t.charAt(e):t[e]}function O(t){if("number"!=typeof t)throw new Error("not a number: "+t)}function j(t){if("function"!=typeof t)throw new Error("not a function: "+t)}function A(t){if("string"!=typeof t)throw new Error("not a string: "+t)}function P(t,e){return new Array(e+1).join(t)}function B(t,e,n){var r=e-t.length;return r<=0?t:P(n,r)+t}function V(t,e,n,r){return{from:t-e>0?t-e:0,to:t+n>r?r:t+n}}function C(t,e){var n,r,s,i,u,c,h=e.index,f=h.offset,l=1;if(f===t.length)return"Got the end of the input";if(v(t)){var p=f-f%8,g=f-p,m=V(p,40,40,t.length),d=a((function(t){return a((function(t){return B(t.toString(16),2,"0")}),t)}),function(t){var e=t.length,n=[],r=0;if(e<=8)return[t.slice()];for(var s=0;s<e;s++)n[r]||n.push([]),n[r].push(t[s]),(s+1)%8==0&&r++;return n}(t.slice(m.from,m.to).toJSON().data));i=0===(c=m).from&&1===c.to?{from:c.from,to:c.to}:{from:c.from/8,to:Math.floor(c.to/8)},r=p/8,n=3*g,g>=4&&(n+=1),l=2,s=a((function(t){return t.length<=4?t.join(" "):t.slice(0,4).join(" ")+"  "+t.slice(4).join(" ")}),d),(u=(8*(i.to>0?i.to-1:i.to)).toString(16).length)<2&&(u=2)}else{var y=t.split(/\r\n|[\n\r\u2028\u2029]/);n=h.column-1,r=h.line-1,i=V(r,2,3,y.length),s=y.slice(i.from,i.to),u=i.to.toString().length}var b=r-i.from;return v(t)&&(u=(8*(i.to>0?i.to-1:i.to)).toString(16).length)<2&&(u=2),o((function(e,r,s){var o,a=s===b,c=a?"> ":"  ";return o=v(t)?B((8*(i.from+s)).toString(16),u,"0"):B((i.from+s+1).toString(),u," "),[].concat(e,[c+o+" | "+r],a?["  "+P(" ",u)+" | "+B("",n," ")+P("^",l)]:[])}),[],s).join("\n")}function L(t,e){return["\n","-- PARSING FAILED "+P("-",50),"\n\n",C(t,e),"\n\n",(n=e.expected,1===n.length?"Expected:\n\n"+n[0]:"Expected one of the following: \n\n"+n.join(", ")),"\n"].join("");var n}function W(t){return void 0!==t.flags?t.flags:[t.global?"g":"",t.ignoreCase?"i":"",t.multiline?"m":"",t.unicode?"u":"",t.sticky?"y":""].join("")}function M(){for(var t=[].slice.call(arguments),e=t.length,n=0;n<e;n+=1)S(t[n]);return r((function(n,r){for(var s,i=new Array(e),o=0;o<e;o+=1){if(!(s=x(t[o]._(n,r),s)).status)return s;i[o]=s.value,r=s.index}return x(w(r,i),s)}))}function F(){var t=[].slice.call(arguments);if(0===t.length)throw new Error("seqMap needs at least one argument");var e=t.pop();return j(e),M.apply(null,t).map((function(t){return e.apply(null,t)}))}function I(){var t=[].slice.call(arguments),e=t.length;if(0===e)return z("zero alternates");for(var n=0;n<e;n+=1)S(t[n]);return r((function(e,n){for(var r,s=0;s<t.length;s+=1)if((r=x(t[s]._(e,n),r)).status)return r;return r}))}function D(t,e){return K(t,e).or(J([]))}function K(t,e){return S(t),S(e),F(t,e.then(t).many(),(function(t,e){return[t].concat(e)}))}function q(t){A(t);var e="'"+t+"'";return r((function(n,r){var s=r+t.length,i=n.slice(r,s);return i===t?w(s,i):k(r,e)}))}function R(t,e){(function(t){if(!(t instanceof RegExp))throw new Error("not a regexp: "+t);for(var e=W(t),n=0;n<e.length;n++){var r=e.charAt(n);if("i"!==r&&"m"!==r&&"u"!==r&&"s"!==r)throw new Error('unsupported regexp flag "'+r+'": '+t)}})(t),arguments.length>=2?O(e):e=0;var n,s=(n=t,RegExp("^(?:"+n.source+")",W(n))),i=""+t;return r((function(t,n){var r=s.exec(t.slice(n));if(r){if(0<=e&&e<=r.length){var o=r[0],a=r[e];return w(n+o.length,a)}return k(n,"valid match group (0 to "+r.length+") in "+i)}return k(n,i)}))}function J(t){return r((function(e,n){return w(n,t)}))}function z(t){return r((function(e,n){return k(n,t)}))}function T(t){if(y(t))return r((function(e,n){var r=t._(e,n);return r.index=n,r.value="",r}));if("string"==typeof t)return T(q(t));if(t instanceof RegExp)return T(R(t));throw new Error("not a string, regexp, or parser: "+t)}function $(t){return S(t),r((function(e,n){var r=t._(e,n),s=e.slice(n,r.index);return r.status?k(n,'not "'+s+'"'):w(n,null)}))}function G(t){return j(t),r((function(e,n){var r=E(e,n);return n<e.length&&t(r)?w(n+1,r):k(n,"a character/byte matching "+t)}))}function U(t,e){arguments.length<2&&(e=t,t=void 0);var n=r((function(t,r){return n._=e()._,n._(t,r)}));return t?n.desc(t):n}function H(){return z("fantasy-land/empty")}s.parse=function(t){if("string"!=typeof t&&!v(t))throw new Error(".parse must be called with a string or Buffer as its argument");var e,n=this.skip(X)._(t,0);return e=n.status?{status:!0,value:n.value}:{status:!1,index:N(t,n.furthest),expected:n.expected},delete _[t],e},s.tryParse=function(t){var e=this.parse(t);if(e.status)return e.value;var n=L(t,e),r=new Error(n);throw r.type="ParsimmonError",r.result=e,r},s.assert=function(t,e){return this.chain((function(n){return t(n)?J(n):z(e)}))},s.or=function(t){return I(this,t)},s.trim=function(t){return this.wrap(t,t)},s.wrap=function(t,e){return F(t,this,e,(function(t,e){return e}))},s.thru=function(t){return t(this)},s.then=function(t){return S(t),M(this,t).map((function(t){return t[1]}))},s.many=function(){var t=this;return r((function(e,n){for(var r=[],s=void 0;;){if(!(s=x(t._(e,n),s)).status)return x(w(n,r),s);if(n===s.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");n=s.index,r.push(s.value)}}))},s.tieWith=function(t){return A(t),this.map((function(e){if(function(t){if(!b(t))throw new Error("not an array: "+t)}(e),e.length){A(e[0]);for(var n=e[0],r=1;r<e.length;r++)A(e[r]),n+=t+e[r];return n}return""}))},s.tie=function(){return this.tieWith("")},s.times=function(t,e){var n=this;return arguments.length<2&&(e=t),O(t),O(e),r((function(r,s){for(var i=[],o=void 0,a=void 0,u=0;u<t;u+=1){if(a=x(o=n._(r,s),a),!o.status)return a;s=o.index,i.push(o.value)}for(;u<e&&(a=x(o=n._(r,s),a),o.status);u+=1)s=o.index,i.push(o.value);return x(w(s,i),a)}))},s.result=function(t){return this.map((function(){return t}))},s.atMost=function(t){return this.times(0,t)},s.atLeast=function(t){return F(this.times(t),this.many(),(function(t,e){return t.concat(e)}))},s.map=function(t){j(t);var e=this;return r((function(n,r){var s=e._(n,r);return s.status?x(w(s.index,t(s.value)),s):s}))},s.contramap=function(t){j(t);var e=this;return r((function(n,r){var s=e.parse(t(n.slice(r)));return s.status?w(r+n.length,s.value):s}))},s.promap=function(t,e){return j(t),j(e),this.contramap(t).map(e)},s.skip=function(t){return M(this,t).map((function(t){return t[0]}))},s.mark=function(){return F(Z,this,Z,(function(t,e,n){return{start:t,value:e,end:n}}))},s.node=function(t){return F(Z,this,Z,(function(e,n,r){return{name:t,value:n,start:e,end:r}}))},s.sepBy=function(t){return D(this,t)},s.sepBy1=function(t){return K(this,t)},s.lookahead=function(t){return this.skip(T(t))},s.notFollowedBy=function(t){return this.skip($(t))},s.desc=function(t){b(t)||(t=[t]);var e=this;return r((function(n,r){var s=e._(n,r);return s.status||(s.expected=t),s}))},s.fallback=function(t){return this.or(J(t))},s.ap=function(t){return F(t,this,(function(t,e){return t(e)}))},s.chain=function(t){var e=this;return r((function(n,r){var s=e._(n,r);return s.status?x(t(s.value)._(n,s.index),s):s}))},s.concat=s.or,s.empty=H,s.of=J,s["fantasy-land/ap"]=s.ap,s["fantasy-land/chain"]=s.chain,s["fantasy-land/concat"]=s.concat,s["fantasy-land/empty"]=s.empty,s["fantasy-land/of"]=s.of,s["fantasy-land/map"]=s.map;var Z=r((function(t,e){return w(e,N(t,e))})),Y=r((function(t,e){return e>=t.length?k(e,"any character/byte"):w(e+1,E(t,e))})),Q=r((function(t,e){return w(t.length,t.slice(e))})),X=r((function(t,e){return e<t.length?k(e,"EOF"):w(e,null)})),tt=R(/[0-9]/).desc("a digit"),et=R(/[0-9]*/).desc("optional digits"),nt=R(/[a-z]/i).desc("a letter"),rt=R(/[a-z]*/i).desc("optional letters"),st=R(/\s*/).desc("optional whitespace"),it=R(/\s+/).desc("whitespace"),ot=q("\r"),at=q("\n"),ut=q("\r\n"),ct=I(ut,at,ot).desc("newline"),ht=I(ct,X);r.all=Q,r.alt=I,r.any=Y,r.cr=ot,r.createLanguage=function(t){var e={};for(var n in t)({}).hasOwnProperty.call(t,n)&&function(n){e[n]=U((function(){return t[n](e)}))}(n);return e},r.crlf=ut,r.custom=function(t){return r(t(w,k))},r.digit=tt,r.digits=et,r.empty=H,r.end=ht,r.eof=X,r.fail=z,r.formatError=L,r.index=Z,r.isParser=y,r.lazy=U,r.letter=nt,r.letters=rt,r.lf=at,r.lookahead=T,r.makeFailure=k,r.makeSuccess=w,r.newline=ct,r.noneOf=function(t){return G((function(e){return t.indexOf(e)<0})).desc("none of '"+t+"'")},r.notFollowedBy=$,r.of=J,r.oneOf=function(t){for(var e=t.split(""),n=0;n<e.length;n++)e[n]="'"+e[n]+"'";return G((function(e){return t.indexOf(e)>=0})).desc(e)},r.optWhitespace=st,r.Parser=r,r.range=function(t,e){return G((function(n){return t<=n&&n<=e})).desc(t+"-"+e)},r.regex=R,r.regexp=R,r.sepBy=D,r.sepBy1=K,r.seq=M,r.seqMap=F,r.seqObj=function(){for(var t,e={},n=0,s=(t=arguments,Array.prototype.slice.call(t)),i=s.length,o=0;o<i;o+=1){var a=s[o];if(!y(a)){if(b(a)&&2===a.length&&"string"==typeof a[0]&&y(a[1])){var u=a[0];if(Object.prototype.hasOwnProperty.call(e,u))throw new Error("seqObj: duplicate key "+u);e[u]=!0,n++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===n)throw new Error("seqObj expects at least one named parser, found zero");return r((function(t,e){for(var n,r={},o=0;o<i;o+=1){var a,u;if(b(s[o])?(a=s[o][0],u=s[o][1]):(a=null,u=s[o]),!(n=x(u._(t,e),n)).status)return n;a&&(r[a]=n.value),e=n.index}return x(w(e,r),n)}))},r.string=q,r.succeed=J,r.takeWhile=function(t){return j(t),r((function(e,n){for(var r=n;r<e.length&&t(E(e,r));)r++;return w(r,e.slice(n,r))}))},r.test=G,r.whitespace=it,r["fantasy-land/empty"]=H,r["fantasy-land/of"]=J,r.Binary={bitSeq:h,bitSeqObj:function(t){c();var e={},n=0,r=a((function(t){if(b(t)){var r=t;if(2!==r.length)throw new Error("["+r.join(", ")+"] should be length 2, got length "+r.length);if(A(r[0]),O(r[1]),Object.prototype.hasOwnProperty.call(e,r[0]))throw new Error("duplicate key in bitSeqObj: "+r[0]);return e[r[0]]=!0,n++,r}return O(t),[null,t]}),t);if(n<1)throw new Error("bitSeqObj expects at least one named pair, got ["+t.join(", ")+"]");var s=a((function(t){return t[0]}),r);return h(a((function(t){return t[1]}),r)).map((function(t){return o((function(t,e){return null!==e[0]&&(t[e[0]]=e[1]),t}),{},a((function(e,n){return[e,t[n]]}),s))}))},byte:function(t){if(c(),O(t),t>255)throw new Error("Value specified to byte constructor ("+t+"=0x"+t.toString(16)+") is larger in value than a single byte.");var e=(t>15?"0x":"0x0")+t.toString(16);return r((function(n,r){var s=E(n,r);return s===t?w(r+1,s):k(r,e)}))},buffer:function(t){return f("buffer",t).map((function(t){return Buffer.from(t)}))},encodedString:function(t,e){return f("string",e).map((function(e){return e.toString(t)}))},uintBE:p,uint8BE:p(1),uint16BE:p(2),uint32BE:p(4),uintLE:g,uint8LE:g(1),uint16LE:g(2),uint32LE:g(4),intBE:m,int8BE:m(1),int16BE:m(2),int32BE:m(4),intLE:d,int8LE:d(1),int16LE:d(2),int32LE:d(4),floatBE:f("floatBE",4).map((function(t){return t.readFloatBE(0)})),floatLE:f("floatLE",4).map((function(t){return t.readFloatLE(0)})),doubleBE:f("doubleBE",8).map((function(t){return t.readDoubleBE(0)})),doubleLE:f("doubleLE",8).map((function(t){return t.readDoubleLE(0)}))},t.exports=r}])),i.exports);class a{constructor(t,e="\\"){function n(t){const e=[];for(const n of t)e.push(("string"==typeof n?o.string(n):o.regex(n)).trim(o.optWhitespace));return o.alt.apply(null,e)}function r(t){let e=Object.keys(t).sort().map((e=>("string"==typeof t[e]?o.string(t[e]):o.regex(t[e])).trim(o.optWhitespace).result(e)));return o.alt.apply(null,e)}function i(t,e){const n=o.lazy((()=>o.seq(t,n).or(e)));return n}function a(t,e){return o.seqMap(e,t.many(),((t,e)=>e.reduce(((t,e)=>[e,t]),t)))}function u(t,e){let n=o.lazy((()=>e.chain((e=>o.seq(t,o.of(e),n).or(o.of(e))))));return n}function c(t,e){return o.seqMap(e,o.seq(t,e).many(),((t,e)=>e.reduce(((t,e)=>[e[0],t,e[1]]),t)))}this.val=t;const h=o.alt(o.alt(o.regex(/-?(0|[1-9][0-9]*)\.[0-9]+/),o.regex(/0x[0-9a-fA-F]+/)).map(Number),o.alt(o.regex(/-?(0|[1-9][0-9]*)/)).map((t=>(0,s.i)(t)))).map((t=>["!num!",t])).desc("number"),f=o.string("null").map((()=>["!str!",null])),l=o.regex(/(true|false)/).map((t=>["!bool!","true"===t])).desc("boolean"),p=o.regex(new RegExp(`(?:"(?:\\${e}["'#\\n]|[^"])*"|'(?:\\${e}["'#\\n]|[^'])*'|\\#(?:\\${e}["'#\\n]|[^#])*\\#)`)).map((t=>["!str!",t.slice(1,-1).replaceAll(e,"")])).desc("string"),g=/\[[^\]]+\]/g,m=o.regex(/-?(?:(?:tmp|sys|save|mp):)?[^\s!-\/:-@[-^`{-~]+(?:\.[^\s!-\/:-@[-^`{-~]+|\[[^\]]+\])*(?:@str)?/).map((t=>{const e=String(t).replaceAll(g,(t=>"."+this.parse(t.slice(1,-1)))),n=this.val.getVal(e);return null==n?["!str!",n]:"boolean"==typeof n?["!bool!",n]:"[object String]"===Object.prototype.toString.call(n)?["!str!",String(n)]:["!num!",Number(n)]})).desc("string"),d=o.lazy((()=>o.string("(").then(this.#t).skip(o.string(")")).or(h).or(f).or(l).or(p).or(m))),y=[{type:i,ops:n([/[A-Za-z_][A-Za-z0-9_]*(?=\()/])},{type:a,ops:r({PostfixInc:"++"})},{type:a,ops:r({PostfixDec:"--"})},{type:i,ops:n([/!(?!=)|~/])},{type:i,ops:r({PrefixInc:"++"})},{type:i,ops:r({PrefixDec:"--"})},{type:i,ops:r({UnaryNegate:/-(?!-)/})},{type:u,ops:n(["**"])},{type:c,ops:n(["*","/","¥","%"])},{type:c,ops:n(["+","-"])},{type:c,ops:n([/>>>|<<|>>/])},{type:c,ops:n([/<=|<|>=|>/])},{type:c,ops:n([/===|!==|==|!=/])},{type:c,ops:n([/&(?!&)/])},{type:c,ops:n(["^"])},{type:c,ops:n([/\|(?!\|)/])},{type:c,ops:n(["&&"])},{type:c,ops:n(["||"])},{type:u,ops:n([":"])},{type:u,ops:n(["?"])}].reduce(((t,e)=>e.type(e.ops,t)),d);this.#t=y.trim(o.optWhitespace)}#t=null;parse(t){const e=this.#t.parse(t);if(!e.status)throw Error("(PropParser)文法エラー【"+t+"】");const n=e.value;return"!str!"===n[0]?this.#e(n[1]):this.#n(n)}#n(t){const e=t.shift();if(e instanceof Array)return this.#n(e);const n=this.#r[e];return n?n(t):Object(null)}#r={"!num!":t=>t.shift(),"!str!":t=>this.#e(t.shift()),"!bool!":t=>t.shift(),PostfixInc:t=>{throw Error("(PropParser)後置インクリメントは未サポートです")},PostfixDec:t=>{throw Error("(PropParser)後置デクリメントは未サポートです")},PrefixInc:t=>{throw Error("(PropParser)前置インクリメントは未サポートです")},PrefixDec:t=>{throw Error("(PropParser)前置デクリメントは未サポートです")},"!":t=>!this.#r.Boolean(t),"~":t=>~Number(this.#n(t.shift())),UnaryNegate:t=>-this.#r.Number(t),"**":t=>Number(this.#n(t.shift()))**Number(this.#n(t.shift())),"*":t=>Number(this.#n(t.shift()))*Number(this.#n(t.shift())),"/":t=>Number(this.#n(t.shift()))/Number(this.#n(t.shift())),"¥":t=>Math.floor(this.#r["/"](t)),"%":t=>Number(this.#n(t.shift()))%Number(this.#n(t.shift())),"+":t=>{const e=this.#n(t.shift()),n=this.#n(t.shift());return"[object String]"===Object.prototype.toString.call(e)||"[object String]"===Object.prototype.toString.call(n)?String(e)+String(n):Number(e)+Number(n)},"-":t=>Number(this.#n(t.shift()))-Number(this.#n(t.shift())),int:t=>(0,s.i)(this.#s(t.shift())),parseInt:t=>(0,s.i)(this.#r.Number(t)),Number:t=>{const e=this.#n(t.shift());return"[object String]"===Object.prototype.toString.call(e)?this.#s(this.#t.parse(String(e)).value):Number(e)},Boolean:t=>{const e=t.shift();return"!bool!"===e[0]?!!e[1]:!!this.#n(e)},ceil:t=>Math.ceil(this.#s(t.shift())),floor:t=>Math.floor(this.#s(t.shift())),round:t=>Math.round(this.#s(t.shift())),isNaN:t=>Number.isNaN(this.#s(t.shift())),"<<":t=>Number(this.#n(t.shift()))<<Number(this.#n(t.shift())),">>":t=>Number(this.#n(t.shift()))>>Number(this.#n(t.shift())),">>>":t=>Number(this.#n(t.shift()))>>>Number(this.#n(t.shift())),"<":t=>Number(this.#n(t.shift()))<Number(this.#n(t.shift())),"<=":t=>Number(this.#n(t.shift()))<=Number(this.#n(t.shift())),">":t=>Number(this.#n(t.shift()))>Number(this.#n(t.shift())),">=":t=>Number(this.#n(t.shift()))>=Number(this.#n(t.shift())),"==":t=>{const e=this.#n(t.shift()),n=this.#n(t.shift());return null!=e||null!=n||e&&n?String(e)===String(n):e==n},"!=":t=>!this.#r["=="](t),"===":t=>{const e=this.#n(t.shift()),n=this.#n(t.shift());return Object.prototype.toString.call(e)==Object.prototype.toString.call(n)&&String(e)===String(n)},"!==":t=>!this.#r["==="](t),"&":t=>Number(this.#n(t.shift()))&Number(this.#n(t.shift())),"^":t=>Number(this.#n(t.shift()))^Number(this.#n(t.shift())),"|":t=>Number(this.#n(t.shift()))|Number(this.#n(t.shift())),"&&":t=>"true"===String(this.#n(t.shift()))&&"true"===String(this.#n(t.shift())),"||":t=>"true"===String(this.#n(t.shift()))||"true"===String(this.#n(t.shift())),"?":t=>{const e=this.#r.Boolean(t),n=t.shift();if(":"!==n[0])throw Error("(PropParser)三項演算子の文法エラーです。: が見つかりません");return this.#n(n[e?1:2])},":":()=>{throw Error("(PropParser)三項演算子の文法エラーです。? が見つかりません")}};#s(t){const e=this.#n(t);if("[object Number]"!==Object.prototype.toString.call(e))throw Error("(PropParser)引数【"+e+"】が数値ではありません");return Number(e)}#i=/(\$((tmp|sys|save|mp):)?[^\s!--\/:-@[-^`{-~]+|\#\{[^\}]+})/g;#e(t){return null==t?t:String(t).replaceAll(this.#i,(t=>t.startsWith("$")?this.val.getVal(t.slice(1)):this.parse(t.slice(2,-1))))}getValAmpersand=t=>t.startsWith("&")?String(this.parse(t.slice(1))):t;static#o=/^((?<scope>\w+?):)?(?<name>[^\s :@]+)(?<at>\@str)?$/;static getValName(t){const e=this.#o.exec(t.trim())?.groups;if(!e)return null;const{scope:n="tmp",name:r,at:s=""}=e;return{scope:n,name:a.#a(r),at:s}}static#a(t){let e=0,n=0;for(;;){if(e=t.indexOf('["'),e<0){if(e=t.indexOf("['"),e<0)break;n=t.indexOf("']",e+2)}else n=t.indexOf('"]',e+2);if(n<0)break;t=t.slice(0,e)+"."+t.slice(e+2,n)+t.slice(n+2),e=n-2}return t}}},8746:(t,e,n)=>{n.r(e),n.d(e,{Variable:()=>a});var r=n(662),s=n(9904),i=n(3653);class o{hAreas=Object.create(null);clear(){this.hAreas={}}search(t){return Object.entries(this.hAreas).some((([e,n])=>t>=parseInt(e)&&t<=n))}record(t){if(!this.search(t)){for(const[e,n]of Object.entries(this.hAreas))if(n+1===t)return void(String(t+1)in this.hAreas?(this.hAreas[e]=this.hAreas[t+1],delete this.hAreas[t+1]):this.hAreas[e]=t);if(String(t+1)in this.hAreas)return this.hAreas[t]=this.hAreas[t+1],void delete this.hAreas[t+1];this.hAreas[t]=t}}erase(t){if(this.search(t)){if(String(t)in this.hAreas)return this.hAreas[t]>t&&(this.hAreas[t+1]=this.hAreas[t]),void delete this.hAreas[t];for(const[e,n]of Object.entries(this.hAreas))if(!(t<parseInt(e)||n<t))return this.hAreas[e]===t||(this.hAreas[t+1]=n),void(this.hAreas[e]=t-1)}}get count(){return Object.keys(this.hAreas).length}toString(){let t="";for(const e of Object.keys(this.hAreas).map((t=>parseInt(t))).sort(((t,e)=>t-e)))t+=e===this.hAreas[e]?","+e:","+e+"~"+this.hAreas[e];return t}}class a{constructor(t,e){if(this.cfg=t,e.let=t=>this.#i(t),e.let_abs=t=>this.#u(t),e.let_char_at=t=>this.#c(t),e.let_index_of=t=>this.#h(t),e.let_length=t=>this.#f(t),e.let_replace=t=>this.#l(t),e.let_round=t=>this.#p(t),e.let_search=t=>this.#g(t),e.let_substr=t=>this.#m(t),e.clearsysvar=()=>this.#d(),e.clearvar=()=>this.#y(),e.dump_val=()=>this.#b(),e.copybookmark=t=>this.#v(t),e.erasebookmark=t=>this.#w(t),this.#e["sn.userFnTail"]="",this.defTmp("const.sn.bookmark.json",(()=>{const t=[];for(const e of Object.keys(this.#t.mark).sort()){const n={...this.#t.mark[e].json};n.place=e,t.push(n)}return JSON.stringify(t)})),this.#n["const.sn.isFirstBoot"]=!0,this.#n["const.sn.last_page_text"]="",this.#n["const.sn.last_page_plain_text"]="",this.#n["const.sn.displayState"]=!1,this.#n["const.Date.getTime"]=()=>(new Date).getTime(),this.#n["const.Date.getDateStr"]=()=>(0,r.g)(),this.#n["const.sn.platform"]=JSON.stringify(r.p),this.#d(!0),this.#y(),this.#n["const.sn.config.window.width"]=t.oCfg.window.width,this.#n["const.sn.config.window.height"]=t.oCfg.window.height,this.#n["const.sn.config.book.title"]=t.oCfg.book.title,this.#n["const.sn.config.book.version"]=t.oCfg.book.version,this.#n["const.sn.Math.PI"]=Math.PI,this.#n["const.sn.isPaging"]=!1,typeof window>"u")return;const n=window,s=n.AudioContext??n.webkitAudioContext;this.#n["const.sn.needClick2Play"]=()=>"suspended"===(new s).state}#a={sys:{},save:{},tmp:{},mp:{}};#e=this.#a.save;#n=this.#a.tmp;#s;#t={sys:{},mark:{},kidoku:{}};#k;#x={};#_;async setSys(t){this.#s=t,await t.initVal(this.#t,this.#n,(e=>{this.updateData(e),sessionStorage.clear();const n=this.cfg.getNs();this.#N=this.cfg.oCfg.debug.variable?()=>{const e={};for(const[t,n]of Object.entries(this.#k))e["sys:"+t]=n instanceof Function?n():n;sessionStorage[n+"sys"]=JSON.stringify(e);const r={};for(const[t,e]of Object.entries(this.#e))r["save:"+t]=e instanceof Function?e():e;sessionStorage[n+"save"]=JSON.stringify(r);const s={};for(const[t,e]of Object.entries(this.#n))s[t]=e instanceof Function?e():e;sessionStorage[n+"tmp"]=JSON.stringify(s);const i={};for(const[t,e]of Object.entries(this.#a.mp))i[t]=e instanceof Function?e():e;sessionStorage[n+"mp"]=JSON.stringify(i);const o={};for(const[t,e]of Object.entries(this.#t.mark))o[t]=e instanceof Function?e():e;sessionStorage[n+"mark"]=JSON.stringify(o);const a={};for(const[t,e]of Object.entries(this.#t.kidoku))a[t]=e instanceof Function?e():e;sessionStorage[n+"kidoku"]=JSON.stringify(a),t.flush()}:()=>t.flush(),this.#_=(e,n)=>t.callHook(e,n),t.addHook(((t,e)=>this.#S[t]?.(t,e)));const r=this.getVal("sys:sn.tagCh.msecWait",-1);(this.#n["const.sn.isFirstBoot"]||-1===r)&&this.#d(!0),this.#E=this.getVal("sys:sn.tagCh.doWait"),this.#o=this.getVal("sys:sn.tagCh.doWait_Kidoku"),this.#O=this.getVal("sys:sn.tagCh.msecWait"),this.#j=this.getVal("sys:sn.tagCh.msecWait_Kidoku"),this.#A()}))}#A(){(0,i.p)(this.getVal("sys:const.sn.aPageLog")??"[]",this.getVal("save:const.sn.styPaging")??i.I)}#S={auth:(t,e)=>this.#P(e.hBreakpoint.aData),var:(t,e)=>this.#s.send2Dbg(e.ri,{v:this.#a[e.scope]??{}}),set_var:(t,e)=>{try{this.#B(e.nm,e.val),this.#s.send2Dbg(e.ri,{})}catch{}},set_data_break:(t,e)=>{this.#P(e.a),this.#s.send2Dbg(e.ri,{})},disconnect:t=>a.#r={}};#P(t){a.#r={};for(const e of t)a.#r[e.dataId]=1}updateData(t){this.#t=t,this.#k=this.#a.sys=this.#t.sys,this.#x={};for(const[t,e]of Object.entries(this.#t.kidoku)){const n=new o;n.hAreas={...e},this.#x[t]=n}}#N=()=>{};flush(){this.#N()}setDoRecProc(t){this.#V=t}#V=t=>{};defTmp(t,e){this.#n[t]=e}cloneMp(){return{...this.#a.mp}}setMp(t){this.#a.mp=t}setMark(t,e){this.#t.mark[t]=e,this.flush()}getMark=t=>{const e=this.#t.mark[t];if(!e)throw`place【${t}】は存在しません`;return e};cloneSave(){return{...this.#a.save}}mark2save(t){this.#e=this.#a.save={...t.hSave},this.#C=this.#e["sn.doRecLog"]??!1}touchAreaKidoku(t){return this.#x[t]??=new o}getAreaKidoku=t=>{const e=this.#x[t];if(!e)throw`hAreaKidoku${t}】は存在しません`;return e};saveKidoku(){for(const[t,{hAreas:e}]of Object.entries(this.#x))this.#t.kidoku[t]={...e};this.flush()}#v(t){if(!("from"in t))throw"fromは必須です";if(!("to"in t))throw"toは必須です";const e=Number(t.from),n=Number(t.to);if(e===n)return!1;const r=this.#t.mark[e];if(!r)throw`from:${e} のセーブデータは存在しません`;return this.setMark(n,{...r}),this.#s.copyBMFolder(e,n),!1}#w(t){const{place:e}=t;if(!e)throw"placeは必須です";return delete this.#t.mark[e],this.flush(),this.#s.eraseBMFolder(e),!1}#i(t){if(!t.name)throw"nameは必須です";let e=!0;if(t.cast)switch(t.cast){case"num":(0,r.b)(t,"text",NaN);break;case"int":t.text=String((0,r.i)((0,r.b)(t,"text",NaN)));break;case"uint":t.text=String((0,r.u)((0,r.b)(t,"text",NaN)));break;case"bool":(0,r.a)(t,"text",!1);break;case"str":e=!1;break;default:throw"cast【"+t.cast+"】は未定義です"}return this.#B(t.name,t.text,e),!1}#u(t){const e=(0,r.b)(t,"text",0);return t.text=String(e<0?-e:e),this.#i(t),!1}#c(t){return t.text=(t.text??"").charAt((0,r.b)(t,"pos",0)),this.#i(t),!1}#h(t){const{val:e}=t;if(!e)throw"valは必須です";const n=(0,r.b)(t,"start",0);return t.text=String((t.text??"").indexOf(e,n)),this.#i(t),!1}#f(t){return t.text=String((t.text??"").length),this.#i(t),!1}#l(t){if(!t.reg)throw"regは必須です";const{flags:e}=t,n=e?new RegExp(t.reg,e):new RegExp(t.reg);return t.text=String(t.text??"").replace(n,String(t.val)),this.#i(t),!1}#p(t){const e=(0,r.b)(t,"text",0);return t.text=String(Math.round(e)),this.#i(t),!1}#g(t){if(!t.reg)throw"regは必須です";const{flags:e}=t,n=e?new RegExp(t.reg,e):new RegExp(t.reg);return t.text=String((t.text??"").search(n)),this.#i(t),!1}#m(t){const e=(0,r.b)(t,"pos",0);return t.text="all"!==t.len?(t.text??"").slice(e,e+(0,r.i)((0,r.b)(t,"len",1))):(t.text??"").slice(e),this.#i(t),!1}#d(t=!1){const e=this.#k=this.#a.sys=this.#t.sys={};typeof process<"u"||(this.setVal_Nochk("sys","const.sn.window.x",0),this.setVal_Nochk("sys","const.sn.window.y",0)),this.setVal_Nochk("sys","sn.tagCh.doWait",!0),this.setVal_Nochk("sys","sn.tagCh.doWait_Kidoku",!0),this.setVal_Nochk("sys","sn.tagCh.msecWait",this.cfg.oCfg.init.tagch_msecwait),this.setVal_Nochk("sys","sn.tagCh.msecWait_Kidoku",this.cfg.oCfg.init.tagch_msecwait),this.setVal_Nochk("sys","sn.tagCh.canskip",!0),this.setVal_Nochk("sys","sn.skip.mode","s"),this.setVal_Nochk("sys","sn.auto.msecPageWait",(0,r.b)(e,"sn.auto.msecPageWait",this.cfg.oCfg.init.auto_msecpagewait??3500)),this.setVal_Nochk("sys","sn.auto.msecPageWait_Kidoku",(0,r.b)(e,"sn.auto.msecPageWait",this.cfg.oCfg.init.auto_msecpagewait??3500)),this.setVal_Nochk("sys","sn.auto.msecLineWait",500),this.setVal_Nochk("sys","sn.auto.msecLineWait_Kidoku",500),this.setVal_Nochk("sys","sn.sound.BGM.vol_mul_talking",1),this.setVal_Nochk("sys","const.sn.sound.BGM.volume",1),this.setVal_Nochk("sys","const.sn.sound.SE.volume",1),this.setVal_Nochk("sys","const.sn.sound.SYS.volume",1);for(const[t,e]of Object.entries(this.#t.kidoku))e.hAreas={},this.#x[t]?.clear();return this.setVal_Nochk("sys","TextLayer.Back.Alpha",.5),this.#a.mark=this.#t.mark={},this.setVal_Nochk("sys","const.sn.save.place",1),this.setVal_Nochk("sys","const.sn.aPageLog","[]"),t||this.#A(),this.flush(),!1}#y(){const t=this.#e["const.sn.mesLayer"]??"",e=this.#e["sn.doRecLog"]??!1,n=this.#e["const.sn.sLog"]??"[]",r=this.#e["const.sn.styPaging"]??i.I;return this.#e=this.#a.save={},this.setVal_Nochk("save","const.sn.mesLayer",t),this.setVal_Nochk("save","sn.doRecLog",e),this.setVal_Nochk("save","const.sn.sLog",n),this.setVal_Nochk("save","const.sn.styPaging",r),!1}#B=(t,e,n=!0)=>{if(!t)throw"[変数に値セット] nameは必須です";if(null==e)throw"[変数に値セット] textは必須です（空文字はOK）";const r=s.PropParser.getValName(t);if(!r)throw"[変数参照] name("+t+")が変数名として異常です";const i=this.#a[r.scope];if(!i)throw"[変数に値セット] scopeが異常【"+r.scope+"】です";const o=r.name;if(o.startsWith("const.")&&o in i)throw"[変数に値セット] 変数【"+o+"】は書き換え不可です";this.setVal_Nochk(r.scope,o,e,n)};setVal_Nochk(t,e,n,r=!1){const s=this.#a[t];r&&(n=this.#L(n));const i=t+":"+e;if(i in a.#r){const t=s[e],r=n;t!=r&&this.#_("data_break",{dataId:i,old_v:t,new_v:r})}s[e]=n,this.#W[i]?.(e,n)}static#r={};getVal=(t,e)=>{if(!t)throw"[変数参照] nameは必須です";const n=s.PropParser.getValName(t);if(!n)throw"[変数参照] name("+t+")が変数名として異常です";const r=this.#a[n.scope];if(!r)throw"[変数参照] scopeが異常【"+n.scope+"】です";const i=n.name;let o=r[i];if(!(i in r)){o=e;let t="";const n=i.split("."),s=n.length;for(let i=0;i<s;++i,t+="."){if(t+=n[i],!(t in r))continue;let a=JSON.parse(r[t]);if("[object Object]"!==Object.prototype.toString.call(a)){if(i+1===s){o=a;break}continue}let u=i;for(;++u<s;){const t=n[u];if(!(t in a)){o=e;break}if(a=a[t],"[object Object]"!==Object.prototype.toString.call(a)||u+1===s){o=a;break}}o instanceof Object&&(o=JSON.stringify(o));break}}return o instanceof Function&&(o=o()),"@str"===n.at?o:this.#L(o)};#L(t){const e=t;return"true"===e||"false"!==e&&("null"===e?null:"undefined"!==e?this.#M.test(e)?parseFloat(e):t:void 0)}#M=/^-?[\d\.]+$/;#b=()=>{const t={tmp:{},sys:{},save:{},mp:{}};for(let e in t){const n=this.#a[e],r=t[e];for(let[t,e]of Object.entries(n))r[t]="[object Function]"===Object.prototype.toString.call(e)?e():e}return console.info("🥟 [dump_val]",t),!1};#C=!1;doRecLog(){return this.#C}#E=!1;get tagCh_doWait(){return this.#E}#o=!1;get tagCh_doWait_Kidoku(){return this.#o}#O=0;get tagCh_msecWait(){return this.#O}#j=0;get tagCh_msecWait_Kidoku(){return this.#j}#W={"sys:sn.tagCh.doWait":t=>{this.#E=this.#F(t)},"sys:sn.tagCh.doWait_Kidoku":t=>{this.#o=this.#F(t)},"sys:sn.tagCh.msecWait":t=>{this.#O=this.#I(t)},"sys:sn.tagCh.msecWait_Kidoku":t=>{this.#j=this.#D(t)},"sys:sn.tagCh.canskip":t=>this.#F(t),"sys:sn.auto.msecPageWait":t=>this.#K(t),"sys:sn.auto.msecPageWait_Kidoku":t=>this.#K(t),"sys:sn.auto.msecLineWait":t=>this.#q(t),"sys:sn.auto.msecLineWait_Kidoku":t=>this.#q(t),"save:sn.doRecLog":t=>{this.#V(this.#C=this.#R(t))},"save:sn.userFnTail":(t,e)=>{if(e.includes("@"))throw"この変数では文字「@」は禁止です";this.cfg.userFnTail=e},"tmp:flash.desktop.NativeApplication.nativeApplication.systemIdleMode":()=>{}};defValTrg(t,e){this.#W[t]=e}#F=t=>(0,r.a)(this.#k,t,!0);#I=t=>(0,r.b)(this.#k,t,10);#D=t=>(0,r.b)(this.#k,t,void 0===this.cfg.oCfg.init.tagch_msecwait?10:this.cfg.oCfg.init.tagch_msecwait);#K=t=>(0,r.b)(this.#k,t,void 0===this.cfg.oCfg.init.auto_msecpagewait?3500:this.cfg.oCfg.init.auto_msecpagewait);#q=t=>(0,r.b)(this.#k,t,500);#R(t){return(0,r.a)(this.#e,t,!0)}}}}]);