"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkgallery"] = self["webpackChunkgallery"] || []).push([["skynovel_dist_SoundMng_js"],{

/***/ "../skynovel/dist/CmnTween.js":
/*!************************************!*\
  !*** ../skynovel/dist/CmnTween.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   C: () => (/* binding */ i)\n/* harmony export */ });\n/* harmony import */ var _web2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./web2.js */ \"../skynovel/dist/web2.js\");\n/* harmony import */ var _ReadState_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ReadState.js */ \"../skynovel/dist/ReadState.js\");\n\n\nclass i {\n  static #t = {};\n  static #i;\n  static #a;\n  static init(t, o) {\n    i.#t = {}, i.#i = t, i.#a = o, i.#a.ticker.add(i.#s);\n  }\n  static #s = () => (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_1__.u)();\n  static destroy() {\n    i.stopAllTw(), i.#a.ticker.remove(i.#s);\n  }\n  static setTwProp(t, o) {\n    const s = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(o, \"repeat\", 1);\n    return t.delay((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(o, \"delay\", 0)).easing(i.ease(o.ease)).repeat(s > 0 ? s - 1 : 1 / 0).yoyo((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(o, \"yoyo\", !1));\n  }\n  static #o = {\n    \"Back.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Back.In(t),\n    \"Back.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Back.InOut(t),\n    \"Back.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Back.Out(t),\n    \"Bounce.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Bounce.In(t),\n    \"Bounce.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Bounce.InOut(t),\n    \"Bounce.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Bounce.Out(t),\n    \"Circular.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Circular.In(t),\n    \"Circular.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Circular.InOut(t),\n    \"Circular.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Circular.Out(t),\n    \"Cubic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Cubic.In(t),\n    \"Cubic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Cubic.InOut(t),\n    \"Cubic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Cubic.Out(t),\n    \"Elastic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Elastic.In(t),\n    \"Elastic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Elastic.InOut(t),\n    \"Elastic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Elastic.Out(t),\n    \"Exponential.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Exponential.In(t),\n    \"Exponential.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Exponential.InOut(t),\n    \"Exponential.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Exponential.Out(t),\n    \"Linear.None\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Linear.None(t),\n    \"Quadratic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quadratic.In(t),\n    \"Quadratic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quadratic.InOut(t),\n    \"Quadratic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quadratic.Out(t),\n    \"Quartic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quartic.In(t),\n    \"Quartic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quartic.InOut(t),\n    \"Quartic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quartic.Out(t),\n    \"Quintic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quintic.In(t),\n    \"Quintic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quintic.InOut(t),\n    \"Quintic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quintic.Out(t),\n    \"Sinusoidal.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Sinusoidal.In(t),\n    \"Sinusoidal.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Sinusoidal.InOut(t),\n    \"Sinusoidal.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Sinusoidal.Out(t)\n  };\n  static ease(t) {\n    if (!t) return (s) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Linear.None(s);\n    const o = i.#o[t];\n    if (!o) throw \"異常なease指定です\";\n    return o;\n  }\n  static hMemberCnt = {\n    alpha: 0,\n    height: 0,\n    rotation: 0,\n    // rotationX〜Z、scaleZ、zは設定すると\n    scale_x: 0,\n    // 三次元方向の拡大縮小ルーチンが働き画像がぼやけるので\n    scale_y: 0,\n    // backlayで設定しない方針\n    pivot_x: 0,\n    pivot_y: 0,\n    width: 0,\n    x: 0,\n    y: 0\n  };\n  static cnvTweenArg(t, o) {\n    const s = {};\n    for (const c of Object.keys(i.hMemberCnt)) {\n      const n = t[c];\n      if (!n) continue;\n      const e = String(n), I = e.startsWith(\"=\"), p = I ? e.slice(1) : e;\n      if (!p) continue;\n      const [O, r] = p.split(\",\"), l = s[c] = parseFloat(O);\n      r && (s[c] += Math.round(\n        Math.random() * (parseFloat(r) - l + 1)\n      )), I && (s[c] += parseFloat(o[c]));\n    }\n    return s;\n  }\n  // トゥイーン全停止\n  static stopAllTw() {\n    i.#t = {}, (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_1__.a)();\n  }\n  static tween(t, o, s, c, n, e, I, p = !0) {\n    const O = this.#i.isSkipping ? 0 : (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(o, \"time\", NaN), r = new _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.T(s).to(c, O).onUpdate(n);\n    i.setTwProp(r, o), i.#t[t] = { tw: r, onEnd: I };\n    const { path: l } = o;\n    let y = r;\n    if (l) {\n      _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.group(`🍝 [${o[\":タグ名\"]}] path=${l}= start(${s.x},${s.y},${s.alpha})`);\n      for (const { groups: u } of l.matchAll(i.#n)) {\n        const { x: E, x2: v, y: x, y2: S, o: $, o2: g, json: d } = u;\n        let f = {};\n        if (d) try {\n          f = JSON.parse(d);\n        } catch (M) {\n          console.error(`🍝 json=${d} ` + M);\n          continue;\n        }\n        else\n          (E ?? v) && (f.x = E ?? v), (x ?? S) && (f.y = x ?? S), ($ ?? g) && (f.alpha = $ ?? g);\n        const B = i.cnvTweenArg(f, s);\n        _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.info(`🍝 ${d ?? `{x:${E} y:${x} o:${$}}`} => hTo:${JSON.stringify(B)}`);\n        const Q = new _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.T(s).to(B, O);\n        i.setTwProp(Q, o), y.chain(Q), y = Q;\n      }\n      _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.groupEnd();\n    }\n    y.onComplete(() => {\n      const u = i.#t[t];\n      u && (delete i.#t[t], u.tw = void 0, r.stop(), i.#i.breakEvent(\"tsy nm:\" + t), u.onEnd?.(), e());\n    });\n    const { chain: h } = o;\n    if (h) {\n      const u = i.#t[h];\n      if (!u?.tw) throw `${h}は存在しない・または終了したトゥイーンです`;\n      delete u.onEnd, u.tw.chain(r);\n    } else p && r.start();\n    return r;\n  }\n  // 11 match 301 step (0.1ms) PCRE2 https://regex101.com/r/reinpq/1\n  // List ${x}${x2}/${y}${y2}/${o}${o2}=${json}\\n\n  /*\n  \\(\\s*\n  (?:\t(?<x>[-=\\d\\.]+)\t|\t(['\"])\t(?<x2>.*?)\t\\2\t)?\n  (?:\n  \t\\s*,\\s*\n  \t(?:\t(?<y>[-=\\d\\.]+)\t|\t(['\"])\t(?<y2>.*?)\t\\5\t)?\n  \t(?:\n  \t\t\\s*,\\s*\n  \t\t(?:\t(?<o>[-=\\d\\.]+)\t|\t(['\"])\t(?<o2>.*?)\t\\8\t)\n  \n  \t)?\n  )?\n  |\n  (?<json>\\{[^{}]*})\n  */\n  static #n = /\\(\\s*(?:(?<x>[-=\\d\\.]+)|(['\"])(?<x2>.*?)\\2)?(?:\\s*,\\s*(?:(?<y>[-=\\d\\.]+)|(['\"])(?<y2>.*?)\\5)?(?:\\s*,\\s*(?:(?<o>[-=\\d\\.]+)|(['\"])(?<o2>.*?)\\8))?)?|(?<json>\\{[^{}]*})/g;\n  // トランス終了待ち\n  static wt(t) {\n    return i.#t[i.TW_INT_TRANS]?.tw ? i.#i.waitEvent(\"tsy nm:\" + i.TW_INT_TRANS, t, () => i.finish_trans()) : !1;\n  }\n  static TW_INT_TRANS = `trans\n`;\n  // 改行でスクリプトから絶対指定できない値に\n  // レイヤのトランジションの停止\n  static finish_trans() {\n    return i.#t[i.TW_INT_TRANS]?.tw?.stop().end(), !1;\n  }\n  // stop()とend()は別\n  // トゥイーン終了待ち\n  static wait_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    const e = i.#t[n];\n    if (!e?.tw) {\n      if ((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"chk_exist_tw\", !1)) throw s ? `フレームトゥイーン ${s} が見つかりません。` : `トゥイーン ${n} が見つかりません。(layer:${o} name:${c})`;\n      return !1;\n    }\n    return i.#i.waitEvent(\"tsy nm:\" + n, t, () => e.tw?.end());\n  }\n  // トゥイーン中断\n  static stop_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    return i.#t[n]?.tw?.stop().end(), !1;\n  }\n  // 一時停止\n  static pause_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    return i.#t[n]?.tw?.pause(), !1;\n  }\n  // 一時停止再開\n  static resume_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    return i.#t[n]?.tw?.resume(), !1;\n  }\n}\n\n//# sourceMappingURL=CmnTween.js.map\n\n\n//# sourceURL=webpack://gallery/../skynovel/dist/CmnTween.js?");

/***/ }),

/***/ "../skynovel/dist/SoundMng.js":
/*!************************************!*\
  !*** ../skynovel/dist/SoundMng.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SoundMng: () => (/* binding */ Rt)\n/* harmony export */ });\n/* harmony import */ var _web2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./web2.js */ \"../skynovel/dist/web2.js\");\n/* harmony import */ var _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CmnTween.js */ \"../skynovel/dist/CmnTween.js\");\n/* harmony import */ var _ReadState_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ReadState.js */ \"../skynovel/dist/ReadState.js\");\n\n\n\n/*!\n * @pixi/sound - v4.4.1\n * https://github.com/pixijs/pixi-sound\n * Compiled Tue, 15 Aug 2023 19:22:13 UTC\n *\n * @pixi/sound is licensed under the MIT license.\n * http://www.opensource.org/licenses/mit-license\n */\nvar rt;\nfunction d() {\n  return rt;\n}\nvar ut = function(n, t) {\n  return (ut = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(e, s) {\n    e.__proto__ = s;\n  } || function(e, s) {\n    for (var o in s) Object.prototype.hasOwnProperty.call(s, o) && (e[o] = s[o]);\n  })(n, t);\n};\nfunction g(n, t) {\n  if (typeof t != \"function\" && t !== null) throw new TypeError(\"Class extends value \" + String(t) + \" is not a constructor or null\");\n  function e() {\n    this.constructor = n;\n  }\n  ut(n, t), n.prototype = t === null ? Object.create(t) : (e.prototype = t.prototype, new e());\n}\nvar V = function() {\n  return (V = Object.assign || function(n) {\n    for (var t, e = 1, s = arguments.length; e < s; e++) for (var o in t = arguments[e]) Object.prototype.hasOwnProperty.call(t, o) && (n[o] = t[o]);\n    return n;\n  }).apply(this, arguments);\n}, Z = [\"mp3\", \"ogg\", \"oga\", \"opus\", \"mpeg\", \"wav\", \"m4a\", \"aiff\", \"wma\", \"mid\", \"caf\"], H = {};\nfunction at(n) {\n  var t = V({ m4a: \"audio/mp4\", oga: \"audio/ogg\", opus: 'audio/ogg; codecs=\"opus\"', caf: 'audio/x-caf; codecs=\"opus\"' }, n || {}), e = document.createElement(\"audio\"), s = {}, o = /^no$/;\n  Z.forEach(function(r) {\n    var i = e.canPlayType(\"audio/\".concat(r)).replace(o, \"\"), u = t[r] ? e.canPlayType(t[r]).replace(o, \"\") : \"\";\n    s[r] = !!i || !!u;\n  }), Object.assign(H, s);\n}\nat();\nvar gt = /\\.(\\{([^\\}]+)\\})(\\?.*)?$/;\nfunction Q(n) {\n  var t = gt, e = typeof n == \"string\" ? n : n.url;\n  if (!t.test(e)) return e;\n  for (var s = t.exec(e), o = s[2].split(\",\"), r = o[o.length - 1], i = 0, u = o.length; i < u; i++) {\n    var a = o[i];\n    if (H[a]) {\n      r = a;\n      break;\n    }\n  }\n  var l = e.replace(s[1], r);\n  if (typeof n != \"string\") {\n    var c = n;\n    c.extension = r, c.url = l;\n  }\n  return l;\n}\nvar X = Z.filter(function(n) {\n  return H[n];\n}), Y = function() {\n  function n() {\n  }\n  return n.add = function() {\n    n.setLegacy(d().useLegacy);\n  }, n.setLegacy = function(t) {\n    t ? X.forEach(function(e) {\n      _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.setExtensionXhrType(e, _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.DEFAULT), _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.setExtensionLoadType(e, _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.LOAD_TYPE.AUDIO);\n    }) : X.forEach(function(e) {\n      _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.setExtensionXhrType(e, _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.BUFFER), _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.setExtensionLoadType(e, _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.LOAD_TYPE.XHR);\n    });\n  }, n.pre = function(t, e) {\n    Q(t), e();\n  }, n.use = function(t, e) {\n    t.data && X.indexOf(t.extension) > -1 ? t.sound = d().add(t.name, { loaded: e, preload: !0, url: t.url, source: t.data }) : e();\n  }, n.extension = \"loader\", n;\n}(), Pt = 0, xt = function(n) {\n  function t(e) {\n    var s = n.call(this) || this;\n    return s.id = Pt++, s.init(e), s;\n  }\n  return g(t, n), t.prototype.set = function(e, s) {\n    if (this[e] === void 0) throw new Error(\"Property with name \".concat(e, \" does not exist.\"));\n    switch (e) {\n      case \"speed\":\n        this.speed = s;\n        break;\n      case \"volume\":\n        this.volume = s;\n        break;\n      case \"paused\":\n        this.paused = s;\n        break;\n      case \"loop\":\n        this.loop = s;\n        break;\n      case \"muted\":\n        this.muted = s;\n    }\n    return this;\n  }, Object.defineProperty(t.prototype, \"progress\", { get: function() {\n    return this._source.currentTime / this._duration;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"paused\", { get: function() {\n    return this._paused;\n  }, set: function(e) {\n    this._paused = e, this.refreshPaused();\n  }, enumerable: !1, configurable: !0 }), t.prototype._onPlay = function() {\n    this._playing = !0;\n  }, t.prototype._onPause = function() {\n    this._playing = !1;\n  }, t.prototype.init = function(e) {\n    this._playing = !1, this._duration = e.source.duration;\n    var s = this._source = e.source.cloneNode(!1);\n    s.src = e.parent.url, s.onplay = this._onPlay.bind(this), s.onpause = this._onPause.bind(this), e.context.on(\"refresh\", this.refresh, this), e.context.on(\"refreshPaused\", this.refreshPaused, this), this._media = e;\n  }, t.prototype._internalStop = function() {\n    this._source && this._playing && (this._source.onended = null, this._source.pause());\n  }, t.prototype.stop = function() {\n    this._internalStop(), this._source && this.emit(\"stop\");\n  }, Object.defineProperty(t.prototype, \"speed\", { get: function() {\n    return this._speed;\n  }, set: function(e) {\n    this._speed = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"volume\", { get: function() {\n    return this._volume;\n  }, set: function(e) {\n    this._volume = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"loop\", { get: function() {\n    return this._loop;\n  }, set: function(e) {\n    this._loop = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"muted\", { get: function() {\n    return this._muted;\n  }, set: function(e) {\n    this._muted = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"filters\", { get: function() {\n    return null;\n  }, set: function(e) {\n  }, enumerable: !1, configurable: !0 }), t.prototype.refresh = function() {\n    var e = this._media.context, s = this._media.parent;\n    this._source.loop = this._loop || s.loop;\n    var o = e.volume * (e.muted ? 0 : 1), r = s.volume * (s.muted ? 0 : 1), i = this._volume * (this._muted ? 0 : 1);\n    this._source.volume = i * o * r, this._source.playbackRate = this._speed * e.speed * s.speed;\n  }, t.prototype.refreshPaused = function() {\n    var e = this._media.context, s = this._media.parent, o = this._paused || s.paused || e.paused;\n    o !== this._pausedReal && (this._pausedReal = o, o ? (this._internalStop(), this.emit(\"paused\")) : (this.emit(\"resumed\"), this.play({ start: this._source.currentTime, end: this._end, volume: this._volume, speed: this._speed, loop: this._loop })), this.emit(\"pause\", o));\n  }, t.prototype.play = function(e) {\n    var s = this, o = e.start, r = e.end, i = e.speed, u = e.loop, a = e.volume, l = e.muted;\n    this._speed = i, this._volume = a, this._loop = !!u, this._muted = l, this.refresh(), this.loop && r !== null && (this.loop = !1), this._start = o, this._end = r || this._duration, this._start = Math.max(0, this._start - t.PADDING), this._end = Math.min(this._end + t.PADDING, this._duration), this._source.onloadedmetadata = function() {\n      s._source && (s._source.currentTime = o, s._source.onloadedmetadata = null, s.emit(\"progress\", o, s._duration), _web2_js__WEBPACK_IMPORTED_MODULE_0__.T.shared.add(s._onUpdate, s));\n    }, this._source.onended = this._onComplete.bind(this), this._source.play(), this.emit(\"start\");\n  }, t.prototype._onUpdate = function() {\n    this.emit(\"progress\", this.progress, this._duration), this._source.currentTime >= this._end && !this._source.loop && this._onComplete();\n  }, t.prototype._onComplete = function() {\n    _web2_js__WEBPACK_IMPORTED_MODULE_0__.T.shared.remove(this._onUpdate, this), this._internalStop(), this.emit(\"progress\", 1, this._duration), this.emit(\"end\", this);\n  }, t.prototype.destroy = function() {\n    _web2_js__WEBPACK_IMPORTED_MODULE_0__.T.shared.remove(this._onUpdate, this), this.removeAllListeners();\n    var e = this._source;\n    e && (e.onended = null, e.onplay = null, e.onpause = null, this._internalStop()), this._source = null, this._speed = 1, this._volume = 1, this._loop = !1, this._end = null, this._start = 0, this._duration = 0, this._playing = !1, this._pausedReal = !1, this._paused = !1, this._muted = !1, this._media && (this._media.context.off(\"refresh\", this.refresh, this), this._media.context.off(\"refreshPaused\", this.refreshPaused, this), this._media = null);\n  }, t.prototype.toString = function() {\n    return \"[HTMLAudioInstance id=\".concat(this.id, \"]\");\n  }, t.PADDING = 0.1, t;\n}(_web2_js__WEBPACK_IMPORTED_MODULE_0__.d), wt = function(n) {\n  function t() {\n    return n !== null && n.apply(this, arguments) || this;\n  }\n  return g(t, n), t.prototype.init = function(e) {\n    this.parent = e, this._source = e.options.source || new Audio(), e.url && (this._source.src = e.url);\n  }, t.prototype.create = function() {\n    return new xt(this);\n  }, Object.defineProperty(t.prototype, \"isPlayable\", { get: function() {\n    return !!this._source && this._source.readyState === 4;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"duration\", { get: function() {\n    return this._source.duration;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"context\", { get: function() {\n    return this.parent.context;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"filters\", { get: function() {\n    return null;\n  }, set: function(e) {\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    this.removeAllListeners(), this.parent = null, this._source && (this._source.src = \"\", this._source.load(), this._source = null);\n  }, Object.defineProperty(t.prototype, \"source\", { get: function() {\n    return this._source;\n  }, enumerable: !1, configurable: !0 }), t.prototype.load = function(e) {\n    var s = this._source, o = this.parent;\n    if (s.readyState !== 4) if (o.url) {\n      s.src = o.url;\n      var r = function() {\n        a(), o.isLoaded = !0;\n        var c = o.autoPlayStart();\n        e && e(null, o, c);\n      }, i = function() {\n        a(), e && e(new Error(\"Sound loading has been aborted\"));\n      }, u = function() {\n        a();\n        var c = \"Failed to load audio element (code: \".concat(s.error.code, \")\");\n        e && e(new Error(c));\n      }, a = function() {\n        s.removeEventListener(\"canplaythrough\", r), s.removeEventListener(\"load\", r), s.removeEventListener(\"abort\", i), s.removeEventListener(\"error\", u);\n      };\n      s.addEventListener(\"canplaythrough\", r, !1), s.addEventListener(\"load\", r, !1), s.addEventListener(\"abort\", i, !1), s.addEventListener(\"error\", u, !1), s.load();\n    } else e(new Error(\"sound.url or sound.source must be set\"));\n    else {\n      o.isLoaded = !0;\n      var l = o.autoPlayStart();\n      e && setTimeout(function() {\n        e(null, o, l);\n      }, 0);\n    }\n  }, t;\n}(_web2_js__WEBPACK_IMPORTED_MODULE_0__.d), Ot = function() {\n  function n(t, e) {\n    this.parent = t, Object.assign(this, e), this.duration = this.end - this.start;\n  }\n  return n.prototype.play = function(t) {\n    return this.parent.play({ complete: t, speed: this.speed || this.parent.speed, end: this.end, start: this.start, loop: this.loop });\n  }, n.prototype.destroy = function() {\n    this.parent = null;\n  }, n;\n}(), P = function() {\n  function n() {\n  }\n  return n.setParamValue = function(t, e) {\n    if (t.setValueAtTime) {\n      var s = d().context;\n      t.setValueAtTime(e, s.audioContext.currentTime);\n    } else t.value = e;\n    return e;\n  }, n;\n}(), Et = 0, Ft = function(n) {\n  function t(e) {\n    var s = n.call(this) || this;\n    return s.id = Et++, s._media = null, s._paused = !1, s._muted = !1, s._elapsed = 0, s.init(e), s;\n  }\n  return g(t, n), t.prototype.set = function(e, s) {\n    if (this[e] === void 0) throw new Error(\"Property with name \".concat(e, \" does not exist.\"));\n    switch (e) {\n      case \"speed\":\n        this.speed = s;\n        break;\n      case \"volume\":\n        this.volume = s;\n        break;\n      case \"muted\":\n        this.muted = s;\n        break;\n      case \"loop\":\n        this.loop = s;\n        break;\n      case \"paused\":\n        this.paused = s;\n    }\n    return this;\n  }, t.prototype.stop = function() {\n    this._source && (this._internalStop(), this.emit(\"stop\"));\n  }, Object.defineProperty(t.prototype, \"speed\", { get: function() {\n    return this._speed;\n  }, set: function(e) {\n    this._speed = e, this.refresh(), this._update(!0);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"volume\", { get: function() {\n    return this._volume;\n  }, set: function(e) {\n    this._volume = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"muted\", { get: function() {\n    return this._muted;\n  }, set: function(e) {\n    this._muted = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"loop\", { get: function() {\n    return this._loop;\n  }, set: function(e) {\n    this._loop = e, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"filters\", { get: function() {\n    return this._filters;\n  }, set: function(e) {\n    var s;\n    this._filters && ((s = this._filters) === null || s === void 0 || s.filter(function(o) {\n      return o;\n    }).forEach(function(o) {\n      return o.disconnect();\n    }), this._filters = null, this._source.connect(this._gain)), this._filters = e?.length ? e.slice(0) : null, this.refresh();\n  }, enumerable: !1, configurable: !0 }), t.prototype.refresh = function() {\n    if (this._source) {\n      var e = this._media.context, s = this._media.parent;\n      this._source.loop = this._loop || s.loop;\n      var o = e.volume * (e.muted ? 0 : 1), r = s.volume * (s.muted ? 0 : 1), i = this._volume * (this._muted ? 0 : 1);\n      P.setParamValue(this._gain.gain, i * r * o), P.setParamValue(this._source.playbackRate, this._speed * s.speed * e.speed), this.applyFilters();\n    }\n  }, t.prototype.applyFilters = function() {\n    var e;\n    if (!((e = this._filters) === null || e === void 0) && e.length) {\n      this._source.disconnect();\n      var s = this._source;\n      this._filters.forEach(function(o) {\n        s.connect(o.destination), s = o;\n      }), s.connect(this._gain);\n    }\n  }, t.prototype.refreshPaused = function() {\n    var e = this._media.context, s = this._media.parent, o = this._paused || s.paused || e.paused;\n    o !== this._pausedReal && (this._pausedReal = o, o ? (this._internalStop(), this.emit(\"paused\")) : (this.emit(\"resumed\"), this.play({ start: this._elapsed % this._duration, end: this._end, speed: this._speed, loop: this._loop, volume: this._volume })), this.emit(\"pause\", o));\n  }, t.prototype.play = function(e) {\n    var s = e.start, o = e.end, r = e.speed, i = e.loop, u = e.volume, a = e.muted, l = e.filters;\n    this._paused = !1;\n    var c = this._media.nodes.cloneBufferSource(), m = c.source, y = c.gain;\n    this._source = m, this._gain = y, this._speed = r, this._volume = u, this._loop = !!i, this._muted = a, this._filters = l, this.refresh();\n    var b = this._source.buffer.duration;\n    this._duration = b, this._end = o, this._lastUpdate = this._now(), this._elapsed = s, this._source.onended = this._onComplete.bind(this), this._loop ? (this._source.loopEnd = o, this._source.loopStart = s, this._source.start(0, s)) : o ? this._source.start(0, s, o - s) : this._source.start(0, s), this.emit(\"start\"), this._update(!0), this.enableTicker(!0);\n  }, t.prototype.enableTicker = function(e) {\n    _web2_js__WEBPACK_IMPORTED_MODULE_0__.T.shared.remove(this._updateListener, this), e && _web2_js__WEBPACK_IMPORTED_MODULE_0__.T.shared.add(this._updateListener, this);\n  }, Object.defineProperty(t.prototype, \"progress\", { get: function() {\n    return this._progress;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"paused\", { get: function() {\n    return this._paused;\n  }, set: function(e) {\n    this._paused = e, this.refreshPaused();\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    var e;\n    this.removeAllListeners(), this._internalStop(), this._gain && (this._gain.disconnect(), this._gain = null), this._media && (this._media.context.events.off(\"refresh\", this.refresh, this), this._media.context.events.off(\"refreshPaused\", this.refreshPaused, this), this._media = null), (e = this._filters) === null || e === void 0 || e.forEach(function(s) {\n      return s.disconnect();\n    }), this._filters = null, this._end = null, this._speed = 1, this._volume = 1, this._loop = !1, this._elapsed = 0, this._duration = 0, this._paused = !1, this._muted = !1, this._pausedReal = !1;\n  }, t.prototype.toString = function() {\n    return \"[WebAudioInstance id=\".concat(this.id, \"]\");\n  }, t.prototype._now = function() {\n    return this._media.context.audioContext.currentTime;\n  }, t.prototype._updateListener = function() {\n    this._update();\n  }, t.prototype._update = function(e) {\n    if (e === void 0 && (e = !1), this._source) {\n      var s = this._now(), o = s - this._lastUpdate;\n      if (o > 0 || e) {\n        var r = this._source.playbackRate.value;\n        this._elapsed += o * r, this._lastUpdate = s;\n        var i = this._duration, u = void 0;\n        if (this._source.loopStart) {\n          var a = this._source.loopEnd - this._source.loopStart;\n          u = (this._source.loopStart + this._elapsed % a) / i;\n        } else u = this._elapsed % i / i;\n        this._progress = u, this.emit(\"progress\", this._progress, i);\n      }\n    }\n  }, t.prototype.init = function(e) {\n    this._media = e, e.context.events.on(\"refresh\", this.refresh, this), e.context.events.on(\"refreshPaused\", this.refreshPaused, this);\n  }, t.prototype._internalStop = function() {\n    if (this._source) {\n      this.enableTicker(!1), this._source.onended = null, this._source.stop(0), this._source.disconnect();\n      try {\n        this._source.buffer = null;\n      } catch {\n      }\n      this._source = null;\n    }\n  }, t.prototype._onComplete = function() {\n    if (this._source) {\n      this.enableTicker(!1), this._source.onended = null, this._source.disconnect();\n      try {\n        this._source.buffer = null;\n      } catch {\n      }\n    }\n    this._source = null, this._progress = 1, this.emit(\"progress\", 1, this._duration), this.emit(\"end\", this);\n  }, t;\n}(_web2_js__WEBPACK_IMPORTED_MODULE_0__.d), lt = function() {\n  function n(t, e) {\n    this._output = e, this._input = t;\n  }\n  return Object.defineProperty(n.prototype, \"destination\", { get: function() {\n    return this._input;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"filters\", { get: function() {\n    return this._filters;\n  }, set: function(t) {\n    var e = this;\n    if (this._filters && (this._filters.forEach(function(o) {\n      o && o.disconnect();\n    }), this._filters = null, this._input.connect(this._output)), t && t.length) {\n      this._filters = t.slice(0), this._input.disconnect();\n      var s = null;\n      t.forEach(function(o) {\n        s === null ? e._input.connect(o.destination) : s.connect(o.destination), s = o;\n      }), s.connect(this._output);\n    }\n  }, enumerable: !1, configurable: !0 }), n.prototype.destroy = function() {\n    this.filters = null, this._input = null, this._output = null;\n  }, n;\n}(), jt = function(n) {\n  function t(e) {\n    var s = this, o = e.audioContext, r = o.createBufferSource(), i = o.createGain(), u = o.createAnalyser();\n    return r.connect(u), u.connect(i), i.connect(e.destination), (s = n.call(this, u, i) || this).context = e, s.bufferSource = r, s.gain = i, s.analyser = u, s;\n  }\n  return g(t, n), Object.defineProperty(t.prototype, \"script\", { get: function() {\n    return this._script || (this._script = this.context.audioContext.createScriptProcessor(t.BUFFER_SIZE), this._script.connect(this.context.destination)), this._script;\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    n.prototype.destroy.call(this), this.bufferSource.disconnect(), this._script && this._script.disconnect(), this.gain.disconnect(), this.analyser.disconnect(), this.bufferSource = null, this._script = null, this.gain = null, this.analyser = null, this.context = null;\n  }, t.prototype.cloneBufferSource = function() {\n    var e = this.bufferSource, s = this.context.audioContext.createBufferSource();\n    s.buffer = e.buffer, P.setParamValue(s.playbackRate, e.playbackRate.value), s.loop = e.loop;\n    var o = this.context.audioContext.createGain();\n    return s.connect(o), o.connect(this.destination), { source: s, gain: o };\n  }, Object.defineProperty(t.prototype, \"bufferSize\", { get: function() {\n    return this.script.bufferSize;\n  }, enumerable: !1, configurable: !0 }), t.BUFFER_SIZE = 0, t;\n}(lt), J = function() {\n  function n() {\n  }\n  return n.prototype.init = function(t) {\n    this.parent = t, this._nodes = new jt(this.context), this._source = this._nodes.bufferSource, this.source = t.options.source;\n  }, n.prototype.destroy = function() {\n    this.parent = null, this._nodes.destroy(), this._nodes = null;\n    try {\n      this._source.buffer = null;\n    } catch {\n    }\n    this._source = null, this.source = null;\n  }, n.prototype.create = function() {\n    return new Ft(this);\n  }, Object.defineProperty(n.prototype, \"context\", { get: function() {\n    return this.parent.context;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"isPlayable\", { get: function() {\n    return !!this._source && !!this._source.buffer;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"filters\", { get: function() {\n    return this._nodes.filters;\n  }, set: function(t) {\n    this._nodes.filters = t;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"duration\", { get: function() {\n    return this._source.buffer.duration;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"buffer\", { get: function() {\n    return this._source.buffer;\n  }, set: function(t) {\n    this._source.buffer = t;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"nodes\", { get: function() {\n    return this._nodes;\n  }, enumerable: !1, configurable: !0 }), n.prototype.load = function(t) {\n    this.source ? this._decode(this.source, t) : this.parent.url ? this._loadUrl(t) : t && t(new Error(\"sound.url or sound.source must be set\"));\n  }, n.prototype._loadUrl = function(t) {\n    var e = this, s = new XMLHttpRequest(), o = this.parent.url;\n    s.open(\"GET\", o, !0), s.responseType = \"arraybuffer\", s.onload = function() {\n      e.source = s.response, e._decode(s.response, t);\n    }, s.send();\n  }, n.prototype._decode = function(t, e) {\n    var s = this, o = function(r, i) {\n      if (r) e && e(r);\n      else {\n        s.parent.isLoaded = !0, s.buffer = i;\n        var u = s.parent.autoPlayStart();\n        e && e(null, s.parent, u);\n      }\n    };\n    t instanceof AudioBuffer ? o(null, t) : this.parent.context.decode(t, o);\n  }, n;\n}(), T = function() {\n  function n(t, e) {\n    this.media = t, this.options = e, this._instances = [], this._sprites = {}, this.media.init(this);\n    var s = e.complete;\n    this._autoPlayOptions = s ? { complete: s } : null, this.isLoaded = !1, this.isPlaying = !1, this.autoPlay = e.autoPlay, this.singleInstance = e.singleInstance, this.preload = e.preload || this.autoPlay, this.url = e.url, this.speed = e.speed, this.volume = e.volume, this.loop = e.loop, e.sprites && this.addSprites(e.sprites), this.preload && this._preload(e.loaded);\n  }\n  return n.from = function(t) {\n    var e = {};\n    return typeof t == \"string\" ? e.url = t : t instanceof ArrayBuffer || t instanceof AudioBuffer || t instanceof HTMLAudioElement ? e.source = t : e = t, (e = V({ autoPlay: !1, singleInstance: !1, url: null, source: null, preload: !1, volume: 1, speed: 1, complete: null, loaded: null, loop: !1 }, e)).url && (e.url = Q(e.url)), Object.freeze(e), new n(d().useLegacy ? new wt() : new J(), e);\n  }, Object.defineProperty(n.prototype, \"context\", { get: function() {\n    return d().context;\n  }, enumerable: !1, configurable: !0 }), n.prototype.pause = function() {\n    return this.isPlaying = !1, this.paused = !0, this;\n  }, n.prototype.resume = function() {\n    return this.isPlaying = this._instances.length > 0, this.paused = !1, this;\n  }, Object.defineProperty(n.prototype, \"paused\", { get: function() {\n    return this._paused;\n  }, set: function(t) {\n    this._paused = t, this.refreshPaused();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"speed\", { get: function() {\n    return this._speed;\n  }, set: function(t) {\n    this._speed = t, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"filters\", { get: function() {\n    return this.media.filters;\n  }, set: function(t) {\n    this.media.filters = t;\n  }, enumerable: !1, configurable: !0 }), n.prototype.addSprites = function(t, e) {\n    if (typeof t == \"object\") {\n      var s = {};\n      for (var o in t) s[o] = this.addSprites(o, t[o]);\n      return s;\n    }\n    var r = new Ot(this, e);\n    return this._sprites[t] = r, r;\n  }, n.prototype.destroy = function() {\n    this._removeInstances(), this.removeSprites(), this.media.destroy(), this.media = null, this._sprites = null, this._instances = null;\n  }, n.prototype.removeSprites = function(t) {\n    if (t) {\n      var e = this._sprites[t];\n      e !== void 0 && (e.destroy(), delete this._sprites[t]);\n    } else for (var s in this._sprites) this.removeSprites(s);\n    return this;\n  }, Object.defineProperty(n.prototype, \"isPlayable\", { get: function() {\n    return this.isLoaded && this.media && this.media.isPlayable;\n  }, enumerable: !1, configurable: !0 }), n.prototype.stop = function() {\n    if (!this.isPlayable) return this.autoPlay = !1, this._autoPlayOptions = null, this;\n    this.isPlaying = !1;\n    for (var t = this._instances.length - 1; t >= 0; t--) this._instances[t].stop();\n    return this;\n  }, n.prototype.play = function(t, e) {\n    var s, o = this;\n    if (typeof t == \"string\" ? s = { sprite: i = t, loop: this.loop, complete: e } : typeof t == \"function\" ? (s = {}).complete = t : s = t, (s = V({ complete: null, loaded: null, sprite: null, end: null, start: 0, volume: 1, speed: 1, muted: !1, loop: !1 }, s || {})).sprite) {\n      var r = s.sprite, i = this._sprites[r];\n      s.start = i.start + (s.start || 0), s.end = i.end, s.speed = i.speed || 1, s.loop = i.loop || s.loop, delete s.sprite;\n    }\n    if (s.offset && (s.start = s.offset), !this.isLoaded) return new Promise(function(a, l) {\n      o.autoPlay = !0, o._autoPlayOptions = s, o._preload(function(c, m, y) {\n        c ? l(c) : (s.loaded && s.loaded(c, m, y), a(y));\n      });\n    });\n    (this.singleInstance || s.singleInstance) && this._removeInstances();\n    var u = this._createInstance();\n    return this._instances.push(u), this.isPlaying = !0, u.once(\"end\", function() {\n      s.complete && s.complete(o), o._onComplete(u);\n    }), u.once(\"stop\", function() {\n      o._onComplete(u);\n    }), u.play(s), u;\n  }, n.prototype.refresh = function() {\n    for (var t = this._instances.length, e = 0; e < t; e++) this._instances[e].refresh();\n  }, n.prototype.refreshPaused = function() {\n    for (var t = this._instances.length, e = 0; e < t; e++) this._instances[e].refreshPaused();\n  }, Object.defineProperty(n.prototype, \"volume\", { get: function() {\n    return this._volume;\n  }, set: function(t) {\n    this._volume = t, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"muted\", { get: function() {\n    return this._muted;\n  }, set: function(t) {\n    this._muted = t, this.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"loop\", { get: function() {\n    return this._loop;\n  }, set: function(t) {\n    this._loop = t, this.refresh();\n  }, enumerable: !1, configurable: !0 }), n.prototype._preload = function(t) {\n    this.media.load(t);\n  }, Object.defineProperty(n.prototype, \"instances\", { get: function() {\n    return this._instances;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"sprites\", { get: function() {\n    return this._sprites;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"duration\", { get: function() {\n    return this.media.duration;\n  }, enumerable: !1, configurable: !0 }), n.prototype.autoPlayStart = function() {\n    var t;\n    return this.autoPlay && (t = this.play(this._autoPlayOptions)), t;\n  }, n.prototype._removeInstances = function() {\n    for (var t = this._instances.length - 1; t >= 0; t--) this._poolInstance(this._instances[t]);\n    this._instances.length = 0;\n  }, n.prototype._onComplete = function(t) {\n    if (this._instances) {\n      var e = this._instances.indexOf(t);\n      e > -1 && this._instances.splice(e, 1), this.isPlaying = this._instances.length > 0;\n    }\n    this._poolInstance(t);\n  }, n.prototype._createInstance = function() {\n    if (n._pool.length > 0) {\n      var t = n._pool.pop();\n      return t.init(this.media), t;\n    }\n    return this.media.create();\n  }, n.prototype._poolInstance = function(t) {\n    t.destroy(), n._pool.indexOf(t) < 0 && n._pool.push(t);\n  }, n._pool = [], n;\n}(), kt = function(n) {\n  function t() {\n    var e = n !== null && n.apply(this, arguments) || this;\n    return e.speed = 1, e.muted = !1, e.volume = 1, e.paused = !1, e;\n  }\n  return g(t, n), t.prototype.refresh = function() {\n    this.emit(\"refresh\");\n  }, t.prototype.refreshPaused = function() {\n    this.emit(\"refreshPaused\");\n  }, Object.defineProperty(t.prototype, \"filters\", { get: function() {\n    return null;\n  }, set: function(e) {\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"audioContext\", { get: function() {\n    return null;\n  }, enumerable: !1, configurable: !0 }), t.prototype.toggleMute = function() {\n    return this.muted = !this.muted, this.refresh(), this.muted;\n  }, t.prototype.togglePause = function() {\n    return this.paused = !this.paused, this.refreshPaused(), this.paused;\n  }, t.prototype.destroy = function() {\n    this.removeAllListeners();\n  }, t;\n}(_web2_js__WEBPACK_IMPORTED_MODULE_0__.d), tt = function(n) {\n  function t() {\n    var e = n.call(this, null, null) || this;\n    e.autoPause = !0;\n    var s = window, o = new t.AudioContext(), r = o.createDynamicsCompressor(), i = o.createAnalyser();\n    return i.connect(r), r.connect(o.destination), e._input = i, e._output = o.destination, e._ctx = o, e._offlineCtx = new t.OfflineAudioContext(1, 2, s.OfflineAudioContext ? Math.max(8e3, Math.min(96e3, o.sampleRate)) : 44100), e.compressor = r, e.analyser = i, e.events = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.d(), e.volume = 1, e.speed = 1, e.muted = !1, e.paused = !1, e._locked = o.state === \"suspended\" && (\"ontouchstart\" in globalThis || \"onclick\" in globalThis), e._locked && (e._unlock(), e._unlock = e._unlock.bind(e), document.addEventListener(\"mousedown\", e._unlock, !0), document.addEventListener(\"touchstart\", e._unlock, !0), document.addEventListener(\"touchend\", e._unlock, !0)), e.onFocus = e.onFocus.bind(e), e.onBlur = e.onBlur.bind(e), globalThis.addEventListener(\"focus\", e.onFocus), globalThis.addEventListener(\"blur\", e.onBlur), e;\n  }\n  return g(t, n), t.prototype.onFocus = function() {\n    if (this.autoPause) {\n      var e = this._ctx.state;\n      e !== \"suspended\" && e !== \"interrupted\" && this._locked || (this.paused = this._pausedOnBlur, this.refreshPaused());\n    }\n  }, t.prototype.onBlur = function() {\n    this.autoPause && (this._locked || (this._pausedOnBlur = this._paused, this.paused = !0, this.refreshPaused()));\n  }, t.prototype._unlock = function() {\n    this._locked && (this.playEmptySound(), this._ctx.state === \"running\" && (document.removeEventListener(\"mousedown\", this._unlock, !0), document.removeEventListener(\"touchend\", this._unlock, !0), document.removeEventListener(\"touchstart\", this._unlock, !0), this._locked = !1));\n  }, t.prototype.playEmptySound = function() {\n    var e = this._ctx.createBufferSource();\n    e.buffer = this._ctx.createBuffer(1, 1, 22050), e.connect(this._ctx.destination), e.start(0, 0, 0), e.context.state === \"suspended\" && e.context.resume();\n  }, Object.defineProperty(t, \"AudioContext\", { get: function() {\n    var e = window;\n    return e.AudioContext || e.webkitAudioContext || null;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t, \"OfflineAudioContext\", { get: function() {\n    var e = window;\n    return e.OfflineAudioContext || e.webkitOfflineAudioContext || null;\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    n.prototype.destroy.call(this);\n    var e = this._ctx;\n    e.close !== void 0 && e.close(), globalThis.removeEventListener(\"focus\", this.onFocus), globalThis.removeEventListener(\"blur\", this.onBlur), this.events.removeAllListeners(), this.analyser.disconnect(), this.compressor.disconnect(), this.analyser = null, this.compressor = null, this.events = null, this._offlineCtx = null, this._ctx = null;\n  }, Object.defineProperty(t.prototype, \"audioContext\", { get: function() {\n    return this._ctx;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"offlineContext\", { get: function() {\n    return this._offlineCtx;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"paused\", { get: function() {\n    return this._paused;\n  }, set: function(e) {\n    e && this._ctx.state === \"running\" ? this._ctx.suspend() : e || this._ctx.state !== \"suspended\" || this._ctx.resume(), this._paused = e;\n  }, enumerable: !1, configurable: !0 }), t.prototype.refresh = function() {\n    this.events.emit(\"refresh\");\n  }, t.prototype.refreshPaused = function() {\n    this.events.emit(\"refreshPaused\");\n  }, t.prototype.toggleMute = function() {\n    return this.muted = !this.muted, this.refresh(), this.muted;\n  }, t.prototype.togglePause = function() {\n    return this.paused = !this.paused, this.refreshPaused(), this._paused;\n  }, t.prototype.decode = function(e, s) {\n    var o = function(i) {\n      s(new Error(i?.message || \"Unable to decode file\"));\n    }, r = this._offlineCtx.decodeAudioData(e, function(i) {\n      s(null, i);\n    }, o);\n    r && r.catch(o);\n  }, t;\n}(lt), St = function() {\n  function n() {\n    this.init();\n  }\n  return n.prototype.init = function() {\n    return this.supported && (this._webAudioContext = new tt()), this._htmlAudioContext = new kt(), this._sounds = {}, this.useLegacy = !this.supported, this;\n  }, Object.defineProperty(n.prototype, \"context\", { get: function() {\n    return this._context;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"filtersAll\", { get: function() {\n    return this.useLegacy ? [] : this._context.filters;\n  }, set: function(t) {\n    this.useLegacy || (this._context.filters = t);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"supported\", { get: function() {\n    return tt.AudioContext !== null;\n  }, enumerable: !1, configurable: !0 }), n.prototype.add = function(t, e) {\n    if (typeof t == \"object\") {\n      var s = {};\n      for (var o in t) {\n        var r = this._getOptions(t[o], e);\n        s[o] = this.add(o, r);\n      }\n      return s;\n    }\n    if (e instanceof T) return this._sounds[t] = e, e;\n    var i = this._getOptions(e), u = T.from(i);\n    return this._sounds[t] = u, u;\n  }, n.prototype._getOptions = function(t, e) {\n    var s;\n    return s = typeof t == \"string\" ? { url: t } : t instanceof ArrayBuffer || t instanceof AudioBuffer || t instanceof HTMLAudioElement ? { source: t } : t, s = V(V({}, s), e || {});\n  }, Object.defineProperty(n.prototype, \"useLegacy\", { get: function() {\n    return this._useLegacy;\n  }, set: function(t) {\n    Y.setLegacy(t), this._useLegacy = t, this._context = !t && this.supported ? this._webAudioContext : this._htmlAudioContext;\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"disableAutoPause\", { get: function() {\n    return !this._webAudioContext.autoPause;\n  }, set: function(t) {\n    this._webAudioContext.autoPause = !t;\n  }, enumerable: !1, configurable: !0 }), n.prototype.remove = function(t) {\n    return this.exists(t, !0), this._sounds[t].destroy(), delete this._sounds[t], this;\n  }, Object.defineProperty(n.prototype, \"volumeAll\", { get: function() {\n    return this._context.volume;\n  }, set: function(t) {\n    this._context.volume = t, this._context.refresh();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(n.prototype, \"speedAll\", { get: function() {\n    return this._context.speed;\n  }, set: function(t) {\n    this._context.speed = t, this._context.refresh();\n  }, enumerable: !1, configurable: !0 }), n.prototype.togglePauseAll = function() {\n    return this._context.togglePause();\n  }, n.prototype.pauseAll = function() {\n    return this._context.paused = !0, this._context.refreshPaused(), this;\n  }, n.prototype.resumeAll = function() {\n    return this._context.paused = !1, this._context.refreshPaused(), this;\n  }, n.prototype.toggleMuteAll = function() {\n    return this._context.toggleMute();\n  }, n.prototype.muteAll = function() {\n    return this._context.muted = !0, this._context.refresh(), this;\n  }, n.prototype.unmuteAll = function() {\n    return this._context.muted = !1, this._context.refresh(), this;\n  }, n.prototype.removeAll = function() {\n    for (var t in this._sounds) this._sounds[t].destroy(), delete this._sounds[t];\n    return this;\n  }, n.prototype.stopAll = function() {\n    for (var t in this._sounds) this._sounds[t].stop();\n    return this;\n  }, n.prototype.exists = function(t, e) {\n    return !!this._sounds[t];\n  }, n.prototype.find = function(t) {\n    return this.exists(t, !0), this._sounds[t];\n  }, n.prototype.play = function(t, e) {\n    return this.find(t).play(e);\n  }, n.prototype.stop = function(t) {\n    return this.find(t).stop();\n  }, n.prototype.pause = function(t) {\n    return this.find(t).pause();\n  }, n.prototype.resume = function(t) {\n    return this.find(t).resume();\n  }, n.prototype.volume = function(t, e) {\n    var s = this.find(t);\n    return e !== void 0 && (s.volume = e), s.volume;\n  }, n.prototype.speed = function(t, e) {\n    var s = this.find(t);\n    return e !== void 0 && (s.speed = e), s.speed;\n  }, n.prototype.duration = function(t) {\n    return this.find(t).duration;\n  }, n.prototype.close = function() {\n    return this.removeAll(), this._sounds = null, this._webAudioContext && (this._webAudioContext.destroy(), this._webAudioContext = null), this._htmlAudioContext && (this._htmlAudioContext.destroy(), this._htmlAudioContext = null), this._context = null, this;\n  }, n;\n}(), j = function() {\n  function n(t, e) {\n    this.init(t, e);\n  }\n  return n.prototype.init = function(t, e) {\n    this.destination = t, this.source = e || t;\n  }, n.prototype.connect = function(t) {\n    this.source.connect(t);\n  }, n.prototype.disconnect = function() {\n    this.source.disconnect();\n  }, n.prototype.destroy = function() {\n    this.disconnect(), this.destination = null, this.source = null;\n  }, n;\n}(), q = { __proto__: null, Filter: j, EqualizerFilter: function(n) {\n  function t(e, s, o, r, i, u, a, l, c, m) {\n    e === void 0 && (e = 0), s === void 0 && (s = 0), o === void 0 && (o = 0), r === void 0 && (r = 0), i === void 0 && (i = 0), u === void 0 && (u = 0), a === void 0 && (a = 0), l === void 0 && (l = 0), c === void 0 && (c = 0), m === void 0 && (m = 0);\n    var y = this;\n    if (!d().useLegacy) {\n      var b = [{ f: t.F32, type: \"lowshelf\", gain: e }, { f: t.F64, type: \"peaking\", gain: s }, { f: t.F125, type: \"peaking\", gain: o }, { f: t.F250, type: \"peaking\", gain: r }, { f: t.F500, type: \"peaking\", gain: i }, { f: t.F1K, type: \"peaking\", gain: u }, { f: t.F2K, type: \"peaking\", gain: a }, { f: t.F4K, type: \"peaking\", gain: l }, { f: t.F8K, type: \"peaking\", gain: c }, { f: t.F16K, type: \"highshelf\", gain: m }].map(function(U) {\n        var p = d().context.audioContext.createBiquadFilter();\n        return p.type = U.type, P.setParamValue(p.Q, 1), p.frequency.value = U.f, P.setParamValue(p.gain, U.gain), p;\n      });\n      (y = n.call(this, b[0], b[b.length - 1]) || this).bands = b, y.bandsMap = {};\n      for (var _ = 0; _ < y.bands.length; _++) {\n        var w = y.bands[_];\n        _ > 0 && y.bands[_ - 1].connect(w), y.bandsMap[w.frequency.value] = w;\n      }\n      return y;\n    }\n    y = n.call(this, null) || this;\n  }\n  return g(t, n), t.prototype.setGain = function(e, s) {\n    if (s === void 0 && (s = 0), !this.bandsMap[e]) throw new Error(\"No band found for frequency \".concat(e));\n    P.setParamValue(this.bandsMap[e].gain, s);\n  }, t.prototype.getGain = function(e) {\n    if (!this.bandsMap[e]) throw new Error(\"No band found for frequency \".concat(e));\n    return this.bandsMap[e].gain.value;\n  }, Object.defineProperty(t.prototype, \"f32\", { get: function() {\n    return this.getGain(t.F32);\n  }, set: function(e) {\n    this.setGain(t.F32, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f64\", { get: function() {\n    return this.getGain(t.F64);\n  }, set: function(e) {\n    this.setGain(t.F64, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f125\", { get: function() {\n    return this.getGain(t.F125);\n  }, set: function(e) {\n    this.setGain(t.F125, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f250\", { get: function() {\n    return this.getGain(t.F250);\n  }, set: function(e) {\n    this.setGain(t.F250, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f500\", { get: function() {\n    return this.getGain(t.F500);\n  }, set: function(e) {\n    this.setGain(t.F500, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f1k\", { get: function() {\n    return this.getGain(t.F1K);\n  }, set: function(e) {\n    this.setGain(t.F1K, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f2k\", { get: function() {\n    return this.getGain(t.F2K);\n  }, set: function(e) {\n    this.setGain(t.F2K, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f4k\", { get: function() {\n    return this.getGain(t.F4K);\n  }, set: function(e) {\n    this.setGain(t.F4K, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f8k\", { get: function() {\n    return this.getGain(t.F8K);\n  }, set: function(e) {\n    this.setGain(t.F8K, e);\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"f16k\", { get: function() {\n    return this.getGain(t.F16K);\n  }, set: function(e) {\n    this.setGain(t.F16K, e);\n  }, enumerable: !1, configurable: !0 }), t.prototype.reset = function() {\n    this.bands.forEach(function(e) {\n      P.setParamValue(e.gain, 0);\n    });\n  }, t.prototype.destroy = function() {\n    this.bands.forEach(function(e) {\n      e.disconnect();\n    }), this.bands = null, this.bandsMap = null;\n  }, t.F32 = 32, t.F64 = 64, t.F125 = 125, t.F250 = 250, t.F500 = 500, t.F1K = 1e3, t.F2K = 2e3, t.F4K = 4e3, t.F8K = 8e3, t.F16K = 16e3, t;\n}(j), DistortionFilter: function(n) {\n  function t(e) {\n    e === void 0 && (e = 0);\n    var s = this;\n    if (!d().useLegacy) {\n      var o = d().context.audioContext.createWaveShaper();\n      return (s = n.call(this, o) || this)._distortion = o, s.amount = e, s;\n    }\n    s = n.call(this, null) || this;\n  }\n  return g(t, n), Object.defineProperty(t.prototype, \"amount\", { get: function() {\n    return this._amount;\n  }, set: function(e) {\n    this._amount = e;\n    for (var s, o = 1e3 * e, r = 44100, i = new Float32Array(r), u = Math.PI / 180, a = 0; a < r; ++a) s = 2 * a / r - 1, i[a] = (3 + o) * s * 20 * u / (Math.PI + o * Math.abs(s));\n    this._distortion.curve = i, this._distortion.oversample = \"4x\";\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    this._distortion = null, n.prototype.destroy.call(this);\n  }, t;\n}(j), StereoFilter: function(n) {\n  function t(e) {\n    e === void 0 && (e = 0);\n    var s = this;\n    if (!d().useLegacy) {\n      var o, r, i, u = d().context.audioContext;\n      return u.createStereoPanner ? i = o = u.createStereoPanner() : ((r = u.createPanner()).panningModel = \"equalpower\", i = r), (s = n.call(this, i) || this)._stereo = o, s._panner = r, s.pan = e, s;\n    }\n    s = n.call(this, null) || this;\n  }\n  return g(t, n), Object.defineProperty(t.prototype, \"pan\", { get: function() {\n    return this._pan;\n  }, set: function(e) {\n    this._pan = e, this._stereo ? P.setParamValue(this._stereo.pan, e) : this._panner.setPosition(e, 0, 1 - Math.abs(e));\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    n.prototype.destroy.call(this), this._stereo = null, this._panner = null;\n  }, t;\n}(j), ReverbFilter: function(n) {\n  function t(e, s, o) {\n    e === void 0 && (e = 3), s === void 0 && (s = 2), o === void 0 && (o = !1);\n    var r = this;\n    if (!d().useLegacy) return (r = n.call(this, null) || this)._seconds = r._clamp(e, 1, 50), r._decay = r._clamp(s, 0, 100), r._reverse = o, r._rebuild(), r;\n    r = n.call(this, null) || this;\n  }\n  return g(t, n), t.prototype._clamp = function(e, s, o) {\n    return Math.min(o, Math.max(s, e));\n  }, Object.defineProperty(t.prototype, \"seconds\", { get: function() {\n    return this._seconds;\n  }, set: function(e) {\n    this._seconds = this._clamp(e, 1, 50), this._rebuild();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"decay\", { get: function() {\n    return this._decay;\n  }, set: function(e) {\n    this._decay = this._clamp(e, 0, 100), this._rebuild();\n  }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, \"reverse\", { get: function() {\n    return this._reverse;\n  }, set: function(e) {\n    this._reverse = e, this._rebuild();\n  }, enumerable: !1, configurable: !0 }), t.prototype._rebuild = function() {\n    for (var e, s = d().context.audioContext, o = s.sampleRate, r = o * this._seconds, i = s.createBuffer(2, r, o), u = i.getChannelData(0), a = i.getChannelData(1), l = 0; l < r; l++) e = this._reverse ? r - l : l, u[l] = (2 * Math.random() - 1) * Math.pow(1 - e / r, this._decay), a[l] = (2 * Math.random() - 1) * Math.pow(1 - e / r, this._decay);\n    var c = d().context.audioContext.createConvolver();\n    c.buffer = i, this.init(c);\n  }, t;\n}(j), MonoFilter: function(n) {\n  function t() {\n    var e = this;\n    if (!d().useLegacy) {\n      var s = d().context.audioContext, o = s.createChannelSplitter(), r = s.createChannelMerger();\n      return r.connect(o), (e = n.call(this, r, o) || this)._merger = r, e;\n    }\n    e = n.call(this, null) || this;\n  }\n  return g(t, n), t.prototype.destroy = function() {\n    this._merger.disconnect(), this._merger = null, n.prototype.destroy.call(this);\n  }, t;\n}(j), StreamFilter: function(n) {\n  function t() {\n    var e = this;\n    if (!d().useLegacy) {\n      var s = d().context.audioContext, o = s.createMediaStreamDestination(), r = s.createMediaStreamSource(o.stream);\n      return (e = n.call(this, o, r) || this)._stream = o.stream, e;\n    }\n    e = n.call(this, null) || this;\n  }\n  return g(t, n), Object.defineProperty(t.prototype, \"stream\", { get: function() {\n    return this._stream;\n  }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function() {\n    this._stream = null, n.prototype.destroy.call(this);\n  }, t;\n}(j), TelephoneFilter: function(n) {\n  function t() {\n    if (!d().useLegacy) {\n      var e = d().context.audioContext, s = e.createBiquadFilter(), o = e.createBiquadFilter(), r = e.createBiquadFilter(), i = e.createBiquadFilter();\n      return s.type = \"lowpass\", P.setParamValue(s.frequency, 2e3), o.type = \"lowpass\", P.setParamValue(o.frequency, 2e3), r.type = \"highpass\", P.setParamValue(r.frequency, 500), i.type = \"highpass\", P.setParamValue(i.frequency, 500), s.connect(o), o.connect(r), r.connect(i), n.call(this, s, i) || this;\n    }\n    n.call(this, null);\n  }\n  return g(t, n), t;\n}(j) }, et = 0, Lt = { __proto__: null, playOnce: function(n, t) {\n  var e = \"alias\".concat(et++);\n  return d().add(e, { url: n, preload: !0, autoPlay: !0, loaded: function(s) {\n    s && (d().remove(e), t && t(s));\n  }, complete: function() {\n    d().remove(e), t && t(null);\n  } }), e;\n}, get PLAY_ID() {\n  return et;\n}, render: function(n, t) {\n  var e = document.createElement(\"canvas\");\n  t = V({ width: 512, height: 128, fill: \"black\" }, t || {}), e.width = t.width, e.height = t.height;\n  var s = _web2_js__WEBPACK_IMPORTED_MODULE_0__.B.from(e);\n  if (!(n.media instanceof J)) return s;\n  var o = n.media, r = e.getContext(\"2d\");\n  r.fillStyle = t.fill;\n  for (var i = o.buffer.getChannelData(0), u = Math.ceil(i.length / t.width), a = t.height / 2, l = 0; l < t.width; l++) {\n    for (var c = 1, m = -1, y = 0; y < u; y++) {\n      var b = i[l * u + y];\n      b < c && (c = b), b > m && (m = b);\n    }\n    r.fillRect(l, (1 + c) * a, 1, Math.max(1, (m - c) * a));\n  }\n  return s;\n}, resolveUrl: Q, sineTone: function(n, t) {\n  n === void 0 && (n = 200), t === void 0 && (t = 1);\n  var e = T.from({ singleInstance: !0 });\n  if (!(e.media instanceof J)) return e;\n  for (var s = e.media, o = e.context.audioContext.createBuffer(1, 48e3 * t, 48e3), r = o.getChannelData(0), i = 0; i < r.length; i++) {\n    var u = n * (i / o.sampleRate) * Math.PI;\n    r[i] = 2 * Math.sin(u);\n  }\n  return s.buffer = o, e.isLoaded = !0, e;\n}, validateFormats: at, supported: H, extensions: Z }, A = function(n) {\n  return rt = n, n;\n}(new St());\n\"extensions\" in _web2_js__WEBPACK_IMPORTED_MODULE_0__.n ? _web2_js__WEBPACK_IMPORTED_MODULE_0__.e.add(Y) : _web2_js__WEBPACK_IMPORTED_MODULE_0__.L.registerPlugin(Y);\nclass S {\n  constructor(t, e, s, o, r, i, u, a) {\n    this.fn = t, this.buf = e, this.start_ms = s, this.end_ms = o, this.ret_ms = r, this.volume = i, this.pan = u, this.stt = a ? new B() : new Ct(), a && this.addSnd(a);\n  }\n  static #t = 1;\n  stt;\n  loop = !1;\n  addSnd(t) {\n    switch (this.loop = t.loop, this.stt.onLoad(this), this.pan !== 0 && (t.filters = [new q.StereoFilter(this.pan)]), this.setVol = (e) => t.volume = e, this.tw = () => new _ReadState_js__WEBPACK_IMPORTED_MODULE_2__.T(t), this.onPlayEnd = () => {\n      this.stt.onPlayEnd(this.buf), this.#s();\n    }, this.stop = () => {\n      t.stop(), this.#s();\n    }, this.destroy = () => t.destroy(), this.buf) {\n      // セリフ再生中はBGM音量を絞る\n      case ot:\n        const e = Number(h.getVal(\"sys:sn.sound.BGM.vol_mul_talking\") ?? 1);\n        if (e === 1) break;\n        S.#t = e;\n        const s = W[F];\n        s && s.setVol(this.volume * S.#t);\n        break;\n      case F:\n        t.volume = this.volume * S.#t;\n        break;\n    }\n  }\n  #s = () => {\n    if (this.#s = () => {\n    }, S.#t === 1 || this.buf !== ot) return;\n    S.#t = 1;\n    const t = W[F];\n    t && t.setVol(this.volume * S.#t);\n  };\n  setVol(t) {\n  }\n  tw() {\n  }\n  onPlayEnd() {\n  }\n  stop() {\n  }\n  destroy() {\n  }\n}\nlet st, h, k, nt, W, G;\nconst F = \"BGM\", v = \"SE\", ot = \"VOICE\";\nclass f {\n  constructor(t, e, s) {\n    this.hArg = t, this.buf = e, this.fn = s;\n    const o = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"start_ms\", 0), r = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"end_ms\", f.#s), i = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"ret_ms\", 0), u = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"pan\", 0), a = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"speed\", 1);\n    if (o < 0) throw `[playse] start_ms:${o} が負の値です`;\n    if (i < 0) throw `[playse] ret_ms:${i} が負の値です`;\n    if (0 < r) {\n      if (r <= o) throw `[playse] start_ms:${o} >= end_ms:${r} は異常値です`;\n      if (r <= i) throw `[playse] ret_ms:${i} >= end_ms:${r} は異常値です`;\n    }\n    const l = \"const.sn.sound.\" + e + \".\";\n    h.setVal_Nochk(\"save\", l + \"fn\", s);\n    const c = f.getVol(t, 1);\n    h.setVal_Nochk(\"save\", l + \"volume\", c);\n    const m = c * Number(h.getVal(\"sys:\" + l + \"volume\", 1)), y = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"loop\", !1);\n    y ? (f.#t[e] = s, h.setVal_Nochk(\"save\", \"const.sn.loopPlaying\", JSON.stringify(f.#t))) : f.delLoopPlay(e), h.setVal_Nochk(\"save\", l + \"start_ms\", o), h.setVal_Nochk(\"save\", l + \"end_ms\", r), h.setVal_Nochk(\"save\", l + \"ret_ms\", i), h.setVal_Nochk(\"tmp\", l + \"playing\", !0), h.flush();\n    const b = A.find(s);\n    this.#e = new S(\n      s,\n      e,\n      o,\n      r,\n      i,\n      m,\n      u,\n      b\n    );\n    const _ = {\n      loop: y,\n      speed: a,\n      volume: m,\n      loaded: (p, x) => {\n        if (!this.#e.stt.isDestroy) {\n          if (p) {\n            k.errScript(`ロード失敗です SndBuf fn:${s} ${p}`, !1);\n            return;\n          }\n          x && (this.#e.addSnd(x), u !== 0 && (x.filters = [new q.StereoFilter(u)]), t.fnc?.());\n        }\n      }\n    };\n    let w = \"\";\n    if (0 < o || r < f.#s) {\n      w = `${s};${o};${r};${i}`;\n      const p = (_.sprites ??= {})[w] = {\n        start: o / 1e3,\n        end: r / 1e3\n      };\n      _.preload = !0;\n      const x = _.loaded;\n      _.loaded = (N, M) => {\n        if (this.#e.stt.isDestroy) return;\n        x(N, M);\n        const K = M, R = K.duration;\n        p.end < 0 && (p.end += R, K.removeSprites(w), K.addSprites(w, p)), p.end <= p.start && k.errScript(`[playse] end_ms:${r}(${p.end * 1e3}) >= start_ms:${o} は異常値です`), p.end * 1e3 <= i && k.errScript(`[playse] end_ms:${r}(${p.end * 1e3}) <= ret_ms:${i} は異常値です`), R <= p.start && k.errScript(`[playse] 音声ファイル再生時間:${R * 1e3} <= start_ms:${o} は異常値です`), r !== f.#s && R <= p.end && k.errScript(`[playse] 音声ファイル再生時間:${R * 1e3} <= end_ms:${r} は異常値です`), K.play(w, (ct) => _.complete?.(ct));\n      };\n    } else _.autoPlay = !0;\n    if (y ? i !== 0 && (_.loop = !1, _.complete = async (p) => {\n      const x = p.duration, N = i / 1e3, M = r / 1e3;\n      x <= N && k.errScript(`[playse] 音声ファイル再生時間:${x * 1e3} <=  ret_ms:${i} は異常値です`), await p.play({\n        // 一周目はループなし、なのでキャッシュされてる\n        ..._,\n        start: N,\n        end: M < 0 ? M + x : M,\n        // 負の値は末尾から\n        //\tspeed,\t\t// 重複\n        loop: !0,\n        //\tvolume,\t\t// 重複\n        //-\tmuted?: boolean;\n        filters: u !== 0 ? [new q.StereoFilter(u)] : []\n        //-\tcomplete?: CompleteCallback;\n        //-\tloaded?: LoadedCallback;\n        //-\tsingleInstance?: boolean;\n      });\n    }) : _.complete = () => {\n      z(this.#e, e), this.#e.onPlayEnd();\n    }, this.#n(), b) {\n      if (b.volume = m, w) this.#o(s, _);\n      else if (b.isPlayable) {\n        const p = b.options.source;\n        !(p instanceof ArrayBuffer) || p.byteLength === 0 ? b.play(_) : this.#e.addSnd(T.from({\n          ..._,\n          url: b.options.url,\n          source: p\n        })), u !== 0 && (b.filters = [new q.StereoFilter(u)]);\n      }\n      this.needLoad = !1;\n      return;\n    }\n    if (this.needLoad = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"join\", !0)) {\n      (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)();\n      const p = _.loaded;\n      _.loaded = (x, N) => {\n        this.#e.stt.isDestroy || p(x, N), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n      };\n    }\n    this.#o(s, _);\n  }\n  static #t = {};\n  static init(t, e, s, o, r) {\n    f.#t = {}, st = t, h = e, k = s, nt = o, W = r;\n  }\n  static setEvtMng(t) {\n    G = t;\n  }\n  static delLoopPlay(t) {\n    delete f.#t[t];\n    const e = \"const.sn.sound.\" + t + \".\";\n    h.setVal_Nochk(\"save\", e + \"fn\", \"\"), h.setVal_Nochk(\"save\", \"const.sn.loopPlaying\", JSON.stringify(f.#t)), h.flush();\n  }\n  static getVol(t, e) {\n    const s = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"volume\", e);\n    return s < 0 ? 0 : s > 1 ? 1 : s;\n  }\n  static xchgbuf({ buf: t = v, buf2: e = v }) {\n    if (t === e) throw `[xchgbuf] buf:${t} が同じ値です`;\n    const s = \"const.sn.sound.\" + t + \".\", o = Number(h.getVal(\"save:\" + s + \"volume\")), r = String(h.getVal(\"save:\" + s + \"fn\")), i = \"const.sn.sound.\" + e + \".\", u = Number(h.getVal(\"save:\" + i + \"volume\")), a = String(h.getVal(\"save:\" + i + \"fn\"));\n    h.setVal_Nochk(\"save\", s + \"volume\", u), h.setVal_Nochk(\"save\", i + \"volume\", o), h.setVal_Nochk(\"save\", s + \"fn\", a), h.setVal_Nochk(\"save\", i + \"fn\", r), t in f.#t != e in f.#t && (t in f.#t ? (delete f.#t[t], f.#t[e] = r) : (delete f.#t[e], f.#t[t] = a), h.setVal_Nochk(\"save\", \"const.sn.loopPlaying\", JSON.stringify(f.#t))), h.flush();\n  }\n  static #s = 999e3;\n  #e;\n  needLoad;\n  #n = () => {\n    A.volumeAll = Number(h.getVal(\"sys:sn.sound.global_volume\", 1)), this.#n = () => {\n    };\n  };\n  #o(t, e) {\n    const s = st.searchPath(t, _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.SOUND);\n    if (!s.endsWith(\".bin\")) {\n      e.url = s, T.from(e);\n      return;\n    }\n    new _web2_js__WEBPACK_IMPORTED_MODULE_0__.L().add({ name: t, url: s, xhrType: _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.BUFFER }).use(async (o, r) => {\n      try {\n        o.data = await nt.decAB(o.data);\n      } catch (i) {\n        k.errScript(`Sound ロード失敗ですc fn:${o.name} ${i}`, !1);\n      }\n      r();\n    }).load((o, r) => {\n      e.source = r[t]?.data, T.from(e);\n    });\n  }\n  setVol(t) {\n    this.#e.setVol(t);\n  }\n  ws = (t) => this.#e.stt.ws(this.#e, t);\n  stopse({ buf: t = v }) {\n    z(this.#e, t), this.#e.stt.stopse(this.#e);\n  }\n  fade = (t) => this.#e.stt.fade(this.#e, t);\n  wf = (t) => this.#e.stt.wf(this.#e, t);\n  stopfadese = (t) => this.#e.stt.stopfadese(this.#e, t);\n}\nfunction z({ loop: n }, t) {\n  if (n) {\n    f.delLoopPlay(t);\n    return;\n  }\n  const e = \"const.sn.sound.\" + t + \".\";\n  h.setVal_Nochk(\"tmp\", e + \"playing\", !1), h.flush();\n}\nfunction $(n) {\n  n.stop().end();\n}\nclass Ct {\n  onLoad(t) {\n    t.stt = new B();\n  }\n  stopse(t) {\n    t.stt = new C(t, !1);\n  }\n  ws = () => !1;\n  onPlayEnd() {\n  }\n  // ok\n  fade() {\n  }\n  // ok\n  wf = () => !1;\n  // ok\n  compFade() {\n  }\n  // ok\n  stopfadese() {\n  }\n  // ok\n  isDestroy = !1;\n}\nclass B {\n  onLoad() {\n  }\n  // ok\n  stopse(t) {\n    t.stt = new C(t);\n  }\n  ws(t, e) {\n    if (t.loop) return !1;\n    const { buf: s = v } = e, o = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(e, \"stop\", !0);\n    return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(e, \"canskip\", !1), G.waitEvent(\"buf:\" + s, e, () => {\n      z(t, s), t.onPlayEnd(), o ? t.stt.stopse(t) : t.stt.onPlayEnd = () => {\n      };\n    }) ? (t.stt = new Vt(), !0) : !1;\n  }\n  onPlayEnd() {\n  }\n  // ok\n  fade(t, e) {\n    const { buf: s = v } = e, r = \"const.sn.sound.\" + s + \".\" + \"volume\", i = f.getVol(e, NaN);\n    h.setVal_Nochk(\"save\", r, i);\n    const u = i * Number(h.getVal(\"sys:\" + r, 1)), a = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(e, \"stop\", i === 0);\n    a && f.delLoopPlay(s), h.flush();\n    const l = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"time\", NaN), c = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"delay\", 0);\n    if (l === 0 && c === 0 || G.isSkipping) {\n      t.setVol(u), t.stt = a ? new C(t) : new B();\n      return;\n    }\n    const m = t.tw();\n    m && (_CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.setTwProp(m, e).to({ volume: u }, l).onComplete(() => {\n      (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.r)(m), t.stt.compFade(s), t.stt = a ? new C(t) : new B();\n    }).start(), t.stt = new Nt(m));\n  }\n  wf = () => !1;\n  // ok\n  compFade() {\n  }\n  // ok\n  stopfadese() {\n  }\n  // ok\n  isDestroy = !1;\n}\nclass Vt {\n  onLoad() {\n  }\n  // ok\n  stopse(t) {\n    t.stt = new C(t);\n  }\n  ws = () => !1;\n  // ok\n  onPlayEnd(t) {\n    G.breakEvent(\"buf:\" + t);\n  }\n  fade() {\n  }\n  // ok\n  wf = () => !1;\n  // ok\n  compFade() {\n  }\n  // ok\n  stopfadese() {\n  }\n  // ok\n  isDestroy = !1;\n}\nclass Nt {\n  constructor(t) {\n    this.tw = t;\n  }\n  onLoad() {\n  }\n  // ok\n  stopse(t) {\n    $(this.tw), t.stt = new C(t);\n  }\n  // 順番厳守\n  ws = () => !1;\n  // ok ?\n  onPlayEnd() {\n  }\n  // ok\n  fade() {\n  }\n  // ok\n  wf(t, e) {\n    const { buf: s = v } = e;\n    return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(e, \"canskip\", !1), G.waitEvent(\"buf:\" + s, e, () => $(this.tw)) ? (t.stt = new Mt(this.tw), !0) : !1;\n  }\n  compFade() {\n  }\n  // ok\n  stopfadese = () => $(this.tw);\n  isDestroy = !1;\n}\nclass Mt {\n  constructor(t) {\n    this.tw = t;\n  }\n  onLoad() {\n  }\n  // ok\n  stopse(t) {\n    $(this.tw), t.stt = new C(t);\n  }\n  ws = () => !1;\n  // ok\n  onPlayEnd() {\n  }\n  // ok\n  fade() {\n  }\n  // ok\n  wf = () => !1;\n  // ok\n  compFade(t) {\n    G.breakEvent(\"buf:\" + t);\n  }\n  stopfadese = () => $(this.tw);\n  isDestroy = !1;\n}\nclass C {\n  constructor(t, e = !0) {\n    this.si = t, this.stop = e, e && (t.stop(), t.loop && (t.destroy(), t.destroy = () => {\n    }));\n  }\n  onLoad() {\n  }\n  // ok\n  stopse() {\n  }\n  // ok\n  ws = () => !1;\n  // ok\n  onPlayEnd() {\n  }\n  // ok\n  fade() {\n  }\n  // ok\n  wf = () => !1;\n  // ok\n  compFade() {\n  }\n  // ok\n  stopfadese() {\n  }\n  // ok\n  isDestroy = !0;\n}\nclass Rt {\n  constructor(t, e, s, o, r) {\n    this.val = s, e.volume = (i) => this.#e(i), e.fadebgm = (i) => this.#l(i), e.fadeoutbgm = (i) => this.#o(i), e.fadeoutse = (i) => this.#d(i), e.fadese = (i) => this.#i(i), e.playbgm = (i) => this.#c(i), e.playse = (i) => this.#a(i), e.stop_allse = () => this.#r(), e.stopbgm = (i) => this.#_(i), e.stopse = (i) => this.#u(i), e.wb = (i) => this.#y(i), e.wf = (i) => this.#h(i), e.stopfadese = (i) => this.#p(i), e.wl = (i) => this.#m(i), e.ws = (i) => this.#f(i), e.xchgbuf = (i) => this.#b(i), s.setVal_Nochk(\"save\", \"const.sn.loopPlaying\", \"{}\"), s.setVal_Nochk(\"tmp\", \"const.sn.sound.codecs\", JSON.stringify(Lt.supported)), f.init(t, s, o, r, this.#t), A.disableAutoPause = !0;\n  }\n  #t = {};\n  #s;\n  setEvtMng(t) {\n    this.#s = t, f.setEvtMng(t);\n  }\n  setNoticeChgVolume(t, e) {\n    this.val.defValTrg(\"sys:sn.sound.global_volume\", (s, o) => t(A.volumeAll = Number(o))), this.val.defValTrg(\"sys:sn.sound.movie_volume\", (s, o) => e(Number(o))), this.val.setVal_Nochk(\"sys\", \"sn.sound.global_volume\", this.val.getVal(\"sys:sn.sound.global_volume\", 1)), this.val.setVal_Nochk(\"sys\", \"sn.sound.movie_volume\", this.val.getVal(\"sys:sn.sound.movie_volume\", 1));\n  }\n  //MARK: 音量設定（独自拡張）\n  #e(t) {\n    const { buf: e = v } = t, s = \"const.sn.sound.\" + e + \".volume\", o = this.#n(t, 1);\n    return Number(this.val.getVal(\"sys:\" + s)) === o ? !1 : (this.val.setVal_Nochk(\"sys\", s, o), this.val.flush(), t.time = 0, t.volume = Number(this.val.getVal(\"save:\" + s)), this.#i(t));\n  }\n  #n(t, e) {\n    const s = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"volume\", e);\n    return s < 0 ? 0 : s > 1 ? 1 : s;\n  }\n  //MARK: BGM/効果音のフェードアウト（loadから使うのでマクロ化禁止）\n  #o(t) {\n    return t.volume = 0, this.#l(t);\n  }\n  //MARK: 効果音のフェードアウト（loadから使うのでマクロ化禁止）\n  #d(t) {\n    return t.volume = 0, this.#i(t);\n  }\n  //MARK: BGMのフェード（loadから使うのでマクロ化禁止）\n  #l(t) {\n    return t.buf = F, this.#i(t);\n  }\n  //MARK: 効果音のフェード\n  #i(t) {\n    const { buf: e = v } = t;\n    return this.#p(t), this.#t[e]?.fade(t), !1;\n  }\n  //MARK: BGM の演奏\n  #c(t) {\n    return t.buf = F, t.canskip = !1, (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"loop\", !0), this.#a(t);\n  }\n  //MARK: 効果音の再生\n  #a(t) {\n    const { buf: e = v, fn: s } = t;\n    if (this.#u({ buf: e }), !s) throw `fnは必須です buf:${e}`;\n    return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"canskip\", !0) && this.#s.isSkipping ? !1 : (this.#t[e] = new f(t, e, s)).needLoad;\n  }\n  clearCache() {\n    A.removeAll();\n  }\n  //MARK: 全効果音再生の停止\n  #r() {\n    for (const t of Object.keys(this.#t)) this.#u({ buf: t });\n    return this.#t = {}, A.stopAll(), !1;\n  }\n  //MARK: BGM 演奏の停止（loadから使うのでマクロ化禁止）\n  #_(t) {\n    return t.buf = F, this.#u(t);\n  }\n  //MARK: 効果音再生の停止\n  #u(t) {\n    const { buf: e = v } = t;\n    return this.#t[e]?.stopse(t), !1;\n  }\n  //MARK: BGM フェードの終了待ち\n  #y(t) {\n    return t.buf = F, this.#h(t);\n  }\n  //MARK: 効果音フェードの終了待ち\n  #h(t) {\n    const { buf: e = v } = t;\n    return this.#t[e]?.wf(t);\n  }\n  //MARK: 音声フェードの停止\n  #p(t) {\n    const { buf: e = v } = t;\n    return this.#t[e]?.stopfadese(t), !1;\n  }\n  //MARK: BGM 再生の終了待ち\n  #m(t) {\n    return t.buf = F, this.#f(t);\n  }\n  //MARK: 効果音再生の終了待ち\n  #f(t) {\n    const { buf: e = v } = t;\n    return this.#t[e]?.ws(t);\n  }\n  //MARK: 再生トラックの交換\n  #b(t) {\n    const { buf: e = v, buf2: s = v } = t;\n    if (e === s) return !1;\n    const o = this.#t[e], r = this.#t[s];\n    return o ? this.#t[s] = o : delete this.#t[s], r ? this.#t[e] = r : delete this.#t[e], f.xchgbuf(t), !1;\n  }\n  //MARK: しおりの読込（BGM状態復元）\n  playLoopFromSaveObj(t) {\n    const e = String(this.val.getVal(\"save:const.sn.loopPlaying\", \"{}\"));\n    if (e === \"{}\")\n      return this.#r(), this.clearCache(), [];\n    const s = JSON.parse(e);\n    if (t)\n      this.#r(), this.clearCache();\n    else for (const [o, r] of Object.entries(this.#t))\n      o in s || r?.stopse({ buf: o });\n    return Object.entries(s).map(([o, r]) => new Promise((i) => {\n      const u = this.#t[o];\n      if (!t && u && u.fn === r) {\n        i();\n        return;\n      }\n      const a = \"save:const.sn.sound.\" + o + \".\", l = {\n        fn: r,\n        buf: o,\n        join: !1,\n        loop: !0,\n        volume: Number(this.val.getVal(a + \"volume\")),\n        start_ms: Number(this.val.getVal(a + \"start_ms\")),\n        end_ms: Number(this.val.getVal(a + \"end_ms\")),\n        ret_ms: Number(this.val.getVal(a + \"ret_ms\")),\n        fnc: i\n        // loaded\n      };\n      l.buf === F ? this.#c(l) : this.#a(l);\n    }));\n  }\n  destroy() {\n    this.#r(), this.clearCache();\n  }\n}\n\n//# sourceMappingURL=SoundMng.js.map\n\n\n//# sourceURL=webpack://gallery/../skynovel/dist/SoundMng.js?");

/***/ })

}]);