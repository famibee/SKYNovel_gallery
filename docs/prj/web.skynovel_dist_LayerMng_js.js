"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkgallery"] = self["webpackChunkgallery"] || []).push([["skynovel_dist_LayerMng_js"],{

/***/ "../skynovel/dist/CmnTween.js":
/*!************************************!*\
  !*** ../skynovel/dist/CmnTween.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   C: () => (/* binding */ i)\n/* harmony export */ });\n/* harmony import */ var _web2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./web2.js */ \"../skynovel/dist/web2.js\");\n/* harmony import */ var _ReadState_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ReadState.js */ \"../skynovel/dist/ReadState.js\");\n\n\nclass i {\n  static #t = {};\n  static #i;\n  static #a;\n  static init(t, o) {\n    i.#t = {}, i.#i = t, i.#a = o, i.#a.ticker.add(i.#s);\n  }\n  static #s = () => (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_1__.u)();\n  static destroy() {\n    i.stopAllTw(), i.#a.ticker.remove(i.#s);\n  }\n  static setTwProp(t, o) {\n    const s = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(o, \"repeat\", 1);\n    return t.delay((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(o, \"delay\", 0)).easing(i.ease(o.ease)).repeat(s > 0 ? s - 1 : 1 / 0).yoyo((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(o, \"yoyo\", !1));\n  }\n  static #o = {\n    \"Back.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Back.In(t),\n    \"Back.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Back.InOut(t),\n    \"Back.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Back.Out(t),\n    \"Bounce.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Bounce.In(t),\n    \"Bounce.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Bounce.InOut(t),\n    \"Bounce.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Bounce.Out(t),\n    \"Circular.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Circular.In(t),\n    \"Circular.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Circular.InOut(t),\n    \"Circular.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Circular.Out(t),\n    \"Cubic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Cubic.In(t),\n    \"Cubic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Cubic.InOut(t),\n    \"Cubic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Cubic.Out(t),\n    \"Elastic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Elastic.In(t),\n    \"Elastic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Elastic.InOut(t),\n    \"Elastic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Elastic.Out(t),\n    \"Exponential.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Exponential.In(t),\n    \"Exponential.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Exponential.InOut(t),\n    \"Exponential.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Exponential.Out(t),\n    \"Linear.None\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Linear.None(t),\n    \"Quadratic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quadratic.In(t),\n    \"Quadratic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quadratic.InOut(t),\n    \"Quadratic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quadratic.Out(t),\n    \"Quartic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quartic.In(t),\n    \"Quartic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quartic.InOut(t),\n    \"Quartic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quartic.Out(t),\n    \"Quintic.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quintic.In(t),\n    \"Quintic.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quintic.InOut(t),\n    \"Quintic.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Quintic.Out(t),\n    \"Sinusoidal.In\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Sinusoidal.In(t),\n    \"Sinusoidal.InOut\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Sinusoidal.InOut(t),\n    \"Sinusoidal.Out\": (t) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Sinusoidal.Out(t)\n  };\n  static ease(t) {\n    if (!t) return (s) => _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.E.Linear.None(s);\n    const o = i.#o[t];\n    if (!o) throw \"異常なease指定です\";\n    return o;\n  }\n  static hMemberCnt = {\n    alpha: 0,\n    height: 0,\n    rotation: 0,\n    // rotationX〜Z、scaleZ、zは設定すると\n    scale_x: 0,\n    // 三次元方向の拡大縮小ルーチンが働き画像がぼやけるので\n    scale_y: 0,\n    // backlayで設定しない方針\n    pivot_x: 0,\n    pivot_y: 0,\n    width: 0,\n    x: 0,\n    y: 0\n  };\n  static cnvTweenArg(t, o) {\n    const s = {};\n    for (const c of Object.keys(i.hMemberCnt)) {\n      const n = t[c];\n      if (!n) continue;\n      const e = String(n), I = e.startsWith(\"=\"), p = I ? e.slice(1) : e;\n      if (!p) continue;\n      const [O, r] = p.split(\",\"), l = s[c] = parseFloat(O);\n      r && (s[c] += Math.round(\n        Math.random() * (parseFloat(r) - l + 1)\n      )), I && (s[c] += parseFloat(o[c]));\n    }\n    return s;\n  }\n  // トゥイーン全停止\n  static stopAllTw() {\n    i.#t = {}, (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_1__.a)();\n  }\n  static tween(t, o, s, c, n, e, I, p = !0) {\n    const O = this.#i.isSkipping ? 0 : (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(o, \"time\", NaN), r = new _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.T(s).to(c, O).onUpdate(n);\n    i.setTwProp(r, o), i.#t[t] = { tw: r, onEnd: I };\n    const { path: l } = o;\n    let y = r;\n    if (l) {\n      _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.group(`🍝 [${o[\":タグ名\"]}] path=${l}= start(${s.x},${s.y},${s.alpha})`);\n      for (const { groups: u } of l.matchAll(i.#n)) {\n        const { x: E, x2: v, y: x, y2: S, o: $, o2: g, json: d } = u;\n        let f = {};\n        if (d) try {\n          f = JSON.parse(d);\n        } catch (M) {\n          console.error(`🍝 json=${d} ` + M);\n          continue;\n        }\n        else\n          (E ?? v) && (f.x = E ?? v), (x ?? S) && (f.y = x ?? S), ($ ?? g) && (f.alpha = $ ?? g);\n        const B = i.cnvTweenArg(f, s);\n        _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.info(`🍝 ${d ?? `{x:${E} y:${x} o:${$}}`} => hTo:${JSON.stringify(B)}`);\n        const Q = new _ReadState_js__WEBPACK_IMPORTED_MODULE_1__.T(s).to(B, O);\n        i.setTwProp(Q, o), y.chain(Q), y = Q;\n      }\n      _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.groupEnd();\n    }\n    y.onComplete(() => {\n      const u = i.#t[t];\n      u && (delete i.#t[t], u.tw = void 0, r.stop(), i.#i.breakEvent(\"tsy nm:\" + t), u.onEnd?.(), e());\n    });\n    const { chain: h } = o;\n    if (h) {\n      const u = i.#t[h];\n      if (!u?.tw) throw `${h}は存在しない・または終了したトゥイーンです`;\n      delete u.onEnd, u.tw.chain(r);\n    } else p && r.start();\n    return r;\n  }\n  // 11 match 301 step (0.1ms) PCRE2 https://regex101.com/r/reinpq/1\n  // List ${x}${x2}/${y}${y2}/${o}${o2}=${json}\\n\n  /*\n  \\(\\s*\n  (?:\t(?<x>[-=\\d\\.]+)\t|\t(['\"])\t(?<x2>.*?)\t\\2\t)?\n  (?:\n  \t\\s*,\\s*\n  \t(?:\t(?<y>[-=\\d\\.]+)\t|\t(['\"])\t(?<y2>.*?)\t\\5\t)?\n  \t(?:\n  \t\t\\s*,\\s*\n  \t\t(?:\t(?<o>[-=\\d\\.]+)\t|\t(['\"])\t(?<o2>.*?)\t\\8\t)\n  \n  \t)?\n  )?\n  |\n  (?<json>\\{[^{}]*})\n  */\n  static #n = /\\(\\s*(?:(?<x>[-=\\d\\.]+)|(['\"])(?<x2>.*?)\\2)?(?:\\s*,\\s*(?:(?<y>[-=\\d\\.]+)|(['\"])(?<y2>.*?)\\5)?(?:\\s*,\\s*(?:(?<o>[-=\\d\\.]+)|(['\"])(?<o2>.*?)\\8))?)?|(?<json>\\{[^{}]*})/g;\n  // トランス終了待ち\n  static wt(t) {\n    return i.#t[i.TW_INT_TRANS]?.tw ? i.#i.waitEvent(\"tsy nm:\" + i.TW_INT_TRANS, t, () => i.finish_trans()) : !1;\n  }\n  static TW_INT_TRANS = `trans\n`;\n  // 改行でスクリプトから絶対指定できない値に\n  // レイヤのトランジションの停止\n  static finish_trans() {\n    return i.#t[i.TW_INT_TRANS]?.tw?.stop().end(), !1;\n  }\n  // stop()とend()は別\n  // トゥイーン終了待ち\n  static wait_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    const e = i.#t[n];\n    if (!e?.tw) {\n      if ((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"chk_exist_tw\", !1)) throw s ? `フレームトゥイーン ${s} が見つかりません。` : `トゥイーン ${n} が見つかりません。(layer:${o} name:${c})`;\n      return !1;\n    }\n    return i.#i.waitEvent(\"tsy nm:\" + n, t, () => e.tw?.end());\n  }\n  // トゥイーン中断\n  static stop_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    return i.#t[n]?.tw?.stop().end(), !1;\n  }\n  // 一時停止\n  static pause_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    return i.#t[n]?.tw?.pause(), !1;\n  }\n  // 一時停止再開\n  static resume_tsy(t) {\n    const { layer: o = \"\", id: s, name: c } = t, n = s ? `frm\n${s}` : c ?? o;\n    if (!n) throw \"トゥイーンが指定されていません\";\n    return i.#t[n]?.tw?.resume(), !1;\n  }\n}\n\n//# sourceMappingURL=CmnTween.js.map\n\n\n//# sourceURL=webpack://gallery/../skynovel/dist/CmnTween.js?");

/***/ }),

/***/ "../skynovel/dist/LayerMng.js":
/*!************************************!*\
  !*** ../skynovel/dist/LayerMng.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   B: () => (/* binding */ D),\n/* harmony export */   L: () => (/* binding */ Yt),\n/* harmony export */   T: () => (/* binding */ x)\n/* harmony export */ });\n/* harmony import */ var _web2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./web2.js */ \"../skynovel/dist/web2.js\");\n/* harmony import */ var _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CmnTween.js */ \"../skynovel/dist/CmnTween.js\");\n/* harmony import */ var _ReadState_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ReadState.js */ \"../skynovel/dist/ReadState.js\");\n/* harmony import */ var _RubySpliter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./RubySpliter.js */ \"../skynovel/dist/RubySpliter.js\");\n\n\n\n\nclass Q {\n  constructor(t, e, s, i, n, o, a, l) {\n    this.cls = e, this.hArg = n, this.sys = o, this.val = a, this.ret = l;\n    const c = o.hFactoryCls[e];\n    if (!c) throw `属性 class【${e}】が不正です`;\n    const u = c(), h = c();\n    u.layname = h.layname = t;\n    const m = n[\":id_tag\"] = `layer:${t} cls:${e} page:`;\n    u.ctn.name = u.name = m + \"A\", h.ctn.name = h.name = m + \"B\", s.addChild(u.ctn), i.addChild(h.ctn), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(n, \"visible\", !0), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(n, \"visible\", !0), l.isWait = u.lay(n) || h.lay(n), this.#i = { fore: u, back: h };\n    const f = `const.sn.lay.${t}`;\n    a.setVal_Nochk(\"tmp\", f, !0), a.defTmp(f + \".fore.alpha\", () => this.#i.fore.alpha), a.defTmp(f + \".back.alpha\", () => this.#i.back.alpha), a.defTmp(f + \".fore.height\", () => this.#i.fore.height), a.defTmp(f + \".back.height\", () => this.#i.back.height), a.defTmp(f + \".fore.visible\", () => this.#i.fore.ctn.visible), a.defTmp(f + \".back.visible\", () => this.#i.back.ctn.visible), a.defTmp(f + \".fore.width\", () => this.#i.fore.width), a.defTmp(f + \".back.width\", () => this.#i.back.width), a.defTmp(f + \".fore.x\", () => this.#i.fore.x), a.defTmp(f + \".back.x\", () => this.#i.back.x), a.defTmp(f + \".fore.y\", () => this.#i.fore.y), a.defTmp(f + \".back.y\", () => this.#i.back.y);\n  }\n  #i;\n  destroy() {\n    this.#i.fore.destroy(), this.#i.back.destroy();\n  }\n  lay = (t) => this.getPage(t).lay(t);\n  getPage = (t) => Q.argChk_page(t, \"fore\") !== \"back\" ? this.#i.fore : this.#i.back;\n  static argChk_page(t, e) {\n    const s = t.page ?? e;\n    if (s === \"fore\" || s === \"back\") return t.page = s;\n    throw Error(\"属性 page【\" + s + \"】が不正です\");\n  }\n  get fore() {\n    return this.#i.fore;\n  }\n  get back() {\n    return this.#i.back;\n  }\n  transPage(t) {\n    [this.#i.back, this.#i.fore] = [this.#i.fore, this.#i.back], this.#i.back.copy(this.#i.fore, t);\n  }\n}\nclass ct {\n  //\tstatic\treadonly\t#alzTagArg\t= new AnalyzeTagArg;\n  constructor(t, e = !1) {\n    this.bg_col = t, this.isLay = e;\n  }\n  static init(t, e, s, i, n, o) {\n  }\n  static cvsResizeDesign() {\n  }\n  destroy() {\n  }\n  gethArg() {\n    return this.hArg;\n  }\n  hArg = {};\n  sethArg(t) {\n    this.hArg = t;\n  }\n  setOther(t) {\n  }\n  adopt(t) {\n  }\n  static enterMode() {\n  }\n  static allHide() {\n  }\n  set visible(t) {\n  }\n  static leaveMode() {\n  }\n  cvsResize() {\n  }\n  make() {\n  }\n  static replaceToken(t) {\n  }\n}\nclass Vt extends ct {\n  constructor(t, e) {\n    super(\"#29e\", !0);\n  }\n  setSp(t) {\n  }\n}\nclass _ {\n  constructor(t = \"\", e, s = () => {\n  }, i = () => {\n  }) {\n    this.csvFn = t, this.ctn = e, this.fncFirstComp = s, this.fncAllComp = i, t && (this.#m = e ? (n) => {\n      e.addChild(n), this.#r.push(n);\n    } : () => {\n    }, this.ret = _.#s(\n      t,\n      (n) => this.fncFirstComp(n),\n      // 差し替え考慮\n      (n) => this.fncAllComp(n),\n      // 差し替え考慮\n      (n) => this.#m(n)\n      // 差し替え考慮\n    ));\n  }\n  static #i;\n  static #e;\n  static #n;\n  static #o;\n  static init(t, e, s, i, n) {\n    _.#i = t, _.#e = e, _.#n = s, _.#o = i, s.arg.crypto && (_.#f = _.#p, _.#l = _.#I);\n    const o = () => {\n      const a = _.#c * _.#t;\n      for (const l of Object.values(_.#x)) l.volume = a;\n    };\n    n.setNoticeChgVolume(\n      (a) => {\n        _.#c = a, o();\n      },\n      (a) => {\n        _.#t = a, o();\n      }\n    );\n  }\n  static #t = 1;\n  static #c = 1;\n  static #d;\n  static setEvtMng(t) {\n    _.#d = t;\n  }\n  ret = !1;\n  #m;\n  #r = [];\n  destroy() {\n    this.fncFirstComp = () => {\n    }, this.fncAllComp = () => {\n    }, this.#m = (t) => t.destroy();\n    for (const t of this.#r)\n      _.stopVideo(t.name), t.parent?.removeChild(t), t.destroy();\n    this.#r = [];\n  }\n  static destroy() {\n    _.#y = {}, _.#h = {}, _.#x = {};\n  }\n  //static #ldrHFn: {[fn: string]: 1} = {};\n  static #s(t, e, s, i) {\n    if (!t) return !1;\n    let n = !1;\n    if (t.startsWith(\"data:\")) {\n      const h = () => {\n        const m = _web2_js__WEBPACK_IMPORTED_MODULE_0__.w.from(t);\n        i(m), e(m), s(n);\n      };\n      return t in _web2_js__WEBPACK_IMPORTED_MODULE_0__.q ? h() : (n = !0, new _web2_js__WEBPACK_IMPORTED_MODULE_0__.L().add(t, t).load(h)), n;\n    }\n    const o = [], a = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.L(), l = t.split(\",\"), c = l.length;\n    for (let h = 0; h < c; ++h) {\n      const m = l[h];\n      if (!m) throw \"face属性に空要素が含まれます\";\n      const { dx: f, dy: r, blendmode: p, fn: d } = _.#y[m] || {\n        fn: m,\n        dx: 0,\n        dy: 0,\n        blendmode: _web2_js__WEBPACK_IMPORTED_MODULE_0__.r.NORMAL\n      }, y = h === 0 ? e : (v) => {\n        v.x = f, v.y = r, v.blendMode = p;\n      };\n      if (o.push({ fn: d, fnc: y }), d in _.#h || d in _web2_js__WEBPACK_IMPORTED_MODULE_0__.q || d in _web2_js__WEBPACK_IMPORTED_MODULE_0__.L.shared.resources) break;\n      n = !0;\n      const b = _.#i.searchPath(d, _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.SP_GSM), C = this.#n.arg.crypto ? { xhrType: b.slice(-5) === \".json\" ? _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.TEXT : _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.BUFFER } : {};\n      a.add({ ...C, name: d, url: b });\n    }\n    const u = (h, m) => {\n      for (const { fn: f, fnc: r } of o) {\n        const p = _.#$(f, m);\n        p.name = f, i(p), r(p);\n      }\n      s(n);\n    };\n    return n ? a.use(async (h, m) => {\n      try {\n        if (h.extension === \"json\") {\n          const r = await this.#n.dec(\"json\", h.data);\n          _.#l(r, h, m);\n          return;\n        }\n        const f = await this.#n.decAB(h.data);\n        _.#f(f, h, m);\n      } catch (f) {\n        const r = `画像/動画ロード失敗です fn:${h.name} ${f}`;\n        _.#d.isSkipping ? console.warn(r) : console.error(\"%c\" + r, \"color:#FF3300;\");\n      }\n    }).load(u) : queueMicrotask(() => u(0, {})), n;\n  }\n  static #y = {};\n  static #h = {};\n  static #f = (t, { type: e, name: s, data: i }, n) => {\n    switch (e) {\n      case _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.VIDEO:\n        const o = i;\n        o.volume = _.#c, _.#x[s] = _.#w(o);\n    }\n    n();\n  };\n  static #u(t) {\n    const e = /([^\\d]+)\\d+\\.(\\w+)/.exec(t[0] ?? \"\");\n    if (!e) return [];\n    const s = e[1].length, i = -e[2].length - 1;\n    return t.sort((n, o) => (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.i)(n.slice(s, i)) > (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.i)(o.slice(s, i)) ? 1 : -1);\n  }\n  static async #p(t, e, s) {\n    e.data = t, e.extension !== \"bin\" && s(), t instanceof HTMLImageElement ? (e.texture = await _web2_js__WEBPACK_IMPORTED_MODULE_0__.s.fromLoader(t, e.url, e.name), e.type = _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.IMAGE) : t instanceof HTMLVideoElement && (t.volume = _.#c, _.#x[e.name] = _.#w(t), e.type = _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.VIDEO), s();\n  }\n  static #w(t) {\n    return _.#e.getVal(\"const.sn.needClick2Play\") && (_web2_js__WEBPACK_IMPORTED_MODULE_0__.D.trace_beforeNew(`[lay系] ${_web2_js__WEBPACK_IMPORTED_MODULE_0__.D.strPos()}未クリック状態で動画を自動再生します。音声はミュートされます`, \"W\"), t.muted = !0), t.setAttribute(\"playsinline\", \"\"), t;\n  }\n  static #l = (t, { type: e, spritesheet: s, name: i, data: n }, o) => {\n    switch (e) {\n      case _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.JSON:\n        const a = s._frameKeys;\n        _.#u(a), _.#h[i] = {\n          aTex: a.map((l) => _web2_js__WEBPACK_IMPORTED_MODULE_0__.s.from(l)),\n          meta: n.meta\n        };\n    }\n    o();\n  };\n  static #I(t, e, s) {\n    const { meta: i, frames: n } = e.data = JSON.parse(t);\n    if (e.type = _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.JSON, !i?.image) {\n      s();\n      return;\n    }\n    const o = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.f)(i.image), a = _.#i.searchPath(o, _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.SP_GSM);\n    new _web2_js__WEBPACK_IMPORTED_MODULE_0__.L().use((l, c) => {\n      this.#n.decAB(l.data).then((u) => {\n        l.data = u, u instanceof HTMLImageElement && (l.type = _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.IMAGE, URL.revokeObjectURL(u.src)), c();\n      }).catch((u) => this.#o.errScript(`画像/動画ロード失敗です dec2res4Cripto fn:${l.name} ${u}`, !1));\n    }).add({ name: o, url: a, xhrType: _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.BUFFER }).load((l, c) => {\n      for (const { data: u } of Object.values(l.resources)) {\n        const { baseTexture: h } = _web2_js__WEBPACK_IMPORTED_MODULE_0__.s.from(u), m = Object.values(n);\n        _.#h[e.name] = {\n          aTex: m.map(({ frame: { x: f, y: r, w: p, h: d } }) => new _web2_js__WEBPACK_IMPORTED_MODULE_0__.s(\n            h,\n            new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(f, r, p, d)\n          )),\n          meta: i\n        };\n      }\n      s();\n    });\n  }\n  static #$(t, e) {\n    const s = _.#h[t];\n    if (s) {\n      const o = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.v(s.aTex);\n      return o.animationSpeed = s.meta.animationSpeed ?? 1, o.play(), o;\n    }\n    if (t in _web2_js__WEBPACK_IMPORTED_MODULE_0__.q) return _web2_js__WEBPACK_IMPORTED_MODULE_0__.w.from(t);\n    const i = _.#x[t];\n    if (i) return _web2_js__WEBPACK_IMPORTED_MODULE_0__.w.from(i);\n    const n = e[t];\n    return n ? new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w(n.texture) : new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w();\n  }\n  static #x = {};\n  static getHFn2VElm(t) {\n    return _.#x[t];\n  }\n  static wv(t) {\n    const { fn: e } = t;\n    if (!e) throw \"fnは必須です\";\n    const s = _.#x[e];\n    if (!s || s.loop) return !1;\n    if (_.#d.isSkipping || s.ended)\n      return _.stopVideo(e), !1;\n    const i = () => _.#d.breakEvent(\"wv fn:\" + e);\n    s.addEventListener(\"ended\", i, { once: !0, passive: !0 });\n    const n = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"stop\", !0);\n    return _.#d.waitEvent(\"wv fn:\" + e, t, () => {\n      s.removeEventListener(\"ended\", i), n && _.stopVideo(e), i();\n    });\n  }\n  static stopVideo(t) {\n    const e = _.#x[t];\n    e && (delete _.#x[t], e.pause(), e.currentTime = e.duration);\n  }\n  static add_face(t) {\n    const { name: e } = t;\n    if (!e) throw \"nameは必須です\";\n    if (e in _.#y) throw \"一つのname（\" + e + \"）に対して同じ画像を複数割り当てられません\";\n    const { fn: s = e } = t;\n    return _.#y[e] = {\n      fn: s,\n      dx: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"dx\", 0),\n      dy: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"dy\", 0),\n      blendmode: _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.getBlendmodeNum(t.blendmode || \"\")\n    }, !1;\n  }\n  //\tstatic\tclearFace2Name(): void {SpritesMng.hFace = {}}\n}\nclass H extends _web2_js__WEBPACK_IMPORTED_MODULE_0__.x {\n  static #i = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.E();\n  static #e;\n  static init(t, e, s, i, n, o) {\n    H.#e = s, _.init(e, o, i, t, n);\n  }\n  static destroy() {\n    H.#i.clear(), _.destroy();\n  }\n  #n = new Vt(this.ctn, this);\n  constructor() {\n    super(), _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isDbg && (this.#o = (t) => this.#n.setSp(t), this.cvsResize = () => {\n      super.cvsResize(), this.#n.cvsResize();\n    });\n  }\n  #o = () => {\n  };\n  #t = \"\";\n  #c = \"\";\n  #d = \"\";\n  lay = (t) => {\n    const e = this.#m(t, (s) => {\n      s && (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n    });\n    return e && (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)(), e;\n  };\n  #m(t, e) {\n    const { fn: s, face: i = \"\" } = t;\n    if (this.#n.sethArg(t), !s)\n      return super.lay(t), this.ctn.children.length > 0 && this.setPos(t), this.#c = \"\", this.#t = this.#d = i, e(!1), !1;\n    const n = \"fn\" in t, o = \"face\" in t;\n    return this.clearLay({ clear_filter: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"clear_filter\", !0) }), n && (this.#c = s), o && (this.#d = i), super.lay(t), t.dx = 0, t.dy = 0, this.#r.destroy(), this.#r = new _(\n      this.#t = s + (i ? \",\" + i : \"\"),\n      this.ctn,\n      (a) => {\n        (\"width\" in t || \"height\" in t) && (a.width = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"width\", 0), a.height = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"height\", 0)), this.#s = a.width, this.#y = a.height, _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.setXY(a, t, this.ctn, !0), _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.setBlendmode(this.ctn, t), this.#o(a);\n      },\n      (a) => e(a)\n    ), this.#r.ret;\n  }\n  #r = new _();\n  #s = 0;\n  #y = 0;\n  get width() {\n    return this.#s;\n  }\n  get height() {\n    return this.#y;\n  }\n  renderStart() {\n    this.#f = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w(this.#h), this.#f.visible = !1, this.ctn.addChildAt(this.#f, 0), this.#f.position.set(-this.ctn.x, -this.ctn.y);\n    let t = () => {\n      const e = this.ctn.alpha;\n      this.ctn.alpha = 1;\n      for (const s of this.ctn.children) s.visible = !0;\n      this.#f.visible = !1, H.#e.renderer.render(this.ctn, { renderTexture: this.#h }), this.ctn.alpha = e;\n      for (const s of this.ctn.children) s.visible = !1;\n    };\n    if (!this.containMovement) {\n      let e = t;\n      t = () => {\n        t = () => {\n        }, e();\n      };\n    }\n    this.#u = () => {\n      t(), this.#f.visible = !0;\n    }, H.#e.ticker.add(this.#u);\n  }\n  #h = _web2_js__WEBPACK_IMPORTED_MODULE_0__.y.create({\n    width: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW,\n    height: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH\n  });\n  #f = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w();\n  #u = () => {\n  };\n  renderEnd() {\n    H.#e.ticker.remove(this.#u), this.ctn.removeChild(this.#f);\n    for (const t of this.ctn.children) t.visible = !0;\n    this.#f.destroy(!0), this.#h = _web2_js__WEBPACK_IMPORTED_MODULE_0__.y.create({\n      width: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW,\n      height: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH\n    });\n  }\n  setPos(t) {\n    _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.setXY(\n      this.ctn.children[0] ?? this.ctn,\n      t,\n      this.ctn,\n      !0\n    );\n  }\n  // アニメ・動画を含むか\n  get containMovement() {\n    if (this.#t === \"\") return !1;\n    const t = this.ctn.children;\n    return this.#t.split(\",\").some(\n      (e, s) => t[s] instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.v || _.getHFn2VElm(e)\n    );\n  }\n  clearLay(t) {\n    super.clearLay(t), this.#r.destroy(), this.#c = \"\", this.#d = \"\", this.#t = \"\";\n  }\n  record = () => ({\n    ...super.record(),\n    sBkFn: this.#c,\n    sBkFace: this.#d\n    //\t\tidc_hArg\t: this.#idc.gethArg(),\n  });\n  playback(t, e) {\n    if (super.playback(t, e), t.sBkFn === \"\" && t.sBkFace === \"\") {\n      this.#c = \"\", this.#d = \"\";\n      return;\n    }\n    e.push(new Promise((s) => this.#m(\n      { fn: t.sBkFn, face: t.sBkFace, left: t.x, top: t.y, alpha: t.alpha, blendmode: _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.getNum2Blendmode(t.blendMode), rotation: t.rotation, scale_x: t.scale_x, scale_y: t.scale_y },\n      (i) => {\n        this.ctn.position.set(t.x, t.y), s();\n      }\n      // Layer.setXY()の後に再度移動\n    )));\n  }\n  makeDesignCast(t) {\n    this.ctn.visible && t(this.#n);\n  }\n  //makeDesignCastChildren(_gdc: IMakeDesignCast) {}\n  cvsResize() {\n    super.cvsResize();\n  }\n  showDesignCast() {\n    this.#n.visible = !0;\n  }\n  //showDesignCastChildren() {}\n  dump = () => super.dump() + `, \"pic\":\"${this.#t}\"`;\n}\nconst Z = \"、。，．）］｝〉」』】〕”〟ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ！？!?‼⁉・ーゝゞヽヾ々\", it = \"［（｛〈「『【〔“〝\", nt = \"─‥…\", rt = Z, xt = new RegExp(`[${Z}]`), jt = new RegExp(`[${it}]`), Dt = new RegExp(`[${nt}]`), Ht = xt;\nclass Wt {\n  #i = Z;\n  #e = it;\n  #n = nt;\n  #o = rt;\n  get 行頭禁則() {\n    return this.#i;\n  }\n  get 行末禁則() {\n    return this.#e;\n  }\n  get 分割禁止() {\n    return this.#n;\n  }\n  get ぶら下げ() {\n    return this.#o;\n  }\n  #t = xt;\n  #c = jt;\n  #d = Dt;\n  #m = Ht;\n  break_fixed = !1;\n  break_fixed_left = 0;\n  break_fixed_top = 0;\n  bura = !1;\n  lay(t) {\n    t.kinsoku_sol && (this.#i = t.kinsoku_sol, this.#t = new RegExp(`[${this.#i}]`)), t.kinsoku_eol && (this.#e = t.kinsoku_eol, this.#r(), this.#c = new RegExp(`[${this.#e}]`)), t.kinsoku_dns && (this.#n = t.kinsoku_dns, this.#s(), this.#d = new RegExp(`[${this.#n}]`)), t.kinsoku_bura && (this.#o = t.kinsoku_bura, this.#r(), this.#s(), this.#m = new RegExp(`[${this.#o}]`)), \"bura\" in t && (this.bura = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"bura\", !1)), this.break_fixed = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"break_fixed\", this.break_fixed), this.break_fixed_left = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"break_fixed_left\", this.break_fixed_left), this.break_fixed_top = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"break_fixed_top\", this.break_fixed_top);\n  }\n  // 禁則の競合（ぶら下げ と 行末禁則 の両方に含まれる文字があってはならない）\n  #r() {\n    const t = this.#e.length, e = this.#o.length;\n    if (t < e)\n      for (let s = 0; s < t; ++s) {\n        const i = this.#e[s];\n        if (this.#o.includes(i)) throw `禁則の競合があります。文字 ${i} がぶら下げ と 行末禁則 の両方に含まれます`;\n      }\n    else\n      for (let s = 0; s < e; ++s) {\n        const i = this.#o[s];\n        if (this.#e.includes(i)) throw `禁則の競合があります。文字 ${i} がぶら下げ と 行末禁則 の両方に含まれます`;\n      }\n  }\n  // 禁則の競合（ぶら下げ と 分割禁止 の両方に含まれる文字があってはならない）\n  #s() {\n    const t = this.#n.length, e = this.#o.length;\n    if (t < e)\n      for (let s = 0; s < t; ++s) {\n        const i = this.#n[s];\n        if (this.#o.includes(i)) throw `禁則の競合があります。文字 ${i} がぶら下げ と 分割禁止 の両方に含まれます`;\n      }\n    else\n      for (let s = 0; s < e; ++s) {\n        const i = this.#o[s];\n        if (this.#n.includes(i)) throw `禁則の競合があります。文字 ${i} がぶら下げ と 分割禁止 の両方に含まれます`;\n      }\n  }\n  reNew(t) {\n    t.#y(this.#i, this.#e, this.#n, this.#o), t.break_fixed = this.break_fixed, t.break_fixed_left = this.break_fixed_left, t.break_fixed_top = this.break_fixed_top, t.bura = this.bura;\n  }\n  #y(t, e, s, i) {\n    this.#i != t && (this.#i = t, this.#t = new RegExp(`[${t}]`)), this.#e != e && (this.#e = e, this.#c = new RegExp(`[${e}]`)), this.#n != s && (this.#n = s, this.#d = new RegExp(`[${s}]`)), this.#o != i && (this.#o = i, this.#m = new RegExp(`[${i}]`));\n  }\n  record() {\n    const t = {\n      break_fixed: this.break_fixed,\n      break_fixed_left: this.break_fixed_left,\n      break_fixed_top: this.break_fixed_top,\n      bura: this.bura\n    };\n    return this.#i === Z && (t.行頭禁則 = this.#i), this.#e === it && (t.行末禁則 = this.#e), this.#n === nt && (t.分割禁止 = this.#n), this.#o === rt && (t.ぶら下げ = this.#o), t;\n  }\n  playback(t) {\n    t && (this.#y(\n      t.行頭禁則 ?? Z,\n      t.行末禁則 ?? it,\n      t.分割禁止 ?? nt,\n      t.ぶら下げ ?? rt\n    ), this.break_fixed = t.break_fixed, this.break_fixed_left = t.break_fixed_left, this.break_fixed_top = t.break_fixed_top, this.bura = t.bura);\n  }\n  hyph(t, e, s, i, n) {\n    let o, a = 0, l = 2, c = (u) => (c = () => !1, i === u ? (i > 0 && (t.innerHTML = n.replaceAll('class=\"sn_ch\"', 'class=\"sn_ch sn_ch_in_default\"')), !0) : u < 2);\n    do {\n      if (o = this.#f(t, e), a = o.length, c(a)) break;\n      let u = -1 / 0;\n      for (; l < a; ++l) {\n        const { elm: h, rect: m, ch: f } = o[l];\n        if (h.tagName === \"RT\") continue;\n        const r = s ? m.y : m.x;\n        if (u <= r || h.previousElementSibling?.tagName === \"SPAN\" && h.previousElementSibling?.innerHTML.includes(\"<br>\") || h.parentElement?.previousElementSibling?.tagName === \"SPAN\" && h.parentElement?.previousElementSibling?.innerHTML.includes(\"<br>\")) {\n          u = r, this.break_fixed || (this.break_fixed_left = m.x, this.break_fixed_top = m.y);\n          continue;\n        }\n        const p = this.#h(o, l), { elm: d, rect: y, ch: b } = o[p];\n        if (!this.break_fixed) {\n          this.break_fixed_left = y.x, this.break_fixed_top = y.y;\n          const P = globalThis.getComputedStyle(d), I = parseFloat(P.fontSize);\n          s ? this.break_fixed_top += I : this.break_fixed_left += I;\n        }\n        u = -1 / 0;\n        const C = l, { cont: v, ins: w } = this.bura ? this.hyph_alg_bura(o, p, b, l) : this.hyph_alg(o, p, b, l, f);\n        if (l = w, v) continue;\n        const N = o[l].elm, S = N.parentElement, T = document.createElement(\"br\");\n        if (S.classList.contains(\"sn_tx\")) S.insertBefore(T, N);\n        else {\n          const P = S.parentElement;\n          P.classList.contains(\"sn_ch\") ? P.parentElement.insertBefore(T, P) : P.insertBefore(T, S);\n        }\n        l += 2, l < C && (l = C), a = -1;\n        break;\n      }\n    } while (a < 0);\n    return [o, a];\n  }\n  // 一つ前の要素を探す（ルビ対応）\n  #h(t, e) {\n    const s = e - 1, { elm: i } = t[s];\n    return i.tagName !== \"RT\" ? s - (i.style.textCombineUpright === \"all\" ? Array.from(i.textContent ?? \"\").length - 1 : 0) : s - Array.from(i.textContent ?? \"\").length;\n  }\n  #f(t, e) {\n    const s = [];\n    if (t.nodeType !== t.TEXT_NODE) return Array.from(t.childNodes).map((a) => this.#f(a, e)).flat();\n    const i = t.ownerDocument.createRange();\n    i.selectNodeContents(t);\n    let n = 0;\n    const o = i.endOffset;\n    for (; n < o; ) {\n      i.setStart(t, n), i.setEnd(t, ++n);\n      const a = i.toString();\n      s.push({\n        ch: a,\n        rect: e(i, a),\n        elm: i.startContainer.parentElement\n      });\n    }\n    return i.detach(), s;\n  }\n  /**\n   * 抽象化した禁則処理アルゴリズム\n   * @method hyph_alg\n   * @param {IChRect[]} a - 文章の抽象化配列\n   * @param {number} p_i - 処理要素の一つ前の添字\n   * @param {string} p_ch - 処理要素の一つ前の文字\n   * @param {number} i - 処理要素の添字\n   * @param {string} ch - 処理要素の文字\n   * @return {Object} result 戻り値\n   * @return {boolean} result.cont - true: 呼び元で改行挿入せず continue\n   * @return {number} result.ins - 手前に改行を挿入すべき要素の添字\n   */\n  hyph_alg(t, e, s, i, n) {\n    if (!this.#c.test(s)) {\n      if (this.#t.test(n))\n        for (; (i = this.#h(t, i)) >= 0 && this.#t.test(t[i].ch); )\n          ;\n      else if (!(s === n && this.#d.test(s))) return { cont: !0, ins: i + 1 };\n    }\n    for (i = e; (i = this.#h(t, i)) >= 0 && this.#c.test(t[i].ch); )\n      ;\n    return { cont: !1, ins: i + 1 };\n  }\n  /**\n   * 抽象化した禁則処理アルゴリズム\n   * @method hyph_alg\n   * @param {IChRect[]} a - 文章の抽象化配列\n   * @param {number} p_i - 処理要素の一つ前の添字\n   * @param {string} p_ch - 処理要素の一つ前の文字\n   * @param {number} i - 処理要素の添字\n   * @return {Object} result 戻り値\n   * @return {boolean} result.cont - true: 呼び元で改行挿入せず continue\n   * @return {number} result.ins - 手前に改行を挿入すべき要素の添字\n   */\n  hyph_alg_bura(t, e, s, i) {\n    const n = this.#h(t, e), { ch: o } = t[n];\n    if (this.#m.test(o) || this.#t.test(o)) {\n      let l = e;\n      (this.#m.test(s) || this.#t.test(s)) && ++l;\n      const c = this.#h(t, l), { ch: u } = t[c], { ch: h } = t[l];\n      if (u === h && this.#d.test(h)) return { cont: !1, ins: c };\n      if (!this.#c.test(u)) return { cont: !1, ins: l };\n      l = c;\n      do\n        if (!this.#c.test(t[l].ch)) break;\n      while ((l = this.#h(t, l)) >= 0);\n      return { cont: !1, ins: l + 1 };\n    }\n    const a = this.#h(t, n);\n    if (i >= 3) {\n      const { ch: l } = t[a];\n      if (this.#d.test(o) && l === o)\n        return { cont: !1, ins: a };\n      if (this.#c.test(l)) {\n        let c = a;\n        for (; (c = this.#h(t, c)) >= 0 && this.#c.test(t[c].ch); )\n          ;\n        return { cont: !1, ins: c + 1 };\n      }\n    }\n    return { cont: !1, ins: n };\n  }\n}\nclass k extends _web2_js__WEBPACK_IMPORTED_MODULE_0__.j {\n  constructor(t, e, s) {\n    super(), this.ctn = t, this.canFocus = e, this.sys = s, this.#t.classList.add(\"sn_tx\"), this.#t.style.position = \"absolute\", k.#e.view.parentElement.appendChild(this.#t), this.addChild(this.#c), this.addChild(this.#d), this.#d.name = \"grpDbgMasume\", this.noticeCompTxt = s.isApp && k.#i.oCfg.debug.dumpHtm ? () => {\n      _ReadState_js__WEBPACK_IMPORTED_MODULE_2__.R.noticeCompTxt();\n      const i = this.#t.innerHTML;\n      if (i === \"\") return;\n      const { fn: n, ln: o } = k.#o.nowScrFnLn(), a = `dumpHtm ${t.name.slice(0, -7).replaceAll(\":\", \"=\")}(fn=${n} line=${o})`;\n      s.outputFile(\n        s.path_downloads + a + \".htm\",\n        `<!doctype html><html><head><meta charset=utf-8><title>${a}</title>\n<h1>${a}</h1>${i.replaceAll(/ class=\"sn_ch\"|animation-delay: \\d+ms; ?| data-add=\"{&quot;ch_in_style&quot;:&quot;default&quot;, &quot;ch_out_style&quot;:&quot;default&quot;}\"/g, \"\").replaceAll(' style=\"\"', \"\").replaceAll(/(<\\/?ruby>)/g, `\n$1\n`).replaceAll(/<(br|\\/span)>/g, `<$1>\n`)}`\n      );\n    } : () => _ReadState_js__WEBPACK_IMPORTED_MODULE_2__.R.noticeCompTxt();\n  }\n  static #i;\n  static #e;\n  static init(t, e) {\n    k.#i = t, k.#e = e;\n  }\n  static #n;\n  static #o;\n  static setEvtMng(t, e) {\n    k.#n = t, k.#o = e;\n  }\n  static destroy() {\n    k.#R = /* @__PURE__ */ Object.create(null), k.#B = /* @__PURE__ */ Object.create(null), k.delBreak();\n  }\n  #t = document.createElement(\"span\");\n  // サンプリング元\n  #c = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.j();\n  // サンプリング先\n  #d = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z();\n  static #m = {\n    \"background-color\": 0,\n    \"border-bottom-width\": 0,\n    \"border-left-width\": 0,\n    \"border-right-width\": 0,\n    \"border-top-width\": 0,\n    \"margin-bottom\": 0,\n    \"margin-left\": 0,\n    \"margin-right\": 0,\n    \"margin-top\": 0\n  };\n  #r = new Wt();\n  noticeCompTxt = () => {\n  };\n  //\treadonly\t#idc\t:TxtLayDesignCast;\n  //\treadonly\t#idcCh\t= new TxtLayPadDesignCast(this);\n  #s = {\n    fontsize: 24,\n    $width: 0,\n    // レイヤサイズであり、背景色（画像）サイズ\n    $height: 0,\n    pad_left: 0,\n    // paddingLeft（レイヤサイズの内側のスペーサー）\n    pad_right: 0,\n    // paddingRight\n    pad_top: 0,\n    // paddingTop\n    pad_bottom: 0\n    // paddingBottom\n  };\n  lay(t) {\n    const e = this.#t.style;\n    if (\"style\" in t)\n      if (t.style) {\n        const s = document.createElement(\"span\");\n        s.style.cssText = t.style;\n        const i = s.style.length;\n        for (let n = 0; n < i; ++n) {\n          const o = s.style[n];\n          if (o in k.#m) {\n            _web2_js__WEBPACK_IMPORTED_MODULE_0__.D.myTrace(`${o}は指定できません`, \"W\");\n            continue;\n          }\n          e[o] = s.style[o];\n        }\n        !s.style.opacity && \"alpha\" in t && (e.opacity = String(this.ctn.alpha));\n      } else this.#t.style.cssText = \"\";\n    else \"alpha\" in t && (e.opacity = String(this.ctn.alpha));\n    if (\"width\" in t && (e.width = (t.width ?? \"0\") + \"px\"), \"height\" in t && (e.height = (t.height ?? \"0\") + \"px\"), \"pl\" in t && (e.paddingLeft = (t.pl ?? \"0\") + \"px\"), \"pr\" in t && (e.paddingRight = (t.pr ?? \"0\") + \"px\"), \"pt\" in t && (e.paddingTop = (t.pt ?? \"0\") + \"px\"), \"pb\" in t && (e.paddingBottom = (t.pb ?? \"0\") + \"px\"), this.#r.lay(t), this.#h(), this.#f = this.ctn.position.x, e.transformOrigin = `${this.ctn.pivot.x}px ${this.ctn.pivot.y}px`, this.cvsResize(), e.display = this.ctn.visible ? \"inline\" : \"none\", \":redraw\" in t && this.#a > 0) {\n      const s = [\n        this.#t.innerHTML.replaceAll(/(animation-delay: )\\d+ms/g, \"$10ms\"),\n        `<span class='sn_ch' data-add='{\"ch_in_style\":\"default\"}'>&emsp;</span>`\n      ];\n      this.#b(), this.goTxt(s, !0);\n    }\n  }\n  #y = 0;\n  // 「g」などで下が欠ける問題対策\n  #h() {\n    const t = this.#t.style, e = parseFloat(t.fontSize || \"0\");\n    this.#s.fontsize = e, this.#s.pad_left = parseFloat(t.paddingLeft || \"0\"), this.#s.pad_right = parseFloat(t.paddingRight || \"0\"), this.#s.pad_top = parseFloat(t.paddingTop || \"0\"), this.#s.pad_bottom = parseFloat(t.paddingBottom || \"0\"), this.#s.$width = parseFloat(t.width || \"0\"), this.#s.$height = parseFloat(t.height || \"0\"), this.position.set(this.#s.pad_left, this.#s.pad_top), this.#u = t.writingMode === \"vertical-rl\", this.#p = 0, this.#w = 0;\n    const s = t.lineHeight ?? \"0\";\n    this.#y = this.#u ? 0 : (s.endsWith(\"px\") ? parseFloat(s) : e * parseFloat(s) - e) / 2;\n  }\n  cvsResize() {\n    const t = this.#t.style, e = this.sys.cvsScale;\n    t.left = `${this.sys.ofsLeft4elm + this.#f * e}px`, t.top = `${this.sys.ofsTop4elm + this.ctn.position.y * e}px`, t.transform = `rotate(${this.ctn.angle}deg) scale(${this.ctn.scale.x * e}, ${this.ctn.scale.y * e})`;\n  }\n  #f = 0;\n  #u = !1;\n  get tategaki() {\n    return this.#u;\n  }\n  #p = 0;\n  #w = 0;\n  get infTL() {\n    return this.#s;\n  }\n  get getWidth() {\n    return this.#s.$width;\n  }\n  get getHeight() {\n    return this.#s.$height;\n  }\n  setMySize(t, e) {\n    this.#s.$width = t, this.#s.$height = e, this.#t.style.width = this.#s.$width + \"px\", this.#t.style.height = this.#s.$height + \"px\";\n  }\n  #l(t, e = !0) {\n    const s = {\n      escape: (p) => p.replaceAll(/([.*+?^${}()|\\[\\]\\/\\\\])/g, \"\\\\$1\"),\n      mimeType: (p) => {\n        const d = l(p).toLowerCase();\n        return i()[d] || \"\";\n      },\n      dataAsUrl: m,\n      isDataUrl: c,\n      resolveUrl: u,\n      getAndEncode: h,\n      asArray: (p) => {\n        const d = [], y = p.length;\n        for (let b = 0; b < y; ++b) d.push(p[b]);\n        return d;\n      }\n    };\n    function i() {\n      const p = \"application/font-woff\", d = \"image/jpeg\";\n      return {\n        woff: p,\n        woff2: p,\n        ttf: \"application/font-truetype\",\n        eot: \"application/vnd.ms-fontobject\",\n        png: \"image/png\",\n        jpg: d,\n        jpeg: d,\n        gif: \"image/gif\",\n        tiff: \"image/tiff\",\n        svg: \"image/svg+xml\"\n      };\n    }\n    const n = f(), o = r();\n    function a(p) {\n      return o.resolveAll().then((d) => {\n        const y = document.createElement(\"style\");\n        return p.appendChild(y), y.appendChild(document.createTextNode(d)), p;\n      });\n    }\n    function l(p) {\n      return /\\.([^\\.\\/]*?)$/g.exec(p)?.[1] ?? \"\";\n    }\n    function c(p) {\n      return p.search(/^(data:)/) !== -1;\n    }\n    function u(p, d) {\n      const y = document.implementation.createHTMLDocument(), b = y.createElement(\"base\");\n      y.head.appendChild(b);\n      const C = y.createElement(\"a\");\n      return y.body.appendChild(C), b.href = d, C.href = p, C.href;\n    }\n    function h(p) {\n      let d = 3e4;\n      return new Promise(function(y) {\n        const b = new XMLHttpRequest();\n        b.onreadystatechange = C, b.ontimeout = v, b.responseType = \"blob\", b.timeout = d, b.open(\"GET\", p, !0), b.send();\n        function C() {\n          if (b.readyState !== 4) return;\n          if (b.status !== 200) {\n            w(\"cannot fetch resource: \" + p + \", status: \" + b.status);\n            return;\n          }\n          const N = new FileReader();\n          N.onloadend = function() {\n            const S = N.result.toString().split(/,/)[1];\n            y(S);\n          }, N.readAsDataURL(b.response);\n        }\n        function v() {\n          w(\"timeout of \" + d + \"ms occured while fetching resource: \" + p);\n        }\n        function w(N) {\n          console.error(N), y(\"\");\n        }\n      });\n    }\n    function m(p, d) {\n      return \"data:\" + d + \";base64,\" + p;\n    }\n    function f() {\n      const p = /url\\(['\"]?([^'\"]+?)['\"]?\\)/g;\n      return {\n        inlineAll: C,\n        shouldProcess: d\n      };\n      function d(v) {\n        return v.search(p) !== -1;\n      }\n      function y(v) {\n        const w = [];\n        let N;\n        for (; N = p.exec(v); )\n          w.push(N[1]);\n        return w.filter(function(S) {\n          return !s.isDataUrl(S);\n        });\n      }\n      function b(v, w, N, S) {\n        return Promise.resolve(w).then((P) => N ? s.resolveUrl(P, N) : P).then(S || s.getAndEncode).then((P) => s.dataAsUrl(P, s.mimeType(w))).then((P) => v.replace(T(w), \"$1\" + P + \"$3\"));\n        function T(P) {\n          return new RegExp(`(url\\\\(['\"]?)(` + s.escape(P) + `)(['\"]?\\\\))`, \"g\");\n        }\n      }\n      function C(v, w, N) {\n        if (S()) return Promise.resolve(v);\n        return Promise.resolve(v).then(y).then((T) => {\n          let P = Promise.resolve(v);\n          for (const I of T) P = P.then((at) => b(at, I, w, N));\n          return P;\n        });\n        function S() {\n          return !d(v);\n        }\n      }\n    }\n    function r() {\n      return {\n        resolveAll: p,\n        impl: { readAll: d }\n      };\n      function p() {\n        return d().then((y) => Promise.allSettled(\n          y.map((b) => b.resolve())\n        )).then((y) => y.join(`\n`));\n      }\n      function d() {\n        return Promise.resolve(s.asArray(document.styleSheets)).then(b).then(y).then((v) => v.map(C));\n        function y(v) {\n          return v.filter((w) => w.type === CSSRule.FONT_FACE_RULE).filter((w) => n.shouldProcess(w.style.getPropertyValue(\"src\")));\n        }\n        function b(v) {\n          const w = [];\n          for (const N of v)\n            try {\n              if (N.href) continue;\n              s.asArray(N.cssRules || []).forEach(w.push.bind(w));\n            } catch (S) {\n              console.error(\"Error while reading CSS rules from \" + N.href, String(S));\n            }\n          return w;\n        }\n        function C(v) {\n          return {\n            resolve: function() {\n              const N = (v.parentStyleSheet || {}).href;\n              return n.inlineAll(v.cssText, N);\n            },\n            src: function() {\n              return v.style.getPropertyValue(\"src\");\n            }\n          };\n        }\n      }\n    }\n    Promise.resolve(this.#t).then((p) => {\n      const d = p.cloneNode(!0);\n      return d.style.padding = \"0px\", d.style.paddingRight = this.#p + \"px\", d.style.paddingTop = this.#w + \"px\", d.style.left = \"0px\", d.style.top = \"0px\", d.style.width = this.#s.$width - this.#s.pad_left - this.#s.pad_right + \"px\", d.style.height = this.#s.$height - this.#s.pad_top - this.#s.pad_bottom + \"px\", this.#t.hidden = e, d;\n    }).then(a).then((p) => {\n      p.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n      const d = new Image();\n      return d.src = `data:image/svg+xml;charset=utf-8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.#s.$width}px\" height=\"${this.#s.$height}px\"><foreignObject x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">${new XMLSerializer().serializeToString(p).replaceAll(\"#\", \"%23\").replaceAll(`\n`, \"%0A\")}</foreignObject></svg>`, new Promise((y) => d.onload = () => y(d));\n    }).then((p) => new Promise((d) => setTimeout(() => d(p), 100))).then((p) => {\n      const d = document.createElement(\"canvas\");\n      d.width = this.#s.$width, d.height = this.#s.$height, d.getContext(\"2d\").drawImage(p, 0, 0), t(_web2_js__WEBPACK_IMPORTED_MODULE_0__.s.from(d));\n    }).catch((p) => _web2_js__WEBPACK_IMPORTED_MODULE_0__.D.myTrace(`goTxt() = ${p}`));\n  }\n  #I = void 0;\n  // 文字にかけるフィルター\n  #$ = [];\n  #x = [];\n  #a = 0;\n  static #C = \"<span class='sn_ch sn_ch_last'>&emsp;</span>\";\n  goTxt(t, e) {\n    k.#H.visible = !1;\n    let s = this.#x.length, i = \"\";\n    if (s === 0) {\n      if (k.#i.oCfg.debug.masume && (_web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog && console.log(`🍌 masume ${this.name} v:${this.visible} l:${this.x} t:${this.y} a:${this.alpha} pl:${this.#s.pad_left} pr:${this.#s.pad_right} pt:${this.#s.pad_top} pb:${this.#s.pad_bottom} w:${this.#s.$width} h:${this.#s.$height}`), this.#d.clear().beginFill(3407616, 0.2).lineStyle(1, 3407616, 1).drawRect(-this.#s.pad_left, -this.#s.pad_top, this.#s.$width, this.#s.$height).endFill().beginFill(13311, 0.2).lineStyle(2, 13311, 1).drawRect(\n        0,\n        0,\n        this.#s.$width - this.#s.pad_left - this.#s.pad_right,\n        this.#s.$height - this.#s.pad_top - this.#s.pad_bottom\n      ).endFill()), this.#t.innerHTML = [...t].join(\"\").replaceAll(/[\\n\\t]/g, \"\") + k.#C, !this.#r.break_fixed) {\n        const y = globalThis.getComputedStyle(this.#t), b = parseFloat(y.fontSize);\n        this.#u ? (this.#r.break_fixed_left = (this.#s.$width - this.#s.pad_left - this.#s.pad_right - b * 1.5) * this.sys.cvsScale, this.#r.break_fixed_top = 0) : (this.#r.break_fixed_left = 0, this.#r.break_fixed_top = b / 2 * this.sys.cvsScale);\n      }\n    } else\n      i = this.#t.innerHTML, --s, this.#t.querySelector(\".sn_ch_last\")?.remove(), this.#t.querySelectorAll(\":scope > br\").forEach((y) => y.remove()), this.#t.insertAdjacentHTML(\n        \"beforeend\",\n        t.slice(this.#a).join(\"\").replaceAll(/[\\n\\t]/g, \"\") + k.#C\n        // 末尾改行削除挙動対策\n      );\n    this.#t.querySelectorAll(\".sn_ch:has(> ruby)\").forEach((y) => y.style.background = \"\"), this.#a = t.length;\n    const n = this.sys.cvsScale, o = this.#t.getBoundingClientRect(), a = o.left + this.#s.pad_left, l = o.top + this.#s.pad_top;\n    let c;\n    if (n === 1) c = (y, b) => {\n      const C = y.getBoundingClientRect();\n      return new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(\n        C.left - a,\n        C.top - l,\n        C.width,\n        C.height + (\"gjqy\".includes(b) ? this.#y : 0)\n      );\n    };\n    else {\n      const y = this.sys.ofsPadLeft_Dom2PIXI + o.left * (1 - n), b = this.sys.ofsPadTop_Dom2PIXI + o.top * (1 - n);\n      c = (C, v) => {\n        const w = C.getBoundingClientRect();\n        return new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(\n          (w.left - y) / n - a,\n          (w.top - b) / n - l,\n          w.width / n,\n          (w.height + (\"gjqy\".includes(v) ? this.#y : 0)) / n\n        );\n      };\n    }\n    const [u, h] = this.#r.hyph(this.#t, c, this.#u, s, i);\n    this.#x = u;\n    const m = _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.debugLog ? ({ ch: y }, { x: b, y: C, width: v, height: w }) => console.log(`🍌 masume ch:${y} x:${b} y:${C} w:${v} h:${w}`) : () => {\n    }, f = k.#i.oCfg.debug.masume ? (y, b) => {\n      m(y, b), this.#d.beginFill(6737151, 0.5).lineStyle(2, 16724736, 1).drawRect(b.x, b.y, b.width, b.height).endFill();\n    } : () => {\n    }, r = _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.ease(this.#N);\n    for (let y = s; y < h; ++y) {\n      const b = this.#x[y], C = b.rect, v = JSON.parse(b.elm.dataset.arg ?? '{\"delay\": 0}'), w = JSON.parse(b.elm.dataset.add ?? \"{}\"), N = k.#R[w.ch_in_style];\n      if (f(b, C), b.elm.dataset.cmd === \"grp\") {\n        const S = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.j();\n        this.#c.addChild(S), new _(v.pic, S, (T) => {\n          this.#J(S, v, w, C, r, N ?? {}), S.parent || S.removeChild(T);\n        });\n      }\n      if (b.elm.dataset.lnk) {\n        const S = b.elm.parentElement.closest(\"[data-arg]\"), T = JSON.parse(S.dataset.arg ?? \"{}\");\n        T.key = `lnk=[${y}] ` + this.name;\n        const P = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w();\n        this.#J(P, T, w, C, r, N ?? {});\n        const I = T.style ?? \"\", at = I + (T.style_hover ?? \"\"), gt = I + (T.style_clicked ?? \"\"), A = T.r_style ?? \"\", kt = A + (T.r_style_hover ?? \"\"), vt = A + (T.r_style_clicked ?? \"\"), ft = Array.from(S.getElementsByTagName(\"rt\"));\n        for (const et of ft) et.dataset.st_r_bk = et.style.cssText;\n        const $t = S.style.cssText, tt = (et, Ct) => {\n          S.style.cssText = $t + et;\n          for (const pt of ft) pt.style.cssText = pt.dataset.st_r_bk + Ct;\n        };\n        (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(T, \"enabled\", !0) ? k.#n.button(\n          T,\n          P,\n          () => tt(I, A),\n          () => this.canFocus() ? (tt(at, kt), !0) : !1,\n          () => tt(gt, vt)\n        ) : tt(\n          I + (T.style_disable ?? \"color: gray;\"),\n          A + (T.r_style_disable ?? \"color: gray;\")\n        ), this.#c.addChild(P);\n      }\n    }\n    const p = Array.from(this.#t.getElementsByClassName(\"sn_ch\"));\n    this.#k = () => {\n      this.#k = () => !1;\n      for (const y of p) y.className = y.className.replaceAll(/ go_ch_in_[^\\s\"]+/g, \"\");\n      return k.#H.position.set(\n        this.#r.break_fixed_left,\n        this.#r.break_fixed_top\n      ), k.#H.visible = !0, this.noticeCompTxt(), !0;\n    };\n    for (const y of p) y.className = y.className.replaceAll(/sn_ch_in_([^\\s\"]+)/g, \"go_ch_in_$1\");\n    s > 0 && ++s;\n    let d;\n    for (let y = h - 2; y >= 0; --y) {\n      const { elm: b } = this.#x[y];\n      if (b.tagName === \"SPAN\") {\n        d = b.parentElement?.tagName === \"RUBY\" ? b.parentElement.parentElement ?? b : b;\n        break;\n      }\n    }\n    if (!d || e || s === h) {\n      this.#k();\n      return;\n    }\n    d.addEventListener(\"animationend\", () => this.#k(), { once: !0, passive: !0 });\n  }\n  #k = () => !1;\n  #J(t, e, s, i, n, o) {\n    t.alpha = 0, e.x && (i.x = e.x.startsWith(\"=\") ? i.x + parseInt(e.x.slice(1)) : parseInt(e.x)), e.y && (i.y = e.y.startsWith(\"=\") ? i.y + parseInt(e.y.slice(1)) : parseInt(e.y)), e.width && (i.width = parseInt(e.width)), e.height && (i.height = parseInt(e.height)), e.wait && (o.wait = parseInt(e.wait)), t.width = i.width, t.height = i.height, o.x ? t.position.set(\n      o.x.startsWith(\"=\") ? i.x + t.width * o.nx : o.nx,\n      o.y.startsWith(\"=\") ? i.y + t.height * o.ny : o.ny\n    ) : t.position.set(i.x, i.y);\n    const a = {\n      sp: t,\n      tw: new _ReadState_js__WEBPACK_IMPORTED_MODULE_2__.T(t).to({ alpha: 1, x: i.x, y: i.y, width: i.width, height: i.height, angle: 0 }, o.wait ?? 0).easing(n).delay((s.wait ?? 0) + (e.delay ?? 0)).onComplete(() => {\n        a.tw = void 0;\n      }).start()\n    };\n    this.#$.push(a);\n  }\n  skipChIn() {\n    let t = this.#k();\n    for (const e of this.#$)\n      e.tw && (e.tw.stop().end(), t = !0);\n    return this.#$ = [], t;\n  }\n  static #R = /* @__PURE__ */ Object.create(null);\n  static #D = /[\\s\\.,]/;\n  static initChStyle() {\n    k.#R = /* @__PURE__ */ Object.create(null), k.#B = /* @__PURE__ */ Object.create(null);\n  }\n  static getChInStyle(t) {\n    return k.#R[t];\n  }\n  static ch_in_style(t) {\n    const { name: e } = t;\n    if (!e) throw \"nameは必須です\";\n    if (k.#D.test(e)) throw `name【${e}】に使えない文字が含まれます`;\n    if (e in k.#R) throw `name【${e}】はすでにあります`;\n    const s = String(t.x ?? \"=0\"), i = String(t.y ?? \"=0\");\n    return k.#R[e] = {\n      wait: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"wait\", 500),\n      // アニメ・FI時間\n      alpha: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"alpha\", 0),\n      x: s,\n      // 初期x値\n      y: i,\n      // [tsy]と同様に絶対・相対指定可能\n      // {x:500}\t\t\tX位置を500に\n      // {x:'=500'}\t\t現在のX位置に+500加算した位置\n      // {x:'=-500'}\t\t現在のX位置に-500加算した位置\n      // {x:'250,500'}\t+250から＋500までの間でランダムな値をX位置に\n      // {x:'=250,500'}\t+250から＋500までの間でランダムな値を現在のX位置に加算\n      nx: parseFloat(s.at(0) === \"=\" ? s.slice(1) : s),\n      ny: parseFloat(i.at(0) === \"=\" ? i.slice(1) : i),\n      scale_x: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_x\", 1),\n      scale_y: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_y\", 1),\n      rotate: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"rotate\", 0),\n      join: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"join\", !0),\n      // 文字を順番に出すか（true）同時か（false）\n      ease: t.ease ?? \"ease-out\"\n    };\n  }\n  static #B = /* @__PURE__ */ Object.create(null);\n  static getChOutStyle(t) {\n    return k.#B[t];\n  }\n  static ch_out_style(t) {\n    const { name: e } = t;\n    if (!e) throw \"nameは必須です\";\n    if (k.#D.test(e)) throw `name【${e}】に使えない文字が含まれます`;\n    if (e in k.#B) throw `name【${e}】はすでにあります`;\n    const s = String(t.x ?? \"=0\"), i = String(t.y ?? \"=0\");\n    return k.#B[e] = {\n      wait: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"wait\", 500),\n      // アニメ・FI時間\n      alpha: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"alpha\", 0),\n      x: s,\n      // 初期x値\n      y: i,\n      // [tsy]と同様に絶対・相対指定可能\n      // {x:500}\t\t\tX位置を500に\n      // {x:'=500'}\t\t現在のX位置に+500加算した位置\n      // {x:'=-500'}\t\t現在のX位置に-500加算した位置\n      // {x:'250,500'}\t+250から＋500までの間でランダムな値をX位置に\n      // {x:'=250,500'}\t+250から＋500までの間でランダムな値を現在のX位置に加算\n      nx: parseFloat(s.at(0) === \"=\" ? s.slice(1) : s),\n      ny: parseFloat(i.at(0) === \"=\" ? i.slice(1) : i),\n      scale_x: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_x\", 1),\n      scale_y: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_y\", 1),\n      rotate: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"rotate\", 0),\n      join: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"join\", !1),\n      // 文字を順番に出すか（true）同時か（false）\n      ease: t.ease ?? \"ease-out\"\n    };\n  }\n  static #H = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.j();\n  static #W = new _();\n  dispBreak(t) {\n    k.delBreak();\n    const e = k.#H;\n    e.visible = !1, this.addChild(e), k.#W.destroy(), k.#W = new _(t.pic, e, (s) => {\n      e.parent ? (s.x = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"x\", 0), s.y = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"y\", 0), s.width = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"width\", this.#s.fontsize), s.height = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"height\", this.#s.fontsize)) : e.removeChild(s);\n    });\n  }\n  static delBreak() {\n    const t = k.#H;\n    t.parent?.removeChild(t), k.#W.destroy();\n  }\n  #N = \"Quadratic.Out\";\n  #E = \"Quadratic.Out\";\n  #b() {\n    this.#d.clear(), this.#x = [], this.#a = 0, this.skipChIn();\n    const t = this.#t.cloneNode(!0);\n    t.textContent = \"\";\n    const e = this.#t;\n    e.parentElement.insertBefore(t, e);\n    let s = 0;\n    e.querySelectorAll(\"span.sn_ch\").forEach((n) => {\n      const o = JSON.parse(\n        n?.dataset.add ?? // 通常文字\n        n?.children[0]?.getAttribute(\"data-add\") ?? // ルビ\n        n?.children[0]?.children[0]?.getAttribute(\"data-add\") ?? \"{}\"\n        // 縦中横\n      );\n      if (!o.ch_out_style) return;\n      const a = k.#B[o.ch_out_style];\n      if (a) {\n        if (a.wait === 0) {\n          n.style.display = \"none\";\n          return;\n        }\n        s += a.wait, a.join || (n.style.animationDelay = \"0ms\"), n.classList.add(`go_ch_out_${o.ch_out_style}`);\n      }\n    });\n    const i = () => {\n      e.parentElement.removeChild(e);\n      for (const n of this.#c.removeChildren())\n        n instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.j && k.#n.unButton(n), n.destroy();\n    };\n    s === 0 ? (this.#t.textContent = \"\", i()) : e.lastElementChild?.addEventListener(\"animationend\", i, { once: !0, passive: !0 }), this.#t = t;\n  }\n  reNew() {\n    this.#b();\n    const t = new k(this.ctn, () => this.canFocus(), this.sys);\n    return t.#s = this.#s, t.#t.style.cssText = this.#t.style.cssText, t.#f = this.#f, t.name = this.name, t.#h(), t.#I = this.#I, t.#N = this.#N, t.#E = this.#E, this.#r.reNew(t.#r), this.destroy(), t;\n  }\n  record() {\n    return {\n      infTL: this.#s,\n      cssText: this.#t.style.cssText,\n      left: this.#f,\n      //\t\tidc_hArg\t: this.#idc.gethArg(),\n      ch_filter: this.#I,\n      fi_easing: this.#N,\n      fo_easing: this.#E,\n      hyph: this.#r.record()\n    };\n  }\n  playback(t) {\n    this.#s = t.infTL, this.position.set(this.#s.pad_left, this.#s.pad_top), this.#t.style.cssText = t.cssText, this.#f = t.left, this.#h(), this.#I = t.ch_filter, this.#N = t.fi_easing, this.#E = t.fo_easing, this.#r.playback(t.hyph);\n  }\n  get cssText() {\n    return this.#t.style.cssText;\n  }\n  set cssText(t) {\n    this.#t.style.cssText = t;\n  }\n  #v = void 0;\n  snapshot(t, e) {\n    this.#l((s) => {\n      this.#v = _web2_js__WEBPACK_IMPORTED_MODULE_0__.w.from(s), this.#u && (this.#v.x += _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW - (this.#f + this.#s.$width)), this.#v.y -= this.#w, this.#v.texture.frame = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(\n        0,\n        0,\n        Math.min(this.#v.width, this.#s.$width - this.#f),\n        Math.min(this.#v.height, this.#s.$height)\n      ), this.#c.addChild(this.#v), t.render(this.#v, { clear: !1 }), e();\n    }, !1);\n  }\n  snapshot_end() {\n    this.#v && (this.#c.removeChild(this.#v), this.#v = void 0);\n  }\n  makeDesignCast(t) {\n  }\n  showDesignCast() {\n  }\n  //\tshowDesignCast() {this.#idc.visible = true; this.#idcCh.visible = true}\n  dump() {\n    const t = [], e = this.#t.style, s = e.length;\n    for (let i = 0; i < s; ++i) {\n      const n = e[i];\n      t.push(`\"${n}\":\"${e[n].replaceAll(/([\"\\\\])/g, \"\\\\$1\")}\"`);\n    }\n    return `\"txt\":\"${this.#t.textContent.replaceAll(/([\"\\\\])/g, \"\\\\$1\")}\", \"style\":{${t.join(\",\")}}`;\n  }\n  destroy() {\n    k.delBreak(), this.#t.parentElement.removeChild(this.#t), this.removeChild(this.#c), this.removeChild(this.#d), super.destroy();\n  }\n}\nclass D extends _web2_js__WEBPACK_IMPORTED_MODULE_0__.j {\n  constructor(t, e, s, i) {\n    if (super(), this.hArg = t, this.evtMng = e, this.resolve = s, this.canFocus = i, this.#t = {\n      type: \"pic\",\n      enabled: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"enabled\", !0),\n      x: this.x = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)(t.left ?? 0),\n      y: this.y = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)(t.top ?? 0),\n      rotation: this.angle = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"rotation\", this.angle),\n      // flash : rotation is in degrees.\n      // pixijs: rotation is in radians, angle is in degrees.\n      pivot_x: this.pivot.x = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"pivot_x\", this.pivot.x),\n      pivot_y: this.pivot.y = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"pivot_y\", this.pivot.y),\n      scale_x: this.scale.x = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_x\", this.scale.x),\n      scale_y: this.scale.y = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_y\", this.scale.y),\n      alpha: 1,\n      text: \"\",\n      b_pic: \"\",\n      width: 0,\n      height: 0\n    }, this.getBtnBounds = () => (this.#n.x = this.#t.x, this.#n.y = this.#t.y, this.#n), this.#t.enabled && e.button(t, this, () => this.normal(), () => this.#d(), () => this.#m()), t.pic) {\n      this.#t.type = \"pic\", this.#o = new _(\n        t.pic,\n        this,\n        (h) => {\n          this.#r(h), this.#n.width = h.width * this.#t.scale_x, this.#n.height = h.height * this.#t.scale_y;\n        },\n        (h) => s\n      );\n      return;\n    }\n    if (!t.text) throw \"textまたはpic属性は必須です\";\n    const n = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"height\", 30), o = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.F({\n      align: \"center\",\n      dropShadow: !0,\n      dropShadowAlpha: 0.7,\n      dropShadowColor: \"white\",\n      dropShadowBlur: 7,\n      dropShadowDistance: 0,\n      fill: this.#t.enabled ? \"black\" : \"gray\",\n      fontFamily: D.fontFamily,\n      fontSize: n,\n      padding: 5\n    });\n    if (t.style) try {\n      const h = JSON.parse(t.style);\n      for (const [m, f] of Object.entries(h)) o[m] = f;\n      this.#t = { ...this.#t, ...h };\n    } catch (h) {\n      throw h instanceof SyntaxError ? new Error((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.o)(t, \"style\", h.message)) : \"fn:Button.ts style\";\n    }\n    const a = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.H(t.text ?? \"\", o);\n    a.alpha = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"alpha\", a.alpha), a.width = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"width\", 100), a.height = t.height = n, this.setText = (h) => a.text = h, this.#t = {\n      ...this.#t,\n      type: \"text\",\n      // dump用\n      alpha: a.alpha,\n      text: a.text,\n      width: a.width,\n      height: a.height\n    };\n    let l = !1;\n    if (this.#t.width = this.width, this.#t.height = this.height, t.b_pic && (this.#t.b_pic = t.b_pic, this.#o = new _(\n      t.b_pic,\n      this,\n      (h) => {\n        this.#c(h, a), this.#t.width = this.width, this.#t.height = this.height, a.name = JSON.stringify(this.#t);\n      },\n      (h) => {\n        _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.setBlendmode(this, t), h && s();\n      }\n    ), l = this.#o.ret), a.name = JSON.stringify(this.#t), this.addChild(a), this.#n.width = a.width, this.#n.height = a.height, t.b_pic || _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.setBlendmode(this, t), D.#i(this, a), !this.#t.enabled) {\n      l || s();\n      return;\n    }\n    const c = o.clone();\n    if (t.style_hover) try {\n      const h = JSON.parse(t.style_hover);\n      for (const [m, f] of Object.entries(h)) c[m] = f;\n    } catch (h) {\n      throw h instanceof SyntaxError ? new Error((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.o)(t, \"style_hover\", h.message)) : \"fn:Button.ts style_hover\";\n    }\n    else c.fill = \"white\";\n    const u = c.clone();\n    if (t.style_clicked) try {\n      const h = JSON.parse(t.style_clicked);\n      for (const [m, f] of Object.entries(h)) u[m] = f;\n    } catch (h) {\n      throw h instanceof SyntaxError ? new Error((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.o)(t, \"style_clicked\", h.message)) : \"fn:Button.ts style_clicked\";\n    }\n    else u.dropShadow = !1;\n    this.normal = () => a.style = o, this.#d = () => i() ? (a.style = c, !0) : !1, this.#m = () => a.style = u, l || s();\n  }\n  static fontFamily = \"'Hiragino Sans', 'Hiragino Kaku Gothic ProN', '游ゴシック Medium', meiryo, sans-serif\";\n  static #i = (t, e) => {\n  };\n  static #e = (t, e, s, i) => {\n  };\n  static init(t) {\n    t.oCfg.debug.masume && (D.#i = (e, s) => e.addChild(\n      new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z().beginFill(8926088, 0.2).lineStyle(1, 8926088, 1).drawRect(s.x, s.y, s.width, s.height).endFill()\n    ), D.#e = (e, s, i, n) => e.addChild(\n      new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z().beginFill(8926088, 0.2).lineStyle(1, 8926088, 1).drawRect(s.x, s.y, i, n).endFill()\n    ));\n  }\n  setText(t) {\n  }\n  getBtnBounds = () => this.#n;\n  // 文字ボタンは背景画像を含まない位置指定なので、その当たり判定用\n  #n = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R();\n  #o = new _();\n  //\t#idc\t\t: DesignCast;\n  #t;\n  destroy() {\n    this.evtMng.unButton(this), this.#o.destroy(), super.destroy();\n  }\n  makeDesignCast(t) {\n  }\n  showDesignCast() {\n  }\n  //\tshowDesignCast() {this.#idc.visible = true}\n  cvsResize() {\n  }\n  #c(t, e) {\n    this.setChildIndex(t, 0), t.alpha = e.alpha, t.setTransform(\n      e.x,\n      e.y,\n      1,\n      1,\n      e.rotation,\n      0,\n      0,\n      (t.width - e.width) / 2,\n      (t.height - e.height) / 2\n    ), t.name = e.name;\n  }\n  normal = () => {\n  };\n  #d = () => !1;\n  #m = () => {\n  };\n  #r(t) {\n    this.#t.alpha = t.alpha = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(this.hArg, \"alpha\", t.alpha);\n    const e = t.width / 3, s = this.#t.enabled ? e : t.width, i = t.height, n = t.texture.baseTexture, o = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.s(n, new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(0, 0, e, i)), a = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.s(n, new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(e, 0, e, i)), l = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.s(n, new _web2_js__WEBPACK_IMPORTED_MODULE_0__.R(e * 2, 0, e, i)), c = () => t.texture = o;\n    this.#t.enabled && c(), this.normal = c, this.#d = () => this.canFocus() ? (t.texture = l, !0) : !1, this.#m = () => t.texture = a, \"width\" in this.hArg ? (this.#t.width = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)(this.hArg.width), this.scale.x *= this.#t.width / s) : this.#t.width = s, \"height\" in this.hArg ? (this.#t.height = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)(this.hArg.height), this.scale.y *= this.#t.height / i) : this.#t.height = i, t.name = JSON.stringify(this.#t), D.#e(this, t, s, i);\n  }\n}\nclass x extends _web2_js__WEBPACK_IMPORTED_MODULE_0__.x {\n  static #i;\n  static #e;\n  static #n;\n  static #o;\n  static init(t, e, s, i, n, o) {\n    x.#i = t, k.init(t, o), x.#e = s, x.#o = i, x.#n = n, s.setDoRecProc(x.chgDoRec), e.autowc = (a) => x.#y(a), e.autowc({ enabled: !1, text: \"\", time: 0 }), e.ch_in_style = (a) => x.#t(a), e.ch_out_style = (a) => x.#c(a), k.initChStyle(), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.I)(), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.k)(\n      t.matchPath(\".+\", _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.FONT).flatMap((a) => Object.values(a).map((l) => `\n@font-face {\n\tfont-family: '${l}';\n\tsrc: url('${this.#i.searchPath(l, _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.FONT)}');\n}\n`)).join(\"\") + `\n.sn_tx {\n\tpointer-events: none;\n\tuser-select: none;\n\t-webkit-touch-callout: none;\n\tbox-sizing: border-box;\n}\n.sn_ch {\n\tposition: relative;\n\tdisplay: inline-block;\n}\n`\n      // 「sn_ch」と「sn_ch_in_〜」の中身が重複しているが、これは必須\n    ), x.#t({\n      name: \"default\",\n      wait: 500,\n      alpha: 0,\n      x: \"=0.3\",\n      y: \"=0\",\n      scale_x: 1,\n      scale_y: 1,\n      rotate: 0,\n      join: !0,\n      ease: \"ease-out\"\n    }), x.#c({\n      name: \"default\",\n      wait: 0,\n      alpha: 0,\n      x: \"=0\",\n      y: \"=0\",\n      scale_x: 1,\n      scale_y: 1,\n      rotate: 0,\n      join: !1,\n      ease: \"ease-out\"\n    });\n  }\n  // 文字出現演出\n  static #t(t) {\n    const e = k.ch_in_style(t), s = e.x.startsWith(\"=\") ? `${e.nx * 100}%` : `${e.nx}px`, i = e.y.startsWith(\"=\") ? `${e.ny * 100}%` : `${e.ny}px`, { name: n } = t;\n    return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.k)(`\n.sn_ch_in_${n} {\n\tposition: relative;\n\tdisplay: inline-block;\n}\n.go_ch_in_${n} {\n\topacity: ${e.alpha};\n\tposition: relative;\n\tdisplay: inline-block;\n\tanimation: sn_ch_in_${n} ${e.wait}ms ${e.ease} 0s both;\n}\n@keyframes sn_ch_in_${n} {\n\tfrom {transform: rotate(${e.rotate}deg) scale(${e.scale_x}, ${e.scale_y}) translate(${s}, ${i})}\n\tto {opacity: 1; transform: none;}\n}\n`), !1;\n  }\n  // 文字消去演出\n  static #c(t) {\n    const e = k.ch_out_style(t), s = e.x.startsWith(\"=\") ? `${e.nx * 100}%` : `${e.nx}px`, i = e.y.startsWith(\"=\") ? `${e.ny * 100}%` : `${e.ny}px`, { name: n } = t;\n    return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.k)(`\n.go_ch_out_${n} {\n\tposition: relative;\n\tdisplay: inline-block;\n\tanimation: go_ch_out_${n} ${e.wait}ms ${e.ease} 0s both;\n}\n@keyframes go_ch_out_${n} {\n\tto {\n\t\topacity: ${e.alpha};\n\t\ttransform: rotate(${e.rotate}deg) scale(${e.scale_x}, ${e.scale_y}) translate(${s}, ${i});\n\t}\n`), !1;\n  }\n  static #d;\n  static #m;\n  static setEvtMng(t, e, s) {\n    x.#d = t, x.#m = e, k.setEvtMng(t, s);\n  }\n  // 文字ごとのウェイト\n  static #r = !1;\n  static #s = {};\n  static #y(t) {\n    x.#r = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"enabled\", x.#r), x.#e.setVal_Nochk(\"save\", \"const.sn.autowc.enabled\", x.#r);\n    const { text: e } = t;\n    if (\"text\" in t != \"time\" in t) throw \"[autowc] textとtimeは同時指定必須です\";\n    if (x.#e.setVal_Nochk(\"save\", \"const.sn.autowc.text\", e), !e)\n      return x.#e.setVal_Nochk(\"save\", \"const.sn.autowc.time\", \"\"), !1;\n    const s = e.length;\n    if (x.#r && s === 0) throw '[autowc] enabled === false かつ text === \"\" は許されません';\n    const i = String(t.time).split(\",\");\n    if (i.length !== s) throw \"[autowc] text文字数とtimeに記述された待ち時間（コンマ区切り）は同数にして下さい\";\n    x.#s = {};\n    for (let n = 0; n < s; ++n) x.#s[e[n]] = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)(i[n]);\n    return x.#e.setVal_Nochk(\"save\", \"const.sn.autowc.time\", t.time), !1;\n  }\n  // バック\n  #h = 0;\n  #f = 0;\n  #u = !1;\n  #p = void 0;\n  #w = \"\";\n  // 背景画像無し（＝単色塗り）\n  // 文字表示\n  #l = new k(this.ctn, () => this.canFocus(), x.#m);\n  #I = new _RubySpliter_js__WEBPACK_IMPORTED_MODULE_3__.R();\n  #$ = document.createElement(\"span\");\n  // cssチェック・保存用\n  static #x = {\n    \"text-align\": 0,\n    \"text-align-last\": 0,\n    height: 0,\n    width: 0,\n    \"padding-left\": 0,\n    \"padding-right\": 0,\n    \"padding-top\": 0,\n    \"padding-bottom\": 0\n  };\n  #a = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.j();\n  constructor() {\n    super(), this.ctn.addChild(this.#l), this.#I.init(this.#G), this.ctn.addChild(this.#a), this.#a.name = \"cntBtn\", this.lay({ style: `width: ${_web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW}px; height: ${_web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH}px; font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', '游ゴシック Medium', meiryo, sans-serif; color: white; font-size: 24px; line-height: 1.5; padding: 16px;`, in_style: \"default\", out_style: \"default\", back_clear: \"true\" });\n  }\n  destroy() {\n    this.#p && (this.ctn.removeChild(this.#p).destroy(), this.#p = void 0), x.#o.recPagebreak(), this.#l.destroy();\n  }\n  static destroy() {\n    x.#r = !1, x.#s = {}, x.#g = (t) => t;\n  }\n  set name(t) {\n    this.name_ = t, this.#l.name = t;\n  }\n  get name() {\n    return this.name_;\n  }\n  // getは継承しないらしい\n  cvsResize() {\n    this.#l.cvsResize();\n  }\n  cvsResizeChildren() {\n    for (const t of this.#a.children) t.cvsResize();\n  }\n  procSetX(t) {\n    this.#l.lay({ x: t });\n  }\n  procSetY(t) {\n    this.#l.lay({ y: t });\n  }\n  lay(t) {\n    if (super.lay(t), _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.setXY(this.ctn, t, this.ctn), t[\":id_tag\"] = this.name_.slice(0, -7), _RubySpliter_js__WEBPACK_IMPORTED_MODULE_3__.R.setting(t), this.#W(t), this.#l.lay(t), \"r_align\" in t && (this.#P = t.r_align ?? \"\"), this.#z = _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isSafari ? this.#l.tategaki ? (s, i) => `text-align: start; height: ${i}em; padding-top: ${s}; padding-bottom: ${s};` : (s, i) => `text-align: start; width: ${i}em; padding-left: ${s}; padding-right: ${s};` : this.#l.tategaki ? (s) => `text-align: justify; text-align-last: justify; padding-top: ${s}; padding-bottom: ${s};` : (s) => `text-align: justify; text-align-last: justify; padding-left: ${s}; padding-right: ${s};`, _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isFirefox && (this.#X = this.#A), \"r_style\" in t)\n      if (t.r_style) {\n        const s = document.createElement(\"span\");\n        s.style.cssText = t.r_style;\n        const i = s.style.length, n = this.#$.style;\n        for (let o = 0; o < i; ++o) {\n          const a = s.style[o];\n          if (a in x.#x) {\n            _web2_js__WEBPACK_IMPORTED_MODULE_0__.D.myTrace(`${a}は指定できません`, \"W\");\n            continue;\n          }\n          const l = s.style[a];\n          l && (n[a] = l);\n        }\n      } else this.#$.style.cssText = \"\";\n    if (\"alpha\" in t) for (const s of this.#a.children) s.alpha = this.ctn.alpha;\n    this.#C(t), this.#R(t);\n    const e = this.#H(t, (s) => {\n      s && (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n    });\n    return e && (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)(), e;\n  }\n  #C(t) {\n    const { in_style: e } = t;\n    if (!e) return;\n    const s = k.getChInStyle(e);\n    if (!s) throw `存在しないin_style【${e}】です`;\n    this.#k = e, this.#J = s.join;\n  }\n  #k = \"\";\n  #J = !0;\n  get width() {\n    return this.#l.getWidth;\n  }\n  get height() {\n    return this.#l.getHeight;\n  }\n  #R(t) {\n    const { out_style: e } = t;\n    if (!e) return;\n    if (!k.getChOutStyle(e)) throw `存在しないout_style【${e}】です`;\n    this.#D = e;\n  }\n  #D = \"\";\n  #B = new _();\n  #H(t, e) {\n    if (\"back_clear\" in t)\n      return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"back_clear\", !1) && (this.#h = 0, this.#f = 0, this.#u = !1, this.#w = \"\"), e(!1), !1;\n    this.#f = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"b_alpha\", this.#f), this.#u = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"b_alpha_isfixed\", this.#u);\n    const s = (this.#u ? 1 : Number(x.#e.getVal(\"sys:TextLayer.Back.Alpha\"))) * this.#f;\n    if (t.b_pic) {\n      if (this.#w !== t.b_pic)\n        return this.#w = t.b_pic, this.#p && (this.ctn.removeChild(this.#p), this.#p.destroy()), this.#B = new _(this.#w, this.ctn, (i) => {\n          this.#p = i, i.name = \"back(pic)\", i.visible = s > 0, i.alpha = s, this.#l.setMySize(i.width, i.height), this.ctn.setChildIndex(i, 0), e(!0);\n        }), this.#B.ret;\n    } else \"b_color\" in t && (this.#h = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.J)(t, \"b_color\", 0), this.#p && (this.ctn.removeChild(this.#p), this.#p.destroy()), this.#w = \"\", this.ctn.addChildAt(\n      (this.#p = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z()).beginFill(this.#h).lineStyle(void 0).drawRect(0, 0, this.#l.getWidth, this.#l.getHeight).endFill(),\n      0\n    ), this.#p.name = \"back(color)\");\n    return this.#p && (this.#p.visible = s > 0, this.#p.alpha = s), e(!1), !1;\n  }\n  chgBackAlpha(t) {\n    const e = this.#u ? this.#f : t * this.#f;\n    this.#p instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.z && (this.#p && (this.ctn.removeChild(this.#p), this.#p.destroy()), this.ctn.addChildAt(\n      (this.#p = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z()).beginFill(this.#h).lineStyle(void 0).drawRect(0, 0, this.#l.getWidth, this.#l.getHeight).endFill(),\n      0\n    ), this.#p.name = \"back(color)\"), this.#p && (this.#p.visible = e > 0, this.#p.alpha = e);\n  }\n  #W(t) {\n    \"noffs\" in t && (this.#b = t.noffs ?? \"\", this.#v = new RegExp(`[　${this.#b}]`)), \"ffs\" in t && (this.#N ??= \"\", this.#E = this.#N === \"\" ? () => \"\" : (e) => this.#v.test(e) ? \"\" : ` font-feature-settings: ${this.#N};`);\n  }\n  #N = \"\";\n  #E = (t) => \"\";\n  #b = \"\";\n  #v = /[　]/;\n  // Safariが全体に「font-feature-settings」した後、特定文字の「font-feature-settings: initial;」を受け付けてくれないのでわざわざ一つずつ指定\n  static chgDoRec(t) {\n    x.#g = t ? (e) => e : (e) => `<span class='offrec'>${e}</span>`;\n  }\n  static #g = (t) => t;\n  isCur = !1;\n  #z = () => \"\";\n  #X = (t, e, s, i = \"\") => {\n    if (!s) return ` style='${i}'`;\n    const n = t.length * 2;\n    if (n - e.length < 0) return ` style='text-align: ${s}; ${i}'`;\n    let o = \"\";\n    switch (s) {\n      case \"justify\":\n        o = this.#z(\"0\", n);\n        break;\n      case \"121\":\n        o = this.#z(`calc(${(n - e.length) / (e.length * 2)}em)`, n);\n        break;\n      case \"even\":\n        o = this.#z(`calc(${(n - e.length) / (e.length + 1)}em)`, n);\n        break;\n      case \"1ruby\":\n        o = this.#z(\"1em\", n);\n        break;\n      default:\n        o = `text-align: ${s};`;\n    }\n    return ` style='${o} ${i}'`;\n  };\n  #P = \"\";\n  #A(t, e, s, i = \"\") {\n    if (!s) return ` style='${i}'`;\n    const n = t.length * 2;\n    if (n - e.length < 0) return ` style='text-align: ${s}; ${i}'`;\n    let o = \"\";\n    switch (s) {\n      case \"left\":\n        o = \"ruby-align: start;\";\n        break;\n      case \"center\":\n        o = \"ruby-align: center;\";\n        break;\n      case \"right\":\n        o = \"ruby-align: start;\";\n        break;\n      case \"justify\":\n        o = \"ruby-align: space-between;\";\n        break;\n      case \"121\":\n        o = \"ruby-align: space-around;\";\n        break;\n      case \"even\":\n        const a = (n - e.length) / (e.length + 1);\n        o = \"ruby-align: space-between; \" + (this.#l.tategaki ? `padding-top: ${a}em; padding-bottom: ${a}em;` : `padding-left: ${a}em; padding-right: ${a}em;`);\n        break;\n      case \"1ruby\":\n        o = \"ruby-align: space-between; \" + (this.#l.tategaki ? \"padding-top: 1em; padding-bottom: 1em;\" : \"padding-left: 1em; padding-right: 1em;\");\n        break;\n      default:\n        o = `text-align: ${s};`;\n    }\n    return ` style='${o} ${i}'`;\n  }\n  tagCh(t) {\n    this.#I.putTxt(t);\n  }\n  #O = !1;\n  #G = (t, e) => {\n    x.#i.oCfg.debug.putCh && console.log(`🖊 文字表示 text:\\`${t}\\`(${t.charCodeAt(0).toString(16)}) ruby:\\`${e}\\` name:\\`${this.name_}\\``);\n    const s = e.split(\"｜\");\n    let i = \"\";\n    const [n, ...o] = s, a = o.join(\"｜\");\n    switch (s.length) {\n      case 1:\n        if (this.#O = !0, t === `\n`) {\n          this.#T ? (this.#T = !1, i = \"<ruby>&emsp;<rt>&emsp;</rt></ruby><br/>\") : i = \"<br/>\";\n          break;\n        }\n        this.#T && (this.#T = !1, e === \"\" && (e = \"&emsp;\")), i = this.#Q(t, e, this.#P);\n        break;\n      default:\n        switch (n) {\n          // ルビ揃え指定と同時シリーズ\n          case \"start\":\n          // 初期値\n          case \"left\":\n          //（肩付き）先頭親文字から、ルビ間は密着\n          case \"center\":\n          //（中付き）センター合わせ、〃\n          case \"right\":\n          //（右／下揃え）末尾親文字から、〃\n          case \"justify\":\n          //（両端揃え）先頭から末尾親文字間に、ルビ間は均等にあける\n          case \"121\":\n          //（1-2-1(JIS)）ルビの前後を比率1、ルビ間を比率2であける\n          case \"even\":\n          //（均等アキ）ルビの前後、ルビ間も均等にあける\n          case \"1ruby\":\n            this.#T = !1, this.#O = !0, i = this.#Q(t, a, n);\n            break;\n          case \"gotxt\":\n            this.#K(), this.#O ? (this.isCur && x.#o.recText(\n              this.#S.join(\"\").replace(/^<ruby>&emsp;<rt>&emsp;<\\/rt><\\/ruby>(<br\\/>)+/, \"\").replaceAll(/style='(anim\\S+ \\S+?;\\s*)+/g, \"style='\").replaceAll(/( style=''| data-(add|arg|cmd)='.+?'|\\n+|\\t+)/g, \"\").replaceAll(/class='sn_ch .+?'/g, \"class='sn_ch'\").replaceAll(\"display: none;\", \"\").replaceAll(\"class='offrec'\", \"style='display: none;'\")\n              // 囲んだ領域は履歴で非表示\n            ), this.#l.goTxt(this.#S, this.#V === 0), this.#O = !1, this.#V = 0) : this.isCur && this.#l.noticeCompTxt();\n            return;\n          // breakではない\n          case \"add\":\n            {\n              const l = JSON.parse(a), { style: c = \"\", wait: u = null } = l, { cl: h, sty: m } = this.#L(!0, u);\n              this.#S.push(`<span${h} style='${m} display: inline; ${c}'>`), delete l.style, this.#Z(l);\n            }\n            return;\n          // breakではない\n          case \"add_close\":\n            this.#S.push(\"</span>\"), this.#K();\n            return;\n          // breakではない\n          case \"grp\":\n            this.#O = !0;\n            {\n              const l = JSON.parse(a);\n              if (l.id ??= this.#S.length, l.id === \"break\") {\n                this.#l.dispBreak(l);\n                return;\n              }\n              this.#T = !1, l.delay = this.#V, l.r ??= \"\", l.style ??= \"\", l.r_style ??= \"\";\n              const { cl: c, sty: u, lnk: h } = this.#L(!0, l.wait);\n              i = `<span${c} style='${u} ${l.style}'><ruby><span data-cmd='grp' data-arg='${JSON.stringify(l)}'${h} style='${u} display: inline;'>&emsp;</span><rt${h}${this.#X(\n                \"　\",\n                l.r,\n                this.#P,\n                this.#$.style.cssText + (this.#_.at(-1)?.o.r_style ?? \"\") + l.r_style\n              )}>${l.r}</rt></ruby></span>`;\n            }\n            break;\n          case \"tcy\":\n            this.#T = !1, this.#O = !0;\n            {\n              const { t: l, r: c = \"\", wait: u = null, style: h = \"\", r_style: m = \"\" } = JSON.parse(a);\n              x.#e.doRecLog() && (this.#j += t + (e ? `《${e}》` : \"\"), this.#U += l);\n              const f = _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isSafari ? c.replaceAll(/[A-Za-z0-9]/g, (y) => String.fromCharCode(y.charCodeAt(0) + 65248)) : c, { cl: r, sty: p, lnk: d } = this.#L(!0, u);\n              i = `<span${r} style='${p}${this.#E(l)} ${h}'><ruby><span${d} style='${p} display: inline; text-combine-upright: all;'>${l}</span><rt${d}${this.#X(\n                l,\n                f,\n                this.#P,\n                this.#$.style.cssText + (this.#_.at(-1)?.o.r_style ?? \"\") + m\n              )}>${f}</rt></ruby></span>`;\n            }\n            break;\n          case \"del\":\n            k.delBreak();\n            return;\n          // breakではない\n          case \"span\":\n            this.#O = !0, this.#M(JSON.parse(a));\n            return;\n          // breakではない\n          case \"link\":\n            this.#O = !0;\n            {\n              const l = JSON.parse(a);\n              l[\":link\"] = \" data-lnk='@'\";\n              const { cl: c, sty: u, curpos: h } = this.#L(!1, l.wait);\n              this.#S.push(`<span${c} style='${u} display: inline; ${l.style ?? \"\"}' ${h} data-arg='${a}'>`), delete l.style, this.#M(l);\n            }\n            return;\n          // breakではない\n          case \"endlink\":\n            this.#O = !0, this.#S.push(\"</span>\"), this.#K();\n            return;\n          // breakではない\n          default:\n            this.#O = !0, i = this.#Q(t, e, this.#P);\n        }\n        break;\n    }\n    this.#S.push(x.#g(i));\n  };\n  #Q(t, e, s) {\n    const i = t === \" \" ? \"&nbsp;\" : t === \"　\" ? \"&emsp;\" : t;\n    x.#e.doRecLog() && (this.#j += i + (e ? `《${e}》` : \"\"), t !== \" \" && (this.#U += t));\n    const { cl: n, sty: o, lnk: a } = this.#L(!0, null, t);\n    return e ? `<span${n} style='${o} ${this.#E(t)}'><ruby>${// 文字個別に出現させるため以下にも ${cl} が必要\n    Array.from(t).map((l, c) => `<span${n}${a} style='${c > 0 ? this.#L(!0, null, t).sty : o} display: inline;'>${l === \" \" ? \"&nbsp;\" : l === \"　\" ? \"&emsp;\" : l}</span>`).join(\"\")}<rt${a}${this.#X(\n      t,\n      e,\n      s,\n      this.#$.style.cssText + (this.#_.at(-1)?.o.r_style ?? \"\")\n    )}>${e}</rt></ruby></span>` : `<span${n} style='${o} ${this.#E(t)}'${a}>${i}</span>`;\n  }\n  #L(t, e, s = `\n`) {\n    const i = this.#J ? e ?? this.#_.at(0)?.o.wait ?? (x.#r ? x.#s[s.at(0) ?? \"\"] ?? 0 : J.msecChWait) : 0;\n    x.#d.isSkipping ? this.#V = 0 : t && this.#J && (this.#V += Number(i));\n    const n = `data-add='{\"ch_in_style\":\"${this.#k}\", \"ch_out_style\":\"${this.#D}\"}'`;\n    return {\n      cl: ` class='sn_ch sn_ch_in_${this.#k}'`,\n      // TxtStage.goTxt()はこれ単位で文字出現させる\n      sty: `animation-delay: ${this.#V}ms;${this.#_.at(-1)?.o.style ?? \"\"}`,\n      // TxtStage.goTxt()はこれ単位で文字出現させる\n      lnk: (this.#_.at(0)?.o[\":link\"] ?? \"\") + \" \" + n,\n      curpos: n\n    };\n  }\n  #V = 0;\n  #T = !0;\n  #S = [];\n  #_ = [];\n  #Z(t) {\n    this.#_.push({\n      o: t,\n      r_align: this.#P,\n      ch_in_style: this.#k,\n      ch_out_style: this.#D\n    }), \"r_align\" in t && (this.#P = t.r_align), this.#C(t), this.#R(t);\n  }\n  #K() {\n    const t = this.#_.pop();\n    t && (this.#P = t.r_align, this.#C({ in_style: t.ch_in_style }), this.#R({ out_style: t.ch_out_style }));\n  }\n  #M(t) {\n    const e = this.#_.at(-1);\n    if (!e) {\n      this.#Z(t);\n      return;\n    }\n    e.o = { ...e.o, ...t }, !t.style && !t.r_style && (e.o.style = \"\", e.o.r_style = \"\"), \"r_align\" in t && (this.#P = t.r_align), this.#C(t), this.#R(t);\n  }\n  click = () => !this.ctn.interactiveChildren || !this.ctn.visible ? !1 : this.#l.skipChIn();\n  clearText() {\n    this.ctn.addChild(this.#l = this.#l.reNew()), this.#V = 0, this.#T = !0, this.#S = [], this.#j = \"\", this.#U = \"\", x.#o.recPagebreak();\n  }\n  #j = \"\";\n  #U = \"\";\n  get pageText() {\n    return this.#j.replace(\"《&emsp;》\", \"\");\n  }\n  get pagePlainText() {\n    return this.#U;\n  }\n  get enabled() {\n    return this.ctn.interactiveChildren;\n  }\n  set enabled(t) {\n    this.ctn.interactiveChildren = t;\n  }\n  addButton = (t) => new Promise((e) => {\n    t.key = `btn=[${this.#a.children.length}] ` + this.name_, t[\":id_tag\"] = t.key.slice(0, -7), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"hint_tate\", this.#l.tategaki);\n    const s = new D(t, x.#d, () => e(), () => this.canFocus());\n    s.name = JSON.stringify(t).replaceAll('\"', \"'\"), this.#a.addChild(s);\n  });\n  canFocus() {\n    return (this.ctn.interactiveChildren ?? !1) && this.ctn.visible && x.#n(this);\n  }\n  clearLay(t) {\n    super.clearLay(t), this.clearText();\n    for (const e of this.#a.removeChildren()) e.destroy();\n  }\n  record = () => ({\n    ...super.record(),\n    enabled: this.enabled,\n    r_cssText: this.#$.style.cssText,\n    r_align: this.#P,\n    // バック\n    b_do: this.#p === void 0 ? void 0 : this.#p instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.w ? \"Sprite\" : \"Graphics\",\n    b_pic: this.#w,\n    b_color: this.#h,\n    b_alpha: this.#f,\n    b_alpha_isfixed: this.#u,\n    ffs: this.#N,\n    txs: this.#l.record(),\n    strNoFFS: this.#b,\n    btns: this.#a.children.map((t) => t.name)\n  });\n  playback(t, e) {\n    super.playback(t, e), this.enabled = t.enabled, this.#$.style.cssText = t.r_cssText, this.#P = t.r_align, this.cvsResize(), this.#W(t), this.#l.playback(t.txs), this.#f = t.b_alpha, this.#u = t.b_alpha_isfixed, e = [\n      e,\n      new Promise((s) => {\n        const i = t.b_do ? t.b_do === \"Sprite\" ? { b_pic: t.b_pic } : { b_color: t.b_color } : { b_pic: \"\" };\n        i.b_alpha = t.b_alpha, i.b_alpha_isfixed = t.b_alpha_isfixed, this.#H(i, (n) => {\n          n && s();\n        }) || s();\n      }),\n      t.btns.map((s) => new Promise((i) => {\n        this.addButton(JSON.parse(s.replaceAll(\"'\", '\"'))), i();\n      }))\n    ].flat();\n  }\n  get cssText() {\n    return this.#l.cssText;\n  }\n  set cssText(t) {\n    this.#l.cssText = t;\n  }\n  snapshot(t, e) {\n    t.render(this.ctn, { clear: !1 }), this.#l.snapshot(t, e);\n  }\n  snapshot_end() {\n    this.#l.snapshot_end();\n  }\n  makeDesignCast(t) {\n    this.ctn.visible && this.#l.makeDesignCast(t);\n  }\n  makeDesignCastChildren(t) {\n    if (this.ctn.visible)\n      for (const e of this.#a.children) e.makeDesignCast(t);\n  }\n  showDesignCast() {\n    this.#l.showDesignCast();\n  }\n  showDesignCastChildren() {\n    for (const t of this.#a.children) t.showDesignCast();\n  }\n  dump() {\n    return this.#G(\"\", \"gotxt｜\"), super.dump() + `, \"enabled\":\"${this.enabled}\", ${this.#l.dump()}, \"b_pic\":\"${this.#w}\", \"b_color\":\"${this.#h}\", \"b_alpha\":${this.#f}, \"b_alpha_isfixed\":\"${this.#u}\", \"width\":${this.#l.getWidth}, \"height\":${this.#l.getHeight}, \"pixi_obj\":[${this.ctn.children.map((t) => `{\"class\":\"${t instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.w ? \"Sprite\" : t instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.z ? \"Graphics\" : t instanceof _web2_js__WEBPACK_IMPORTED_MODULE_0__.j ? \"Container\" : \"?\"}\", \"name\":\"${t.name}\", \"alpha\":${t.alpha}, \"x\":${t.x}, \"y\":${t.y}, \"visible\":\"${t.visible}\"}`).join(\",\")}], \"button\":[${this.#a.children.map((t) => t.children[0]?.name ?? \"{}\").join(\",\")}]`;\n  }\n}\nclass $ {\n  constructor(t, e, s) {\n    this.appPixi = e, this.val = s, t.add_frame = (i) => this.#d(i), t.let_frame = (i) => this.#f(i), t.set_frame = (i) => this.#u(i), t.frame = (i) => this.#w(i), t.tsy_frame = (i) => this.#l(i);\n  }\n  static #i;\n  static #e;\n  static #n;\n  static init(t, e, s) {\n    $.#i = t, $.#e = e, $.#n = s;\n  }\n  #o;\n  setEvtMng(t) {\n    this.#o = t;\n  }\n  #t = /* @__PURE__ */ Object.create(null);\n  destroy() {\n    for (const t of Object.values(this.#t)) t.parentElement.removeChild(t);\n    this.#t = /* @__PURE__ */ Object.create(null);\n  }\n  hideAllFrame() {\n    for (const [t, { style: e }] of Object.entries(this.#t))\n      this.#c[t] = e.display !== \"none\", e.display = \"none\";\n  }\n  #c = /* @__PURE__ */ Object.create(null);\n  restoreAllFrame() {\n    for (const [t, e] of Object.entries(this.#c)) {\n      const s = this.#t[t];\n      s && (s.style.display = e ? \"inline\" : \"none\");\n    }\n    this.#c = /* @__PURE__ */ Object.create(null);\n  }\n  //\tHTMLフレーム\n  // フレーム追加\n  #d(t) {\n    const { id: e, src: s, alpha: i = 1, scale_x: n = 1, scale_y: o = 1, rotate: a = 0 } = t;\n    if (!e) throw \"idは必須です\";\n    if (!s) throw \"srcは必須です\";\n    const l = \"const.sn.frm.\" + e;\n    if (this.val.getVal(`tmp:${l}`)) throw `frame【${e}】はすでにあります`;\n    const c = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"visible\", !0), u = t.b_color ? ` background-color: ${t.b_color};` : \"\", h = this.#r(t);\n    $.#n.cvs.insertAdjacentHTML(\"beforebegin\", `<iframe id=\"${e}\" style=\"opacity: ${i}; ${u} position: absolute; left:${$.#e.ofsLeft4elm + h.x * $.#e.cvsScale}px; top: ${$.#e.ofsTop4elm + h.y * $.#e.cvsScale}px; z-index: 1; border: 0px; overflow: hidden; display: ${c ? \"inline\" : \"none\"}; transform: scale(${n}, ${o}) rotate(${a}deg);\" width=\"${h.width * $.#e.cvsScale}\" height=\"${h.height * $.#e.cvsScale}\"></iframe>`), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)();\n    const m = $.#i.searchPath(s, _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.HTML), f = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.L().add({ name: s, url: m, xhrType: _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.TEXT });\n    return $.#e.arg.crypto && f.use(async (r, p) => {\n      try {\n        r.data = await $.#e.dec(r.extension, r.data);\n      } catch (d) {\n        $.#n.errScript(`[add_frame]Html ロード失敗です src:${r.name} ${d}`, !1);\n      }\n      p();\n    }), f.load((r, p) => {\n      const d = document.getElementById(e);\n      this.#t[e] = d, this.#m[e] = !1;\n      const y = m.lastIndexOf(\"/\") + 1, b = m.slice(0, y), C = b.slice(0, y);\n      d.srcdoc = String(p[s]?.data).replace(\"sn_repRes();\", \"\").replaceAll(\n        /\\s(?:src|href)=([\"'])(\\S+?)\\1/g,\n        // 【\\s】が大事、data-src弾く\n        (v, w, N) => N.startsWith(\"../\") ? v.replace(\"../\", C) : v.replace(\"./\", \"\").replace(w, w + b)\n      ), d.srcdoc.includes(\"true/*WEBP*/;\") && (d.srcdoc = d.srcdoc.replaceAll(\n        /data-src=\"(.+?\\.)(?:jpe?g|png)/g,\n        (v, w) => `data-src=\"${w}webp`\n      )), d.onload = () => {\n        this.val.setVal_Nochk(\"tmp\", l, !0), this.val.setVal_Nochk(\"tmp\", l + \".alpha\", i), this.val.setVal_Nochk(\"tmp\", l + \".x\", h.x), this.val.setVal_Nochk(\"tmp\", l + \".y\", h.y), this.val.setVal_Nochk(\"tmp\", l + \".scale_x\", n), this.val.setVal_Nochk(\"tmp\", l + \".scale_y\", o), this.val.setVal_Nochk(\"tmp\", l + \".rotate\", a), this.val.setVal_Nochk(\"tmp\", l + \".width\", h.width), this.val.setVal_Nochk(\"tmp\", l + \".height\", h.height), this.val.setVal_Nochk(\"tmp\", l + \".visible\", c);\n        const v = d.contentWindow;\n        this.#o.resvFlameEvent(v), v.sn_repRes?.((w) => $.#s(w.dataset.src ?? \"\", w)), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n      };\n    }), !0;\n  }\n  #m = {};\n  getFrmDisabled(t) {\n    return this.#m[t];\n  }\n  #r(t) {\n    const e = { ...t }, s = $.#e.resolution;\n    return new DOMRect(\n      (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"x\", 0) * s,\n      (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"y\", 0) * s,\n      (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"width\", _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW) * s,\n      (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"height\", _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH) * s\n    );\n  }\n  static #s(t, e, s) {\n    const i = this.#h[t];\n    if (i) {\n      e.src = i, s && (e.onload = () => s(e));\n      return;\n    }\n    const n = this.#y[t];\n    if (n) {\n      n.push(e);\n      return;\n    }\n    this.#y[t] = [e];\n    const [o = \"\", a = \"\"] = t.split(\"?\"), l = $.#i.searchPath(o, _web2_js__WEBPACK_IMPORTED_MODULE_0__.S.SP_GSM), c = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.L().add({ name: t, url: l, xhrType: _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.XHR_RESPONSE_TYPE.BUFFER });\n    $.#e.arg.crypto && (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.K)(l) === \"bin\" && c.use(async (u, h) => {\n      try {\n        const m = await $.#e.decAB(u.data);\n        if (u.extension !== \"bin\") {\n          h();\n          return;\n        }\n        u.data = m, m instanceof HTMLImageElement && (u.type = _web2_js__WEBPACK_IMPORTED_MODULE_0__.c.TYPE.IMAGE);\n      } catch (m) {\n        $.#n.errScript(`GrpLayer loadPic ロード失敗です fn:${u.name} ${m}`, !1);\n      }\n      h();\n    }), c.load((u, h) => {\n      for (const [m, { data: { src: f } }] of Object.entries(h)) {\n        const r = this.#h[m] = f + (f.startsWith(\"blob:\") ? \"\" : (a ? \"?\" : \"\") + a), p = this.#y[m];\n        if (p) for (const d of p)\n          d.src = r, s && (d.onload = () => s(d));\n        delete this.#y[m];\n      }\n    });\n  }\n  static #y = {};\n  static #h = {};\n  cvsResize() {\n    for (const [t, e] of Object.entries(this.#t)) {\n      const s = \"const.sn.frm.\" + t, i = Number(this.val.getVal(s + \".x\")), n = Number(this.val.getVal(s + \".y\")), o = Number(this.val.getVal(s + \".width\")), a = Number(this.val.getVal(s + \".height\"));\n      e.style.left = `${$.#e.ofsLeft4elm + i * $.#e.cvsScale}px`, e.style.top = `${$.#e.ofsTop4elm + n * $.#e.cvsScale}px`, e.width = String(o * $.#e.cvsScale), e.height = String(a * $.#e.cvsScale);\n    }\n  }\n  // フレーム変数を取得\n  #f(t) {\n    const { id: e, var_name: s } = t;\n    if (!e) throw \"idは必須です\";\n    const i = document.getElementById(e);\n    if (!i) throw `id【${e}】はフレームではありません`;\n    const n = \"const.sn.frm.\" + e;\n    if (!this.val.getVal(`tmp:${n}`)) throw `frame【${e}】が読み込まれていません`;\n    if (!s) throw \"var_nameは必須です\";\n    const o = i.contentWindow;\n    if (!o.hasOwnProperty(s)) throw `frame【${e}】に変数/関数【${s}】がありません。変数は var付きにして下さい`;\n    const a = o[s];\n    return this.val.setVal_Nochk(\n      \"tmp\",\n      n + \".\" + s,\n      (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"function\", !1) ? a() : a\n    ), !1;\n  }\n  // フレーム変数に設定\n  #u(t) {\n    const { id: e, var_name: s, text: i } = t;\n    if (!e) throw \"idは必須です\";\n    const n = document.getElementById(e);\n    if (!n) throw `id【${e}】はフレームではありません`;\n    const o = \"const.sn.frm.\" + e;\n    if (!this.val.getVal(`tmp:${o}`)) throw `frame【${e}】が読み込まれていません`;\n    if (!s) throw \"var_nameは必須です\";\n    if (!i) throw \"textは必須です\";\n    this.val.setVal_Nochk(\"tmp\", o + \".\" + s, i);\n    const a = n.contentWindow;\n    return a[s] = i, !1;\n  }\n  // フレームに設定\n  #p = 1;\n  #w(t) {\n    const { id: e } = t;\n    if (!e) throw \"idは必須です\";\n    const s = document.getElementById(e);\n    if (!s) throw `id【${e}】はフレームではありません`;\n    const i = \"const.sn.frm.\" + e;\n    if (!this.val.getVal(\"tmp:\" + i)) throw `frame【${e}】が読み込まれていません`;\n    const n = s.style;\n    if ((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"float\", !1) ? n.zIndex = `${++this.#p}` : \"index\" in t ? n.zIndex = `${(0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"index\", 0)}` : t.dive && (n.zIndex = `-${++this.#p}`), \"alpha\" in t) {\n      const a = n.opacity = String(t.alpha);\n      this.val.setVal_Nochk(\"tmp\", i + \".alpha\", a);\n    }\n    const o = this.#r(t);\n    if ((\"x\" in t || \"y\" in t) && (n.left = `${$.#e.ofsLeft4elm + o.x * $.#e.cvsScale}px`, n.top = `${$.#e.ofsTop4elm + o.y * $.#e.cvsScale}px`, this.val.setVal_Nochk(\"tmp\", i + \".x\", o.x), this.val.setVal_Nochk(\"tmp\", i + \".y\", o.y)), \"scale_x\" in t || \"scale_y\" in t || \"rotate\" in t) {\n      const a = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_x\", 1), l = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"scale_y\", 1), c = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"rotate\", 0);\n      n.transform = `scale(${a}, ${l}) rotate(${c}deg)`, this.val.setVal_Nochk(\"tmp\", i + \".scale_x\", a), this.val.setVal_Nochk(\"tmp\", i + \".scale_y\", l), this.val.setVal_Nochk(\"tmp\", i + \".rotate\", c);\n    }\n    if (\"width\" in t && (s.width = String(o.width * $.#e.cvsScale), this.val.setVal_Nochk(\"tmp\", i + \".width\", o.width)), \"height\" in t && (s.height = String(o.height * $.#e.cvsScale), this.val.setVal_Nochk(\"tmp\", i + \".height\", o.height)), \"visible\" in t) {\n      const a = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"visible\", !0);\n      n.display = a ? \"inline\" : \"none\", this.val.setVal_Nochk(\"tmp\", i + \".visible\", a);\n    }\n    if (\"b_color\" in t && (n.backgroundColor = t.b_color), \"disabled\" in t) {\n      const a = this.#m[e] = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"disabled\", !0), l = s.contentDocument.body;\n      for (const c of [\n        ...Array.from(l.getElementsByTagName(\"input\")),\n        ...Array.from(l.getElementsByTagName(\"select\"))\n      ]) c.disabled = a;\n    }\n    return !1;\n  }\n  // フレームをトゥイーン開始\n  #l(t) {\n    const { id: e, alpha: s, x: i, y: n, scale_x: o, scale_y: a, rotate: l, width: c, height: u } = t;\n    if (!e) throw \"idは必須です\";\n    const h = document.getElementById(e);\n    if (!h) throw `id【${e}】はフレームではありません`;\n    const m = \"const.sn.frm.\" + e;\n    if (!this.val.getVal(`tmp:${m}`, 0)) throw `frame【${e}】が読み込まれていません`;\n    const f = {};\n    s && (f.a = h.style.opacity), (i || n || o || a || l) && (f.x = Number(this.val.getVal(`tmp:${m}.x`)), f.y = Number(this.val.getVal(`tmp:${m}.y`)), f.sx = Number(this.val.getVal(`tmp:${m}.scale_x`)), f.sy = Number(this.val.getVal(`tmp:${m}.scale_y`)), f.r = Number(this.val.getVal(`tmp:${m}.rotate`))), c && (f.w = this.val.getVal(`tmp:${m}.width`)), u && (f.h = this.val.getVal(`tmp:${m}.height`));\n    const r = _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.cnvTweenArg(t, f);\n    let p = () => {\n    };\n    s && ((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(r, \"alpha\", 0), p = () => {\n      h.style.opacity = f.a, this.val.setVal_Nochk(\"tmp\", \"alpha\", f.a);\n    });\n    let d = () => {\n    };\n    const y = this.#r(r);\n    (i || n || o || a || l) && (y.x, y.y, (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(r, \"scale_x\", 1), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(r, \"scale_y\", 1), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(r, \"rotate\", 0), d = () => {\n      h.style.left = $.#e.ofsLeft4elm + f.x * $.#e.cvsScale + \"px\", h.style.top = $.#e.ofsTop4elm + f.y * $.#e.cvsScale + \"px\", h.style.transform = `scale(${f.sx}, ${f.sy}) rotate(${f.r}deg)`, this.val.setVal_Nochk(\"tmp\", m + \".x\", f.x), this.val.setVal_Nochk(\"tmp\", m + \".y\", f.y), this.val.setVal_Nochk(\"tmp\", m + \".scale_x\", f.sx), this.val.setVal_Nochk(\"tmp\", m + \".scale_y\", f.sy), this.val.setVal_Nochk(\"tmp\", m + \".rotate\", f.r);\n    });\n    let b = () => {\n    };\n    c && (y.width, b = () => {\n      h.width = f.w * $.#e.cvsScale + \"px\", this.val.setVal_Nochk(\"tmp\", m + \".width\", f.w);\n    });\n    let C = () => {\n    };\n    return u && (y.height, C = () => {\n      h.height = f.h * $.#e.cvsScale + \"px\", this.val.setVal_Nochk(\"tmp\", m + \".height\", f.h);\n    }), this.appPixi.stage.interactive = !1, _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.tween(`frm\n${e}`, t, f, _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.cnvTweenArg(t, f), () => {\n      p(), d(), b(), C();\n    }, () => this.appPixi.stage.interactive = !0, () => {\n    }), !1;\n  }\n}\nclass J {\n  //MARK: コンストラクタ\n  constructor(t, e, s, i, n, o, a, l, c) {\n    this.cfg = t, this.hTag = e, this.appPixi = s, this.val = i, this.main = n, this.scrItr = o, this.sys = a, this.sndMng = l, this.prpPrs = c;\n    const u = () => {\n      if (a.cvsResize(), this.cvsResizeDesign(), this.#r) for (const r of this.#C)\n        this.#a[r].fore.cvsResizeChildren();\n      else for (const r of this.#C)\n        this.#a[r].fore.cvsResize();\n      this.#o.cvsResize(), this.#h.cvsResize();\n    };\n    if (_web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isMobile)\n      this.#c.add(globalThis, \"orientationchange\", u, { passive: !0 });\n    else {\n      let r;\n      this.#c.add(globalThis, \"resize\", () => {\n        r || (r = setTimeout(() => {\n          r = void 0, u();\n        }, 1e3 / 60 * 10));\n      }, { passive: !0 });\n    }\n    a.cvsResize(), x.init(t, e, i, this, (r) => this.#a[r.layname].fore === r, s), H.init(n, t, s, a, l, i), $.init(t, a, n), D.init(t), this.#o = new $(e, s, i), a.hFactoryCls.grp = () => new H(), a.hFactoryCls.txt = () => new x(), e.loadplugin = (r) => this.#$(r), e.snapshot = (r) => this.#p(r), this.#w = this.sys.isApp ? this.#l : this.#I, e.add_lay = (r) => this.#x(r), e.clear_lay = (r) => this.#B(r), e.finish_trans = () => _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.finish_trans(), e.lay = (r) => this.#R(r), e.trans = (r) => this.#v(r), e.wt = (r) => _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.wt(r), e.quake = (r) => this.#P(r), e.stop_quake = e.finish_trans, e.wq = (r) => e.wt(r), e.pause_tsy = (r) => _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.pause_tsy(r), e.resume_tsy = (r) => _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.resume_tsy(r), e.stop_tsy = (r) => _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.stop_tsy(r), e.tsy = (r) => this.#A(r), e.wait_tsy = (r) => _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.wait_tsy(r), e.add_filter = (r) => this.#O(r), e.clear_filter = (r) => this.#Q(r), e.enable_filter = (r) => this.#L(r), e.ch = (r) => this.#S(r), e.clear_text = (r) => this.#et(r), e.current = (r) => this.#K(r), e.endlink = (r) => this.#st(r), e.er = (r) => this.#it(r), e.graph = (r) => this.#nt(r), e.link = (r) => this.#at(r), e.r = (r) => this.#ot(r), e.rec_ch = (r) => this.#tt(r), e.rec_r = (r) => this.#lt(r), e.reset_rec = (r) => this.#rt(r), e.ruby2 = (r) => this.#ht(r), e.span = (r) => this.#ct(r), e.tcy = (r) => this.#dt(r), e.add_face = (r) => _.add_face(r), e.wv = (r) => _.wv(r), e.dump_lay = (r) => this.#ft(r), e.enable_event = (r) => this.#pt(r), e.button = (r) => this.#ut(r), t.existsBreakline && (this.breakLine = (r) => {\n      delete r.visible, r.id = \"break\", r.pic = \"breakline\";\n      const p = encodeURIComponent(JSON.stringify(r));\n      this.#u(\"grp｜\" + p);\n    }), t.existsBreakpage && (this.breakPage = (r) => {\n      delete r.visible, r.id = \"break\", r.pic = \"breakpage\";\n      const p = encodeURIComponent(JSON.stringify(r));\n      this.#u(\"grp｜\" + p);\n    }), this.#t = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.M)(String(t.oCfg.init.bg_color));\n    const h = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z();\n    h.beginFill(this.#t, 1).lineStyle(0, this.#t).drawRect(0, 0, _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW, _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH).endFill(), this.#e.addChild(h.clone()), this.#n.addChild(h), this.#n.visible = !1, this.#e.name = \"page:A\", this.#n.name = \"page:B\", this.#i = s.stage, this.#i.addChild(this.#n), this.#i.addChild(this.#e), this.#i.addChild(this.#N), this.#i.addChild(this.#b), this.#i.name = \"stage\";\n    const m = (r, p) => {\n      this.#f(Number(p));\n    };\n    m(\"\", i.getVal(\"sys:TextLayer.Back.Alpha\", 1)), i.defValTrg(\"sys:TextLayer.Back.Alpha\", m);\n    const f = (r, p) => D.fontFamily = p;\n    f(\"\", i.getVal(\"tmp:sn.button.fontFamily\", D.fontFamily)), i.defValTrg(\"tmp:sn.button.fontFamily\", f), i.defTmp(\"const.sn.log.json\", () => JSON.stringify(\n      (this.#F.text = this.#F.text?.replaceAll(\"</span><span class='sn_ch'>\", \"\") ?? \"\") ? [...this.#Y, this.#F] : this.#Y\n    )), i.defTmp(\"const.sn.last_page_text\", () => this.currentTxtlayFore?.pageText ?? \"\"), i.defTmp(\"const.sn.last_page_plain_text\", () => this.currentTxtlayFore?.pagePlainText ?? \"\"), _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isDbg && (ct.init(s, a, o, c, t, this.#a), this.cvsResizeDesign = () => ct.cvsResizeDesign(), a.addHook((r, p) => {\n      this.#d[r]?.(r, p) && delete this.#d[r];\n    }));\n  }\n  #i;\n  #e = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.j();\n  #n = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.j();\n  #o;\n  #t;\n  #c = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.E();\n  cvsResizeDesign() {\n  }\n  #d = {\n    attach: (t) => !1,\n    continue: (t) => !1,\n    disconnect: (t) => !1,\n    _enterDesign: (t) => {\n      for (const e of this.#C) {\n        const s = this.#a[e].fore;\n        s.makeDesignCastChildren((i) => i.make()), s.makeDesignCast((i) => i.make());\n      }\n      return this.#s(this.#k), !1;\n    },\n    _replaceToken: (t, e) => !1,\n    _selectNode: (t, e) => (this.#s(e.node), !1)\n  };\n  #m = \"\";\n  #r = \"\";\n  #s(t) {\n    [this.#m = \"\", this.#r = \"\"] = t.split(\"/\");\n    const e = this.#a[this.#m];\n    e && (this.#r ? e.fore.showDesignCastChildren() : e.fore.showDesignCast());\n  }\n  getFrmDisabled = (t) => this.#o.getFrmDisabled(t);\n  #y = void 0;\n  cover(t, e = 0) {\n    this.#y && (this.#i.removeChild(this.#y), this.#y.destroy(), this.#y = void 0), t && this.#i.addChild(\n      (this.#y = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.z()).beginFill(e).lineStyle(0, e).drawRect(0, 0, _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW, _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH).endFill()\n    );\n  }\n  #h;\n  setEvtMng(t) {\n    this.#h = t, this.#o.setEvtMng(t), _.setEvtMng(t), _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.init(t, this.appPixi);\n  }\n  destroy() {\n    for (const t of Object.values(this.#a)) t.destroy();\n    this.#c.clear(), H.destroy(), _RubySpliter_js__WEBPACK_IMPORTED_MODULE_3__.R.destroy(), k.destroy(), x.destroy(), this.#o.destroy(), _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.destroy(), J.#T = 10;\n  }\n  // 既存の全文字レイヤの実際のバック不透明度、を再計算\n  #f(t) {\n    for (const e of this.#g()) {\n      const s = this.#a[e];\n      s.fore instanceof x && (s.fore.chgBackAlpha(t), s.back.chgBackAlpha(t));\n    }\n  }\n  #u = (t, e = this.currentTxtlayForeNeedErr, s = !0) => e.tagCh(\"｜&emsp;《\" + t + \"》\");\n  goTxt = () => {\n  };\n  breakLine = (t) => {\n  };\n  breakPage = (t) => {\n  };\n  clearBreak() {\n    this.currentTxtlayFore && (this.clearBreak = () => this.#u(\"del｜break\"), this.clearBreak());\n  }\n  clickTxtLay() {\n    return this.currentTxtlayFore ? this.#g().some((t) => {\n      const e = this.#a[t].fore;\n      return e instanceof x && e.click();\n    }) : !1;\n  }\n  //\t//\tシステム\n  //MARK: スナップショット\n  #p(t) {\n    const e = t.fn ? t.fn.startsWith(\"userdata:/\") ? t.fn : `downloads:/${t.fn + (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.g)(\"-\", \"_\", \"\", \"_\")}.png` : `downloads:/snapshot${(0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.g)(\"-\", \"_\", \"\", \"_\")}.png`, s = this.cfg.searchPath(e), i = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"width\", _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW), n = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"height\", _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH);\n    return this.#w(t, s, i, n);\n  }\n  #w = () => !1;\n  #l(t, e, s, i) {\n    if (this.#o.hideAllFrame(), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)(), !(\"layer\" in t))\n      return this.sys.capturePage(e, s, i, () => {\n        this.#o.restoreAllFrame(), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n      }), !0;\n    const n = {};\n    for (const o of this.#g()) {\n      const a = this.#a[o].fore.ctn;\n      n[o] = a.visible, a.visible = !1;\n    }\n    for (const o of this.#g(t.layer)) this.#a[o].fore.ctn.visible = !0;\n    return this.sys.capturePage(e, s, i, () => {\n      for (const [o, a] of Object.entries(n))\n        this.#a[o].fore.ctn.visible = a;\n      this.#o.restoreAllFrame(), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n    }), !0;\n  }\n  #I(t, e, s, i) {\n    (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)();\n    const n = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.J)(t, \"b_color\", this.#t), o = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.N)({\n      width: s,\n      height: i,\n      backgroundAlpha: n > 16777216 && e.endsWith(\".png\") ? 0 : 1,\n      antialias: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"smoothing\", !1),\n      preserveDrawingBuffer: !0,\n      backgroundColor: n & 16777215,\n      autoDensity: !0\n    }), a = t.page !== \"back\" ? \"fore\" : \"back\";\n    return Promise.allSettled(\n      this.#g(t.layer).map((l) => new Promise(\n        (c) => this.#a[l][a].snapshot(o, c)\n      ))\n    ).then(async () => {\n      const l = _web2_js__WEBPACK_IMPORTED_MODULE_0__.y.create({ width: o.width, height: o.height });\n      o.render(this.#i, { renderTexture: l }), await this.sys.savePic(\n        e,\n        o.plugins.extract.base64(l)\n      ), l.destroy();\n      for (const c of this.#g(t.layer)) this.#a[c][a].snapshot_end();\n      o.destroy(!0), (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n    }), !0;\n  }\n  //MARK: プラグインの読み込み\n  #$(t) {\n    const { fn: e } = t;\n    if (!e) throw \"fnは必須です\";\n    const s = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"join\", !0);\n    if (s && (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.d)(), e.endsWith(\".css\"))\n      (async () => {\n        const i = await fetch(e);\n        if (!i.ok) throw new Error(\"Network response was not ok.\");\n        (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.k)(await i.text()), s && (0,_ReadState_js__WEBPACK_IMPORTED_MODULE_2__.e)();\n      })();\n    else throw \"サポートされない拡張子です\";\n    return s;\n  }\n  //\t//\tレイヤ共通\n  //MARK: レイヤを追加する\n  #x(t) {\n    const { layer: e, class: s } = t;\n    if (!e) throw \"layerは必須です\";\n    if (e.includes(\",\")) throw \"layer名に「,」は使えません\";\n    if (e in this.#a) throw `layer【${e}】はすでにあります`;\n    if (!s) throw \"clsは必須です\";\n    const i = { isWait: !1 };\n    switch (this.#a[e] = new Q(e, s, this.#e, this.#n, t, this.sys, this.val, i), this.#C.push(e), s) {\n      case \"txt\":\n        this.#k || (this.#U = () => {\n        }, this.#_ = this.#Z, this.#K = this.#M, this.hTag.current({ layer: e }), this.goTxt = () => {\n          this.#h.isSkipping ? J.#T = 0 : this.setNormalChWait();\n          for (const n of this.#g()) {\n            const o = this.#a[n].fore;\n            o instanceof x && this.#u(\"gotxt｜\", o, !1);\n          }\n        }), this.val.setVal_Nochk(\n          \"save\",\n          \"const.sn.layer.\" + (e ?? this.#k) + \".enabled\",\n          !0\n        );\n        break;\n      case \"grp\":\n        if (this.#J) break;\n        this.#J = e;\n        break;\n    }\n    return this.scrItr.recodeDesign(t), i.isWait;\n  }\n  #a = {};\n  // しおりLoad時再読込\n  #C = [];\n  // 最適化用\n  #k = \"\";\n  #J = \"\";\n  #R(t) {\n    const e = this.#q(t), s = this.#a[e], i = s.back.ctn, n = s.fore.ctn;\n    if ((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"float\", !1))\n      this.#n.setChildIndex(i, this.#n.children.length - 1), this.#e.setChildIndex(n, this.#e.children.length - 1), this.#D();\n    else if (t.index)\n      (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"index\", 0) && (this.#n.setChildIndex(i, t.index), this.#e.setChildIndex(n, t.index), this.#D());\n    else if (t.dive) {\n      const { dive: o } = t;\n      let a = 0;\n      if (e === o) throw \"[lay] 属性 layerとdiveが同じ【\" + o + \"】です\";\n      const l = this.#a[o];\n      if (!l) throw \"[lay] 属性 dive【\" + o + \"】が不正です。レイヤーがありません\";\n      const c = l.back, u = l.fore, h = this.#n.getChildIndex(c.ctn), m = this.#e.getChildIndex(u.ctn);\n      a = h < m ? h : m, a > this.#n.getChildIndex(i) && --a, this.#e.setChildIndex(n, a), this.#n.setChildIndex(i, a), this.#D();\n    }\n    return t[\":id_tag\"] = s.fore.name.slice(0, -7), this.scrItr.recodeDesign(t), s.lay(t);\n  }\n  #D() {\n    this.#C = this.#X();\n  }\n  //MARK: レイヤ設定の消去\n  #B(t) {\n    return this.#z(t, (e) => {\n      const s = this.#a[this.#q({ layer: e })];\n      if (t.page === \"both\") {\n        s.fore.clearLay(t), s.back.clearLay(t);\n        return;\n      }\n      s.getPage(t).clearLay(t);\n    }), !1;\n  }\n  //===================================================\n  //MARK: WebGL フラグメントシェーダー GLSL\n  static #H = (\n    /* glsl */\n    `\nprecision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform sampler2D rule;\nuniform float vague;\nuniform float tick;\n\nuniform vec4 inputPixel;\nuniform highp vec4 outputFrame;\nvec2 getUV(vec2 coord) {\n\treturn coord * inputPixel.xy / outputFrame.zw;\n}\n\nvoid main() {\n\tvec4 fg = texture2D(uSampler, vTextureCoord);\n\tvec4 ru = texture2D(rule, getUV(vTextureCoord));\n\n\tfloat v = ru.r - tick;\n\tgl_FragColor = abs(v) < vague\n\t\t? vec4(fg.rgb, 1) *fg.a *(0.5 +v /vague *0.5)\n\t\t: 0.0 <= v ? fg : vec4(0);\n}`\n  );\n  /*\n  \t末尾が読みづらいが、以下のif文を消して三項演算子にしている。\n  \n  \tif (abs(v) < vague) {\n  \t\tfloat f_a = fg.a *(0.5 +v /vague *0.5);\n  \t\tgl_FragColor.rgb = fg.rgb *f_a;\n  \t\tgl_FragColor.a = f_a;\n  \t\treturn;\n  \t}\n  \tgl_FragColor = v >= 0.0 ? fg : vec4(0);\n  \n  \t\t★GLSL : don't use \"if\"｜Nobu note.com/nobuhirosaijo/n/n606a3f5d8e89\n  \t\t\t> if文はあまり使わない方がいいらしい (処理負荷が高い)\n  */\n  #W = _web2_js__WEBPACK_IMPORTED_MODULE_0__.y.create({\n    width: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW,\n    height: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH\n  });\n  #N = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w(this.#W);\n  #E = _web2_js__WEBPACK_IMPORTED_MODULE_0__.y.create({\n    width: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW,\n    height: _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH\n  });\n  #b = new _web2_js__WEBPACK_IMPORTED_MODULE_0__.w(this.#E);\n  //MARK: ページ裏表を交換\n  #v(t) {\n    _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.finish_trans(), this.#h.hideHint();\n    const { layer: e } = t, s = /* @__PURE__ */ new Set(), i = [];\n    for (const w of this.#g(e))\n      s.add(w), i.push(this.#a[w].fore);\n    const n = async () => {\n      [this.#e, this.#n] = [this.#n, this.#e];\n      const w = [];\n      for (const [N, S] of Object.entries(this.#a)) {\n        if (s.has(N)) {\n          S.transPage(w);\n          continue;\n        }\n        const { fore: { ctn: T }, back: { ctn: P } } = S, I = this.#e.getChildIndex(P);\n        this.#e.removeChild(P), this.#n.removeChild(T), this.#e.addChildAt(T, I), this.#n.addChildAt(P, I);\n      }\n      await Promise.allSettled(w), this.#e.visible = !0, this.#n.visible = !1, this.#N.visible = !1, this.#b.visible = !1;\n    };\n    if (this.#b.filters = [], this.#b.alpha = 1, (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"time\", 0) === 0 || this.#h.isSkipping)\n      return n(), !1;\n    let a = [];\n    const l = [];\n    for (const w of this.#g()) {\n      const N = this.#a[w][s.has(w) ? \"back\" : \"fore\"];\n      N.ctn.visible && a.push(N.ctn), l.push(N);\n    }\n    const { ticker: c, renderer: u } = this.appPixi;\n    u.render(this.#n, { renderTexture: this.#W });\n    let h = () => {\n      for (const w of a) u.render(\n        w,\n        { renderTexture: this.#W, clear: !1 }\n      );\n    };\n    if (!l.some((w) => w.containMovement)) {\n      const w = h;\n      h = () => {\n        h = () => {\n        }, w();\n      };\n    }\n    const m = () => u.render(this.#e, { renderTexture: this.#E });\n    m();\n    let f = () => {\n      this.#e.visible = !0, m(), this.#e.visible = !1;\n    };\n    if (!i.some((w) => w.containMovement)) {\n      const w = f;\n      f = () => {\n        f = () => {\n        }, w();\n      };\n    }\n    const r = () => {\n      h(), this.#N.visible = !0, f(), this.#b.visible = !0;\n    }, { glsl: p, rule: d } = t, y = () => {\n      c.remove(r), n();\n    };\n    if (!p && !d)\n      return _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.tween(_CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.TW_INT_TRANS, t, this.#b, { alpha: 0 }, () => {\n      }, y, () => {\n      }), c.add(r), !1;\n    const b = {\n      rule: _web2_js__WEBPACK_IMPORTED_MODULE_0__.s.EMPTY,\n      vague: (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"vague\", 0.04),\n      tick: 0\n    };\n    this.#b.filters = [new _web2_js__WEBPACK_IMPORTED_MODULE_0__.O(\n      void 0,\n      p ?? J.#H,\n      b\n    )];\n    const C = _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.tween(_CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.TW_INT_TRANS, t, b, { tick: 1 }, () => {\n    }, y, () => {\n    }, !d);\n    if (!d)\n      return c.add(r), !1;\n    const v = new _(d, void 0, (w) => {\n      b.rule = w.texture, w.destroy(), v.destroy(), C.start(), c.add(r);\n    });\n    return !1;\n  }\n  #g(t = \"\") {\n    return t ? t.split(\",\") : this.#C;\n  }\n  #z(t, e) {\n    const s = this.#g(t.layer);\n    for (const i of s) {\n      const n = this.#a[i];\n      if (!n) throw \"存在しないlayer【\" + i + \"】です\";\n      e(i, n);\n    }\n    return s;\n  }\n  #X(t = \"\") {\n    return this.#g(t).sort((e, s) => {\n      const i = this.#e.getChildIndex(this.#a[e].fore.ctn), n = this.#e.getChildIndex(this.#a[s].fore.ctn);\n      return i < n ? -1 : i > n ? 1 : 0;\n    });\n  }\n  setAllStyle2TxtLay(t) {\n    const e = this.#g();\n    for (const s of e) {\n      const i = this.#a[s].fore;\n      i instanceof x && i.lay({ style: t });\n    }\n  }\n  //MARK: 画面を揺らす\n  #P(t) {\n    if (_CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.finish_trans(), (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"time\", NaN) === 0 || this.#h.isSkipping) return !1;\n    const { layer: s } = t, i = [];\n    for (const u of this.#g(s))\n      i.push(this.#a[u].fore.ctn);\n    this.#E.resize(_web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageW, _web2_js__WEBPACK_IMPORTED_MODULE_0__.C.stageH);\n    const n = () => {\n      this.#e.visible = !0;\n      const { renderer: u } = this.appPixi;\n      for (const h of i) u.render(\n        h,\n        { renderTexture: this.#E, clear: !1 }\n      );\n      this.#e.visible = !1;\n    };\n    this.#b.visible = !0, this.#b.alpha = 1;\n    const o = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"hmax\", 10)), a = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"vmax\", 10)), l = o === 0 ? () => {\n    } : () => this.#b.x = Math.round(Math.random() * o * 2) - o, c = a === 0 ? () => {\n    } : () => this.#b.y = Math.round(Math.random() * a * 2) - a;\n    return this.#b.filters = [], _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.tween(_CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.TW_INT_TRANS, t, this.#b, { x: 0, y: 0 }, () => {\n      l(), c();\n    }, () => {\n      this.appPixi.ticker.remove(n), this.#e.visible = !0, this.#b.visible = !1, this.#b.x = 0, this.#b.y = 0;\n    }, () => {\n    }), this.appPixi.ticker.add(n), !1;\n  }\n  //MARK: トゥイーン開始\n  #A(t) {\n    const { layer: e, render: s, name: i } = t;\n    if (!e) throw \"layerは必須です\";\n    const n = this.#a[this.#q(t)], o = n.fore;\n    let a = () => {\n    };\n    s && !this.#h.isSkipping && (o.renderStart(), a = () => o.renderEnd());\n    const l = _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.cnvTweenArg(t, o), c = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"arrive\", !1), u = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"backlay\", !1), h = n.back.ctn;\n    return _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.tween(i ?? e, t, o, _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.cnvTweenArg(t, o), () => {\n    }, a, () => {\n      if (c && Object.assign(o, l), u) for (const m of Object.keys(_CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.hMemberCnt)) h[m] = o[m];\n    }), \"filter\" in t && (o.ctn.filters = [_web2_js__WEBPACK_IMPORTED_MODULE_0__.x.bldFilters(t)], o.aFltHArg = [t]), !1;\n  }\n  //MARK: フィルター追加\n  #O(t) {\n    return _CmnTween_js__WEBPACK_IMPORTED_MODULE_1__.C.finish_trans(), this.#z(t, (e) => {\n      const s = this.#a[this.#q({ layer: e })];\n      if (t.page === \"both\") {\n        this.#G(s.fore, t), this.#G(s.back, t);\n        return;\n      }\n      const i = s.getPage(t);\n      this.#G(i, t);\n    }), !1;\n  }\n  #G(t, e) {\n    const s = t.ctn;\n    s.filters ??= [], s.filters = [...s.filters, _web2_js__WEBPACK_IMPORTED_MODULE_0__.x.bldFilters(e)], t.aFltHArg.push(e);\n  }\n  //MARK: フィルター全削除\n  #Q(t) {\n    return this.#z(t, (e) => {\n      const s = this.#a[this.#q({ layer: e })];\n      if (t.page === \"both\") {\n        const n = s.fore, o = s.back;\n        n.ctn.filters = null, o.ctn.filters = null, n.aFltHArg = [], o.aFltHArg = [];\n        return;\n      }\n      const i = s.getPage(t);\n      i.ctn.filters = null, i.aFltHArg = [];\n    }), !1;\n  }\n  //MARK: フィルター個別切替\n  #L(t) {\n    return this.#z(t, (e) => {\n      const s = this.#a[this.#q({ layer: e })];\n      if (t.page === \"both\") {\n        this.#V(s.fore, t), this.#V(s.back, t);\n        return;\n      }\n      const i = s.getPage(t);\n      this.#V(i, t);\n    }), !1;\n  }\n  #V(t, e) {\n    const s = t.ctn;\n    if (!s.filters) throw \"フィルターがありません\";\n    const i = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.u)((0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(e, \"index\", 0)), n = s.filters.length;\n    if (n <= i) throw `フィルターの個数（${n}）を越えています`;\n    t.aFltHArg[i].enabled = s.filters[i].enabled = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(e, \"enabled\", !0);\n  }\n  //\t// 文字・文字レイヤ\n  static #T = 10;\n  static get msecChWait() {\n    return J.#T;\n  }\n  //MARK: 文字を追加する\n  #S(t) {\n    const { text: e } = t;\n    if (!e) throw \"textは必須です\";\n    const s = this.#_(t);\n    delete t.text, this.setNormalChWait(), this.#h.isSkipping ? t.wait = 0 : \"wait\" in t && (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.b)(t, \"wait\", NaN);\n    const i = encodeURIComponent(JSON.stringify(t));\n    this.#u(\"add｜\" + i, s);\n    const n = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"record\", !0), o = this.val.doRecLog();\n    return n || this.val.setVal_Nochk(\"save\", \"sn.doRecLog\", n), s.tagCh(e.replaceAll(\"[r]\", `\n`)), this.val.setVal_Nochk(\"save\", \"sn.doRecLog\", o), this.#u(\"add_close｜\", s), !1;\n  }\n  #_ = (t) => {\n    throw this.#U(), 0;\n  };\n  #Z(t) {\n    const e = this.#q(t, this.#k), i = this.#a[e].getPage(t);\n    if (!(i instanceof x)) throw e + \"はTxtLayerではありません\";\n    return i;\n  }\n  setNormalChWait() {\n    J.#T = this.scrItr.normalWait;\n  }\n  //MARK: 操作対象のメッセージレイヤの指定\n  #K = (t) => {\n    throw this.#U(), 0;\n  };\n  #M(t) {\n    const { layer: e } = t;\n    if (!e) throw \"[current] layerは必須です\";\n    const s = this.#a[e];\n    if (!s || !(s.getPage(t) instanceof x)) throw `${e}はTxtLayerではありません`;\n    this.#j = s, this.recPagebreak(), this.#k = e, this.val.setVal_Nochk(\"save\", \"const.sn.mesLayer\", e);\n    for (const i of this.#g()) {\n      const n = this.#a[i];\n      n.fore instanceof x && (n.fore.isCur = n.back.isCur = i === e);\n    }\n    return !1;\n  }\n  get currentTxtlayForeNeedErr() {\n    return this.#U(), this.currentTxtlayFore;\n  }\n  get currentTxtlayFore() {\n    return this.#j ? this.#j.fore : null;\n  }\n  #j;\n  // カレントテキストレイヤ\n  #U = () => {\n    throw \"文字レイヤーがありません。文字表示や操作する前に、[add_lay layer=（レイヤ名） class=txt]で文字レイヤを追加して下さい\";\n  };\n  #q(t, e = \"\") {\n    const s = t.layer ?? e;\n    if (s.includes(\",\")) throw \"layer名に「,」は使えません\";\n    if (!(s in this.#a)) throw \"属性 layer【\" + s + \"】が不正です。レイヤーがありません\";\n    return t.layer = s;\n  }\n  #F = { text: \"\" };\n  #Y = [];\n  recText(t) {\n    this.#F = { text: t }, this.val.setVal_Nochk(\n      \"save\",\n      \"const.sn.sLog\",\n      String(this.val.getVal(\"const.sn.log.json\"))\n      // これを起動したい\n    );\n  }\n  recPagebreak() {\n    this.#F.text && (this.#F.text = this.#F.text.replaceAll(\"</span><span class='sn_ch'>\", \"\"), this.#Y.push(this.#F) > this.cfg.oCfg.log.max_len && (this.#Y = this.#Y.slice(-this.cfg.oCfg.log.max_len)), this.#F = { text: \"\" });\n  }\n  //MARK: 文字消去\n  #et(t) {\n    const e = this.#_(t);\n    return t.layer === this.#k && t.page === \"fore\" && this.recPagebreak(), e.clearText(), !1;\n  }\n  //MARK: ハイパーリンクの終了\n  #st(t) {\n    return this.#u(\"endlink｜\", this.#_(t)), !1;\n  }\n  //MARK: ページ両面の文字消去\n  #it(t) {\n    return (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"rec_page_break\", !0) && this.recPagebreak(), this.#j && (this.#j.fore.clearLay(t), this.#j.back.clearLay(t)), !1;\n  }\n  //MARK: インライン画像表示\n  #nt(t) {\n    if (!t.pic) throw \"[graph] picは必須です\";\n    const e = encodeURIComponent(JSON.stringify(t));\n    return this.#u(\"grp｜\" + e, this.#_(t)), !1;\n  }\n  //MARK: ハイパーリンク\n  #at(t) {\n    if (!t.fn && !t.label && !t.url) throw \"fn,label,url いずれかは必須です\";\n    t.fn ??= this.scrItr.scriptFn, t.style ??= \"background-color: rgba(255,0,0,0.5);\", t.style_hover ??= \"background-color: rgba(255,0,0,0.9);\", t.style_clicked ??= t.style;\n    const e = encodeURIComponent(JSON.stringify(t));\n    return this.#u(\"link｜\" + e, this.#_(t)), !1;\n  }\n  //MARK: 改行\n  #ot(t) {\n    return t.text = `\n`, this.#S(t);\n  }\n  //MARK: 履歴改行\n  #lt(t) {\n    return this.#tt({ ...t, text: \"[r]\" });\n  }\n  //MARK: 履歴書き込み\n  #tt(t) {\n    return this.#F = { ...t, text: this.#F.text }, t.text ? (t.record = !0, t.style ??= \"\", t.style += \"display: none;\", t.wait = 0, this.#S(t)) : !1;\n  }\n  //MARK: 履歴リセット\n  #rt(t) {\n    return this.#Y = [], this.#F = { text: t.text ?? \"\" }, this.val.setVal_Nochk(\n      \"save\",\n      \"const.sn.sLog\",\n      t.text ? `[{text:\"${t.text}\"}]` : \"[]\"\n    ), !1;\n  }\n  //MARK: 文字列と複数ルビの追加\n  #ht(t) {\n    const { t: e, r: s } = t;\n    if (!e) throw \"[ruby2] tは必須です\";\n    if (!s) throw \"[ruby2] rは必須です\";\n    return t.text = \"｜\" + encodeURIComponent(e) + \"《\" + encodeURIComponent(s) + \"》\", delete t.t, delete t.r, this.#S(t);\n  }\n  //MARK: インラインスタイル設定\n  #ct(t) {\n    const e = encodeURIComponent(JSON.stringify(t));\n    return this.#u(\"span｜\" + e, this.#_(t)), !1;\n  }\n  //MARK: tcy縦中横を表示する\n  #dt(t) {\n    if (!t.t) throw \"[tcy] tは必須です\";\n    const e = encodeURIComponent(JSON.stringify(t));\n    return this.#u(\"tcy｜\" + e, this.#_(t)), !1;\n  }\n  //MARK: レイヤのダンプ\n  #ft(t) {\n    console.group(\"🥟 [dump_lay]\");\n    for (const e of this.#g(t.layer)) {\n      const s = this.#a[e];\n      try {\n        console.info(\n          `%c${s.fore.name.slice(0, -7)} %o`,\n          `color:#${_web2_js__WEBPACK_IMPORTED_MODULE_0__.C.isDarkMode ? \"49F\" : \"05A\"};`,\n          JSON.parse(`{\"back\":{${s.back.dump()}}, \"fore\":{${s.fore.dump()}}}`)\n        );\n      } catch (i) {\n        console.error(\"dump_lay err:%o\", i), console.error(`   back:${s.back.dump()}`), console.error(`   fore:${s.fore.dump()}`);\n      }\n    }\n    return console.groupEnd(), !1;\n  }\n  //MARK: イベント有無の切替\n  #pt(t) {\n    const e = this.#q(t, this.#k), s = (0,_web2_js__WEBPACK_IMPORTED_MODULE_0__.a)(t, \"enabled\", !0);\n    return this.#_(t).enabled = s, this.val.setVal_Nochk(\"save\", \"const.sn.layer.\" + e + \".enabled\", s), !1;\n  }\n  //MARK: ボタンを表示\n  #ut(t) {\n    return Q.argChk_page(t, \"back\"), t.fn ??= this.scrItr.scriptFn, this.#_(t).addButton(t), this.scrItr.recodeDesign(t), !1;\n  }\n  record() {\n    const t = {};\n    for (const e of this.#C) {\n      const s = this.#a[e];\n      t[e] = {\n        cls: s.cls,\n        fore: s.fore.record(),\n        back: s.back.record()\n      };\n    }\n    return t;\n  }\n  playback(t) {\n    this.#Y = JSON.parse(String(this.val.getVal(\"save:const.sn.sLog\"))), this.#F = { text: \"\" };\n    const e = [], s = [];\n    for (const [n, { fore: o, fore: { idx: a }, back: l, cls: c }] of Object.entries(t)) {\n      s.push({ ln: n, idx: a });\n      const u = this.#a[n] ??= new Q(n, c, this.#e, this.#n, {}, this.sys, this.val, { isWait: !1 });\n      u.fore.playback(o, e), u.back.playback(l, e);\n    }\n    const i = this.#e.children.length;\n    return e.push(new Promise((n) => {\n      for (const { ln: o, idx: a } of s.sort(({ idx: l }, { idx: c }) => l === c ? 0 : l < c ? -1 : 1)) {\n        const { fore: l, back: c } = this.#a[o];\n        if (!l) continue;\n        const u = i > a ? a : i - 1;\n        this.#e.setChildIndex(l.ctn, u), this.#n.setChildIndex(c.ctn, u);\n      }\n      n();\n    })), e;\n  }\n}\nconst Yt = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({\n  __proto__: null,\n  LayerMng: J\n}, Symbol.toStringTag, { value: \"Module\" }));\n\n//# sourceMappingURL=LayerMng.js.map\n\n\n//# sourceURL=webpack://gallery/../skynovel/dist/LayerMng.js?");

/***/ }),

/***/ "../skynovel/dist/RubySpliter.js":
/*!***************************************!*\
  !*** ../skynovel/dist/RubySpliter.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   R: () => (/* binding */ o)\n/* harmony export */ });\nclass o {\n  static #s = \"ヽ\";\n  static setting(t) {\n    t.sesame && (o.#s = t.sesame);\n  }\n  static getSesame() {\n    return o.#s;\n  }\n  static destroy() {\n    o.#s = \"ヽ\";\n  }\n  #t = () => {\n  };\n  init(t) {\n    this.#t = t;\n  }\n  /*\n  \t\t★Unicodeで「漢字」の正規表現 – ものかの http://tama-san.com/kanji-regex/\n  \t\t2E80..2FDF CJK部首補助＋康熙部首\n  \t\t3005 々（漢字の踊り字）\n  \t\t3007 〇（漢数字のゼロ）\n  \t\t303B 〻（漢字の踊り字）\n  \t\t3400..4DBF CJK統合漢字拡張A\n  \t\t4E00..9FFF CJK統合漢字\n  \t\tF900..FAFF CJK互換漢字\n  \t\t20000..2FFFF CJK統合漢字拡張B〜F＋CJK互換漢字追加＋念のためU+2FFFFまで\n  \n  \t\t[\\x{2E80}-\\x{2FDF}々〇〻\\x{3400}-\\x{4DBF}\\x{4E00}-\\x{9FFF}\\x{F900}-\\x{FAFF}\\x{20000}-\\x{2FFFF}]\n  \t\t[\\u2E80-\\u2FDF々〇〻\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF\\u20000-\\u2FFFF]\n  \t\t[⺀-⿟々〇〻㐀-䶿一-鿿豈-﫿\\u20000-\\u2FFFF]\t\t// 含まれない文字がある\n  \t\t[⺀-⿟々〇〻㐀-鿿豈-﫿\\u20000-\\u2FFFF]\t\t\t// ヽ--30FD が変に引っかかる。多分\\u2000-\\u2FFF解釈\n  \t\t\\\\u{20000}-\\\\u{2FFFF}\t// 五桁だとエラー\n  \n  \t\t【2022/10/03】ruby正規表現のUnicode プロパティ(とPOSIX文字クラス) - Qiita https://qiita.com/Takayuki_Nakano/items/8d38beaddb84b488d683\n  \t\t\t> このHiraganaプロパティ、長音記号は含まれていません。\n  \t\t\t> \\p{Han}…簡体字や繁体字、韓国語の漢字…ベトナム語の漢字にもマッチ\n  \t\t\n  \t\t・Unicode文字一覧表 - instant tools https://tools.m-bsys.com/ex/unicode_table.php\n  */\n  static #n;\n  static setEscape(t) {\n    o.#n = new RegExp(\n      `${t ? `(?<ce>\\\\${t}\\\\S)|` : \"\"}｜(?<str>[^《\\\\n]+)《(?<ruby>[^》\\\\n]+)》|(?:(?<kan>[⺀-⿟々〇〻㐀-鿿豈-﫿]+[ぁ-ヿ]*|[^　｜《》\\\\n])《(?<kan_ruby>[^》\\\\n]+)》)|(?<txt>[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[^｜《》]+?|.)`,\n      \"gs\"\n    );\n  }\n  putTxt(t) {\n    for (const { groups: s } of t.matchAll(o.#n)) {\n      const { ruby: c, kan_ruby: e, kan: r = \"\", ce: i, txt: f = \"\", str: n = \"\" } = s;\n      if (c) {\n        this.putTxtRb(decodeURIComponent(n), c);\n        continue;\n      }\n      if (e) {\n        this.putTxtRb(r, e);\n        continue;\n      }\n      if (i) {\n        this.#t(i.slice(1), \"\");\n        continue;\n      }\n      for (const a of Array.from(f)) this.#t(a, \"\");\n    }\n  }\n  putTxtRb(t, s) {\n    if (/^\\w+｜{\"/.test(s)) {\n      this.#t(t, s);\n      return;\n    }\n    const c = Array.from(t), e = c.length;\n    if (/^\\*.?$/.test(s)) {\n      const n = \"center｜\" + (s === \"*\" ? o.#s : s.charAt(1));\n      for (let a = 0; a < e; ++a) this.#t(c[a], n);\n      return;\n    }\n    if (e === 1 || !s.includes(\" \")) {\n      this.#t(t, decodeURIComponent(s));\n      return;\n    }\n    const r = s.split(\" \"), i = r.length, f = i > e ? i : e;\n    for (let n = 0; n < f; ++n) this.#t(\n      n < e ? c[n] : \"\",\n      n < i ? decodeURIComponent(r[n]) : \"\"\n    );\n  }\n}\n\n//# sourceMappingURL=RubySpliter.js.map\n\n\n//# sourceURL=webpack://gallery/../skynovel/dist/RubySpliter.js?");

/***/ })

}]);